function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};t.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},t.prototype.init_by_array=function(e,t){var n,r,i;for(this.init_seed(19650218),n=1,r=0,i=this.N>t?this.N:t;i;i--){var o=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1664525*((4294901760&o)>>>16)<<16)+1664525*(65535&o))+e[r]+r,this.mt[n]>>>=0,r++,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),r>=t&&(r=0)}for(i=this.N-1;i;i--){o=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1566083941*((4294901760&o)>>>16)<<16)+1566083941*(65535&o))-n,this.mt[n]>>>=0,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648},t.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_seed(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[1&e];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},t.prototype.random_int31=function(){return this.random_int()>>>1},t.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},t.prototype.random=function(){return this.random_int()*(1/4294967296)},t.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},t.prototype.random_long=function(){return(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))*(1/9007199254740992)};var n=new t(Math.random()*Number.MAX_SAFE_INTEGER);var r=e((function(e){var t=e.length;for(;t--;)e[t]=Math.floor(256*n.random());return e}));String.prototype.startsWith||(String.prototype.startsWith=function(e){return"string"==typeof e&&0===this.indexOf(e)}),String.prototype.includes||(String.prototype.includes=function(e){return"string"==typeof e&&this.indexOf(e)>=0});const i=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;if("undefined"!=typeof self)return self;throw new Error("unable to locate global object")})();void 0===i.globalThis&&Object.defineProperty(i,"globalThis",{get:()=>i}),"undefined"==typeof window&&(window=globalThis),globalThis.__ALIVC_IM_PLATFORM__="wx",globalThis.isWxWebAssembly=!0,globalThis.WebAssembly=WXWebAssembly,"object"!=typeof crypto&&(globalThis.crypto={getRandomValues:r});var o={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,o),!0;case 6:return l.fn.call(l.context,t,r,i,o,a),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var p,m=l.length;for(c=0;c<m;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,i);break;default:if(!u)for(p=1,u=new Array(f-1);p<f;p++)u[p-1]=arguments[p];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||i&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(o);var a,s=e(o.exports),u=(a="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e={}){function t(e,t,n){return t=s(t),function(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,i()?Reflect.construct(t,n||[],s(e).constructor):t.apply(e,n))}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}function r(e){var t="function"==typeof Map?new Map:void 0;return r=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(i())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var a=new(e.bind.apply(e,r));return n&&o(a,n.prototype),a}(e,arguments,s(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o(n,e)},r(e)}function i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(i=function(){return!!e})()}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==m(t)?t:String(t)}function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var d,h,g=e,v=function(){function e(){}function t(e){if(!(this instanceof t))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(e,this)}function n(e,n){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,t._immediateFn((function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null!==t){var o;try{o=t(e._value)}catch(e){return void i(n.promise,e)}r(n.promise,o)}else(1===e._state?r:i)(n.promise,e._value)}))):e._deferreds.push(n)}function r(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==m(n)||"function"==typeof n)){var r=n.then;if(n instanceof t)return e._state=3,e._value=n,void o(e);if("function"==typeof r)return void s((a=r,u=n,function(){a.apply(u,arguments)}),e)}e._state=1,e._value=n,o(e)}catch(t){i(e,t)}var a,u}function i(e,t){e._state=2,e._value=t,o(e)}function o(e){2===e._state&&0===e._deferreds.length&&t._immediateFn((function(){e._handled||t._unhandledRejectionFn(e._value)}));for(var r=0,i=e._deferreds.length;r<i;r++)n(e,e._deferreds[r]);e._deferreds=null}function a(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function s(e,t){var n=!1;try{e((function(e){n||(n=!0,r(t,e))}),(function(e){n||(n=!0,i(t,e))}))}catch(e){if(n)return;n=!0,i(t,e)}}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.then=function(t,r){var i=new this.constructor(e);return n(this,new a(t,r,i)),i},t.all=function(e){return new t((function(t,n){if(!Array.isArray(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var i=r.length;function o(e,a){try{if(a&&("object"==m(a)||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(t){o(e,t)}),n)}r[e]=a,0==--i&&t(r)}catch(e){n(e)}}for(var a=0;a<r.length;a++)o(a,r[a])}))},t.resolve=function(e){return e&&"object"==m(e)&&e.constructor==t?e:new t((function(t){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(n,r){if(!Array.isArray(e))return r(new TypeError("Promise.race accepts an array"));for(var i=0,o=e.length;i<o;i++)t.resolve(e[i]).then(n,r)}))},t._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){setTimeout(e,0)},t._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t}();void 0===Object.assign&&(Object.assign=function(e,t){for(var n=1;n<arguments.length;n++)if(t=arguments[n])for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}),g.ready=new v((function(e,t){d=e,h=t}));var y=Object.assign({},g),w="./this.program",_=function(e,t){throw t},b="";"undefined"!=typeof document&&document.currentScript&&(b=document.currentScript.src),a&&(b=a),b=0!==b.indexOf("blob:")?b.substr(0,b.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var C,O,S=g.print||console.log.bind(console),M=g.printErr||console.error.bind(console);Object.assign(g,y),y=null,g.arguments&&g.arguments,g.thisProgram&&(w=g.thisProgram),g.quit&&(_=g.quit),g.wasmBinary&&(C=g.wasmBinary),"object"!=("undefined"==typeof WebAssembly?"undefined":m(WebAssembly))&&z("no native wasm support detected");var I,T,R,E,A,P,L,k,x,F=!1;function D(e,t){e||z(t)}var $=[],N=[],j=[],W=[];if(!Math.fround){var G=new Float32Array(1);Math.fround=function(e){return G[0]=e,G[0]}}Math.clz32||(Math.clz32=function(e){var t=32,n=e>>16;return n&&(t-=16,e=n),(n=e>>8)&&(t-=8,e=n),(n=e>>4)&&(t-=4,e=n),(n=e>>2)&&(t-=2,e=n),(n=e>>1)?t-2:t-e}),Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)});var U=0,q=null;function z(e){var t;null===(t=g.onAbort)||void 0===t||t.call(g,e),M(e="Aborted("+e+")"),F=!0,I=1,e+=". Build with -sASSERTIONS for more info.";var n="run time error";throw h(n),n}var H,Y,V,B=function(e){return e.startsWith("data:application/octet-stream;base64,")};function X(e,t,n){return function(e){return new v(((t,n)=>{globalThis.isWxWebAssembly?t(e):wx.getFileSystemManager().readFile({filePath:e,position:0,success:e=>{t(e.data)},fail(e){n(e)}})}))}(e).then((function(e){return WebAssembly.instantiate(e,t)})).then((function(e){return e})).then(n,(function(e){M("failed to asynchronously prepare wasm: ".concat(e)),z(e)}))}function K(e){this.name="ExitStatus",this.message="Program terminated with exit(".concat(e,")"),this.status=e}B(H="AliVCIM.wasm")||(Y=H,H=g.locateFile?g.locateFile(Y,b):b+Y);var J,Q,Z,ee,te,ne=function(e){for(;e.length>0;)e.shift()(g)},re=g.noExitRuntime||!0,ie=[],oe=0,ae=0,se=function(){function e(t){l(this,e),this.excPtr=t,this.ptr=t-24}return f(e,[{key:"set_type",value:function(e){L[this.ptr+4>>2]=e}},{key:"get_type",value:function(){return L[this.ptr+4>>2]}},{key:"set_destructor",value:function(e){L[this.ptr+8>>2]=e}},{key:"get_destructor",value:function(){return L[this.ptr+8>>2]}},{key:"set_caught",value:function(e){e=e?1:0,T[this.ptr+12|0]=e}},{key:"get_caught",value:function(){return 0!=T[this.ptr+12|0]}},{key:"set_rethrown",value:function(e){e=e?1:0,T[this.ptr+13|0]=e}},{key:"get_rethrown",value:function(){return 0!=T[this.ptr+13|0]}},{key:"init",value:function(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t)}},{key:"set_adjusted_ptr",value:function(e){L[this.ptr+16>>2]=e}},{key:"get_adjusted_ptr",value:function(){return L[this.ptr+16>>2]}},{key:"get_exception_ptr",value:function(){if(En(this.get_type()))return L[this.excPtr>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}]),e}(),ue=function(e){var t=ae;if(!t)return Cn(0),0;var n=new se(t);n.set_adjusted_ptr(t);var r=n.get_type();if(!r)return Cn(0),t;for(var i in e){var o=e[i];if(0===o||o===r)break;var a=n.ptr+16;if(Rn(o,r,a))return Cn(o),t}return Cn(r),t},ce="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,le=function(e,t,n){for(var r=t+n,i=t;e[i]&&!(i>=r);)++i;if(i-t>16&&e.buffer&&ce)return ce.decode(e.subarray(t,i));for(var o="";t<i;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var u=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|u:(7&a)<<18|s<<12|u<<6|63&e[t++])<65536)o+=String.fromCharCode(a);else{var c=a-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&a)<<6|s)}else o+=String.fromCharCode(a)}return o},fe=function(e,t){return e?le(R,e,t):""},pe=function(e,t,n,r){if(!(r>0))return 0;for(var i=n,o=n+r-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(n>=o)break;t[n++]=s}else if(s<=2047){if(n+1>=o)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=o)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+3>=o)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}return t[n]=0,n-i},me=function(e,t,n){return pe(e,R,t,n)},de=function(e,t){return Object.defineProperty(t,"name",{value:e})},he=function(){function e(){l(this,e),this.allocated=[void 0],this.freelist=[]}return f(e,[{key:"get",value:function(e){return this.allocated[e]}},{key:"has",value:function(e){return void 0!==this.allocated[e]}},{key:"allocate",value:function(e){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=e,t}},{key:"free",value:function(e){this.allocated[e]=void 0,this.freelist.push(e)}}]),e}(),ge=new he,ve=function(e){throw new J(e)},ye=function(){for(var e=0,t=ge.reserved;t<ge.allocated.length;++t)void 0!==ge.allocated[t]&&++e;return e},we={toValue:function(e){return e||ve("Cannot use deleted val. handle = "+e),ge.get(e).value},toHandle:function(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return ge.allocate({refcount:1,value:e})}}},_e=function(e,t){var n=de(t,(function(e){this.name=t,this.message=e;var n=new Error(e).stack;void 0!==n&&(this.stack=this.toString()+"\n"+n.replace(/^Error(:[^\n]*)?\n/,""))}));return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:"".concat(this.name,": ").concat(this.message)},n},be=function(e){for(var t="",n=e;R[n];)t+=Z[R[n++]];return t},Ce=function(){return Object.keys(Te).length},Oe=function(){var e=[];for(var t in Te)Te.hasOwnProperty(t)&&e.push(Te[t]);return e},Se=[],Me=function(){for(;Se.length;){var e=Se.pop();e.$$.deleteScheduled=!1,e.delete()}},Ie=function(e){ee=e,Se.length&&ee&&ee(Me)},Te={},Re=function(e,t){for(void 0===t&&ve("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t},Ee={},Ae=function(e){var t=_n(e),n=be(t);return wn(t),n},Pe=function(e,t){var n=Ee[e];return void 0===n&&ve(t+" has unknown type "+Ae(e)),n},Le=function(e){},ke=!1,xe=function(e){e.count.value-=1,0===e.count.value&&function(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}(e)},Fe=function e(t,n,r){if(n===r)return t;if(void 0===r.baseClass)return null;var i=e(t,n,r.baseClass);return null===i?null:r.downcast(i)},De={},$e=function(e){throw new te(e)},Ne=function(e,t){return t.ptrType&&t.ptr||$e("makeClassHandle requires ptr and ptrType"),!!t.smartPtrType!=!!t.smartPtr&&$e("Both smartPtrType and smartPtr must be specified"),t.count={value:1},We(Object.create(e,{$$:{value:t,writable:!0}}))};function je(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var n=function(e,t){return t=Re(e,t),Te[t]}(this.registeredClass,t);if(void 0!==n){if(0===n.$$.count.value)return n.$$.ptr=t,n.$$.smartPtr=e,n.clone();var r=n.clone();return this.destructor(e),r}function i(){return this.isSmartPointer?Ne(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Ne(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var o,a=this.registeredClass.getActualType(t),s=De[a];if(!s)return i.call(this);o=this.isConst?s.constPointerType:s.pointerType;var u=Fe(t,this.registeredClass,o.registeredClass);return null===u?i.call(this):this.isSmartPointer?Ne(o.registeredClass.instancePrototype,{ptrType:o,ptr:u,smartPtrType:this,smartPtr:e}):Ne(o.registeredClass.instancePrototype,{ptrType:o,ptr:u})}var We=function(e){return"undefined"==typeof FinalizationRegistry?(We=function(e){return e},e):(ke=new FinalizationRegistry((function(e){xe(e.$$)})),We=function(e){var t=e.$$;if(t.smartPtr){var n={$$:t};ke.register(e,n,e)}return e},Le=function(e){return ke.unregister(e)},We(e))},Ge={},Ue=function(e){for(;e.length;){var t=e.pop();e.pop()(t)}};function qe(e){return this.fromWireType(P[e>>2])}var ze={},He={},Ye=function(e,t,n){function r(t){var r=n(t);r.length!==e.length&&$e("Mismatched type converter count");for(var i=0;i<e.length;++i)Ve(e[i],r[i])}e.forEach((function(e){He[e]=t}));var i=new Array(t.length),o=[],a=0;t.forEach((function(e,t){Ee.hasOwnProperty(e)?i[t]=Ee[e]:(o.push(e),ze.hasOwnProperty(e)||(ze[e]=[]),ze[e].push((function(){i[t]=Ee[e],++a===o.length&&r(i)})))})),0===o.length&&r(i)};function Ve(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.name;if(e||ve('type "'.concat(r,'" must have a positive integer typeid pointer')),Ee.hasOwnProperty(e)){if(n.ignoreDuplicateRegistrations)return;ve("Cannot register type '".concat(r,"' twice"))}if(Ee[e]=t,delete He[e],ze.hasOwnProperty(e)){var i=ze[e];delete ze[e],i.forEach((function(e){return e()}))}}(e,t,n)}var Be=8,Xe=function(e){ve(e.$$.ptrType.registeredClass.name+" instance already deleted")};function Ke(){}var Je=function(e,t,n){if(void 0===e[t].overloadTable){var r=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||ve("Function '".concat(n,"' called with an invalid number of arguments (").concat(arguments.length,") - expects one of (").concat(e[t].overloadTable,")!")),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[r.argCount]=r}},Qe=function(e,t,n){g.hasOwnProperty(e)?(ve("Cannot register public name '".concat(e,"' twice")),Je(g,e,e),g.hasOwnProperty(n)&&ve("Cannot register multiple overloads of a function with the same number of arguments (".concat(n,")!")),g[e].overloadTable[n]=t):g[e]=t};function Ze(e,t,n,r,i,o,a,s){this.name=e,this.constructor=t,this.instancePrototype=n,this.rawDestructor=r,this.baseClass=i,this.getActualType=o,this.upcast=a,this.downcast=s,this.pureVirtualFunctions=[]}var et=function(e,t,n){for(;t!==n;)t.upcast||ve("Expected null or instance of ".concat(n.name,", got an instance of ").concat(t.name)),e=t.upcast(e),t=t.baseClass;return e};function tt(e,t){if(null===t)return this.isReference&&ve("null is not a valid ".concat(this.name)),0;t.$$||ve('Cannot pass "'.concat(_t(t),'" as a ').concat(this.name)),t.$$.ptr||ve("Cannot pass deleted object as a pointer of type ".concat(this.name));var n=t.$$.ptrType.registeredClass;return et(t.$$.ptr,n,this.registeredClass)}function nt(e,t){var n;if(null===t)return this.isReference&&ve("null is not a valid ".concat(this.name)),this.isSmartPointer?(n=this.rawConstructor(),null!==e&&e.push(this.rawDestructor,n),n):0;t&&t.$$||ve('Cannot pass "'.concat(_t(t),'" as a ').concat(this.name)),t.$$.ptr||ve("Cannot pass deleted object as a pointer of type ".concat(this.name)),!this.isConst&&t.$$.ptrType.isConst&&ve("Cannot convert argument of type ".concat(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name," to parameter type ").concat(this.name));var r=t.$$.ptrType.registeredClass;if(n=et(t.$$.ptr,r,this.registeredClass),this.isSmartPointer)switch(void 0===t.$$.smartPtr&&ve("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?n=t.$$.smartPtr:ve("Cannot convert argument of type ".concat(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name," to parameter type ").concat(this.name));break;case 1:n=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)n=t.$$.smartPtr;else{var i=t.clone();n=this.rawShare(n,we.toHandle((function(){return i.delete()}))),null!==e&&e.push(this.rawDestructor,n)}break;default:ve("Unsupporting sharing policy")}return n}function rt(e,t){if(null===t)return this.isReference&&ve("null is not a valid ".concat(this.name)),0;t.$$||ve('Cannot pass "'.concat(_t(t),'" as a ').concat(this.name)),t.$$.ptr||ve("Cannot pass deleted object as a pointer of type ".concat(this.name)),t.$$.ptrType.isConst&&ve("Cannot convert argument of type ".concat(t.$$.ptrType.name," to parameter type ").concat(this.name));var n=t.$$.ptrType.registeredClass;return et(t.$$.ptr,n,this.registeredClass)}function it(e){return this.fromWireType(L[e>>2])}function ot(e,t,n,r,i,o,a,s,u,c,l){this.name=e,this.registeredClass=t,this.isReference=n,this.isConst=r,this.isSmartPointer=i,this.pointeeType=o,this.sharingPolicy=a,this.rawGetPointee=s,this.rawConstructor=u,this.rawShare=c,this.rawDestructor=l,i||void 0!==t.baseClass?this.toWireType=nt:r?(this.toWireType=tt,this.destructorFunction=null):(this.toWireType=rt,this.destructorFunction=null)}var at,st,ut=function(e){return at.get(e)},ct=function(e,t,n){return e.includes("j")?function(e,t,n){var r=g["dynCall_"+e];return n&&n.length?r.apply(null,[t].concat(n)):r.call(null,t)}(e,t,n):ut(t).apply(null,n)},lt=function(e,t){var n,r,i,o=(e=be(e)).includes("j")?(n=e,r=t,i=[],function(){return i.length=0,Object.assign(i,arguments),ct(n,r,i)}):ut(t);return"function"!=typeof o&&ve("unknown function pointer with signature ".concat(e,": ").concat(t)),o},ft=function(e,t){var n=[],r={};throw t.forEach((function e(t){r[t]||Ee[t]||(He[t]?He[t].forEach(e):(n.push(t),r[t]=!0))})),new st("".concat(e,": ")+n.map(Ae).join([", "]))};function pt(e,t,n,r,i,o){var a=t.length;a<2&&ve("argTypes array size mismatch! Must at least get return value and 'this' types!");var s=null!==t[1]&&null!==n,u=function(e){for(var t=1;t<e.length;++t)if(null!==e[t]&&void 0===e[t].destructorFunction)return!0;return!1}(t),c="void"!==t[0].name,l=a-2,f=new Array(l),p=[],m=[];return de(e,(function(){var n;arguments.length!==l&&ve("function ".concat(e," called with ").concat(arguments.length," arguments, expected ").concat(l)),m.length=0,p.length=s?2:1,p[0]=i,s&&(n=t[1].toWireType(m,this),p[1]=n);for(var o=0;o<l;++o)f[o]=t[o+2].toWireType(m,arguments[o]),p.push(f[o]);return function(e){if(u)Ue(m);else for(var r=s?1:2;r<t.length;r++){var i=1===r?n:f[r-2];null!==t[r].destructorFunction&&t[r].destructorFunction(i)}if(c)return t[0].fromWireType(e)}(r.apply(null,p))}))}var mt,dt=function(e,t){for(var n=[],r=0;r<e;r++)n.push(L[t+4*r>>2]);return n},ht=function(e){var t=(e=e.trim()).indexOf("(");return-1!==t?e.substr(0,t):e},gt=function(e,t,n){return e instanceof Object||ve("".concat(n,' with invalid "this": ').concat(e)),e instanceof t.registeredClass.constructor||ve("".concat(n,' incompatible with "this" of type ').concat(e.constructor.name)),e.$$.ptr||ve("cannot call emscripten binding method ".concat(n," on deleted object")),et(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)},vt=function(e){e>=ge.reserved&&0==--ge.get(e).refcount&&ge.free(e)},yt={name:"emscripten::val",fromWireType:function(e){var t=we.toValue(e);return vt(e),t},toWireType:function(e,t){return we.toHandle(t)},argPackAdvance:Be,readValueFromPointer:qe,destructorFunction:null},wt=function(e,t,n){switch(t){case 1:return n?function(e){return this.fromWireType(T[0|e])}:function(e){return this.fromWireType(R[0|e])};case 2:return n?function(e){return this.fromWireType(E[e>>1])}:function(e){return this.fromWireType(A[e>>1])};case 4:return n?function(e){return this.fromWireType(P[e>>2])}:function(e){return this.fromWireType(L[e>>2])};default:throw new TypeError("invalid integer width (".concat(t,"): ").concat(e))}},_t=function(e){if(null===e)return"null";var t=m(e);return"object"===t||"array"===t||"function"===t?e.toString():""+e},bt=function(e,t){switch(t){case 4:return function(e){return this.fromWireType(k[e>>2])};case 8:return function(e){return this.fromWireType(x[e>>3])};default:throw new TypeError("invalid float width (".concat(t,"): ").concat(e))}},Ct=function(e,t,n){switch(t){case 1:return n?function(e){return T[0|e]}:function(e){return R[0|e]};case 2:return n?function(e){return E[e>>1]}:function(e){return A[e>>1]};case 4:return n?function(e){return P[e>>2]}:function(e){return L[e>>2]};default:throw new TypeError("invalid integer width (".concat(t,"): ").concat(e))}},Ot=function(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r<=127?t++:r<=2047?t+=2:r>=55296&&r<=57343?(t+=4,++n):t+=3}return t},St="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,Mt=function(e,t){for(var n=e,r=n>>1,i=r+t/2;!(r>=i)&&A[r];)++r;if((n=r<<1)-e>32&&St)return St.decode(R.subarray(e,n));for(var o="",a=0;!(a>=t/2);++a){var s=E[e+2*a>>1];if(0==s)break;o+=String.fromCharCode(s)}return o},It=function(e,t,n){var r;if(null!==(r=n)&&void 0!==r||(n=2147483647),n<2)return 0;for(var i=t,o=(n-=2)<2*e.length?n/2:e.length,a=0;a<o;++a){var s=e.charCodeAt(a);E[t>>1]=s,t+=2}return E[t>>1]=0,t-i},Tt=function(e){return 2*e.length},Rt=function(e,t){for(var n=0,r="";!(n>=t/4);){var i=P[e+4*n>>2];if(0==i)break;if(++n,i>=65536){var o=i-65536;r+=String.fromCharCode(55296|o>>10,56320|1023&o)}else r+=String.fromCharCode(i)}return r},Et=function(e,t,n){var r;if(null!==(r=n)&&void 0!==r||(n=2147483647),n<4)return 0;for(var i=t,o=i+n-4,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),P[t>>2]=s,(t+=4)+4>o)break}return P[t>>2]=0,t-i},At=function(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&++n,t+=4}return t},Pt=[],Lt={},kt=null,xt=function(e,t){return t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN},Ft=function(e){return e%4==0&&(e%100!=0||e%400==0)},Dt=[0,31,60,91,121,152,182,213,244,274,305,335],$t=[0,31,59,90,120,151,181,212,243,273,304,334],Nt=function(e){return(Ft(e.getFullYear())?Dt:$t)[e.getMonth()]+e.getDate()-1},jt=function(e){var t=Ot(e)+1,n=vn(t);return n&&me(e,n,t),n},Wt=function(e){if(e instanceof K||"unwind"==e)return I;_(1,e)},Gt=function(){return re||!1},Ut=function(e,t){var n,r;I=e,I=n=e,Gt()||(null===(r=g.onExit)||void 0===r||r.call(g,n),F=!0),_(n,new K(n))},qt=Ut,zt=function(e){if(!F)try{e(),function(){if(!Gt())try{qt(I)}catch(e){Wt(e)}}()}catch(e){Wt(e)}},Ht=function(e,t){return setTimeout((function(){zt(e)}),t)};mt=function(){return Date.now()};var Yt={mainLoop:{running:!1,scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause:function(){Yt.mainLoop.scheduler=null,Yt.mainLoop.currentlyRunningMainloop++},resume:function(){Yt.mainLoop.currentlyRunningMainloop++;var e=Yt.mainLoop.timingMode,t=Yt.mainLoop.timingValue,n=Yt.mainLoop.func;Yt.mainLoop.func=null,function(e,t,n,r,i){D(!Yt.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),Yt.mainLoop.func=e,Yt.mainLoop.arg=r;var o=Yt.mainLoop.currentlyRunningMainloop;function a(){return!(o<Yt.mainLoop.currentlyRunningMainloop)}Yt.mainLoop.running=!1,Yt.mainLoop.runner=function(){var t,n;if(!F)if(Yt.mainLoop.queue.length>0){var r=Yt.mainLoop.queue.shift();if(r.func(r.arg),Yt.mainLoop.remainingBlockers){var i=Yt.mainLoop.remainingBlockers,o=i%1==0?i-1:Math.floor(i);r.counted?Yt.mainLoop.remainingBlockers=o:(o+=.5,Yt.mainLoop.remainingBlockers=(8*i+o)/9)}if(Yt.mainLoop.updateStatus(),!a())return;setTimeout(Yt.mainLoop.runner,0)}else a()&&(Yt.mainLoop.currentFrameNumber=Yt.mainLoop.currentFrameNumber+1|0,1==Yt.mainLoop.timingMode&&Yt.mainLoop.timingValue>1&&Yt.mainLoop.currentFrameNumber%Yt.mainLoop.timingValue!=0?Yt.mainLoop.scheduler():(0==Yt.mainLoop.timingMode&&(Yt.mainLoop.tickStartTime=mt()),Yt.mainLoop.runIter(e),a()&&("object"==("undefined"==typeof SDL?"undefined":m(SDL))&&(null===(t=SDL.audio)||void 0===t||null===(n=t.queueNewAudioData)||void 0===n||n.call(t)),Yt.mainLoop.scheduler())))}}(n,0,0,Yt.mainLoop.arg),function(e,t){if(Yt.mainLoop.timingMode=e,Yt.mainLoop.timingValue=t,!Yt.mainLoop.func)return 1;if(Yt.mainLoop.running||(Yt.mainLoop.running=!0),0==e)Yt.mainLoop.scheduler=function(){var e=0|Math.max(0,Yt.mainLoop.tickStartTime+t-mt());setTimeout(Yt.mainLoop.runner,e)},Yt.mainLoop.method="timeout";else if(1==e)Yt.mainLoop.scheduler=function(){Yt.requestAnimationFrame(Yt.mainLoop.runner)},Yt.mainLoop.method="rAF";else if(2==e){if(void 0===Yt.setImmediate)if("undefined"==typeof setImmediate){var n=[],r="setimmediate";addEventListener("message",(function(e){e.data!==r&&e.data.target!==r||(e.stopPropagation(),n.shift()())}),!0),Yt.setImmediate=function(e){n.push(e),postMessage(r,"*")}}else Yt.setImmediate=setImmediate;Yt.mainLoop.scheduler=function(){Yt.setImmediate(Yt.mainLoop.runner)},Yt.mainLoop.method="immediate"}}(e,t),Yt.mainLoop.scheduler()},updateStatus:function(){if(g.setStatus){var e=g.statusMessage||"Please wait...",t=Yt.mainLoop.remainingBlockers,n=Yt.mainLoop.expectedBlockers;t?t<n?g.setStatus(e+" ("+(n-t)+"/"+n+")"):g.setStatus(e):g.setStatus("")}},runIter:function(e){var t;if(!F){if(g.preMainLoop&&!1===g.preMainLoop())return;zt(e),null===(t=g.postMainLoop)||void 0===t||t.call(g)}}},isFullscreen:!1,pointerLock:!1,moduleContextCreatedCallbacks:[],workers:[],init:function(){if(!Yt.initted){Yt.initted=!0;var e=g.canvas;e&&(e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock||e.msRequestPointerLock||function(){},e.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},e.exitPointerLock=e.exitPointerLock.bind(document),document.addEventListener("pointerlockchange",t,!1),document.addEventListener("mozpointerlockchange",t,!1),document.addEventListener("webkitpointerlockchange",t,!1),document.addEventListener("mspointerlockchange",t,!1),g.elementPointerLock&&e.addEventListener("click",(function(e){!Yt.pointerLock&&g.canvas.requestPointerLock&&(g.canvas.requestPointerLock(),e.preventDefault())}),!1))}function t(){Yt.pointerLock=document.pointerLockElement===g.canvas||document.mozPointerLockElement===g.canvas||document.webkitPointerLockElement===g.canvas||document.msPointerLockElement===g.canvas}},createContext:function(e,t,n,r){if(t&&g.ctx&&e==g.canvas)return g.ctx;var i,o;if(t){var a={antialias:!1,alpha:!1,majorVersion:1};if(r)for(var s in r)a[s]=r[s];"undefined"!=typeof GL&&(o=GL.createContext(e,a))&&(i=GL.getContext(o).GLctx)}else i=e.getContext("2d");return i?(n&&(t||D("undefined"==typeof GLctx,"cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),g.ctx=i,t&&GL.makeContextCurrent(o),g.useWebGL=t,Yt.moduleContextCreatedCallbacks.forEach((function(e){return e()})),Yt.init()),i):null},destroyContext:function(e,t,n){},fullscreenHandlersInstalled:!1,lockPointer:void 0,resizeCanvas:void 0,requestFullscreen:function(e,t){Yt.lockPointer=e,Yt.resizeCanvas=t,void 0===Yt.lockPointer&&(Yt.lockPointer=!0),void 0===Yt.resizeCanvas&&(Yt.resizeCanvas=!1);var n=g.canvas;function r(){var e,t;Yt.isFullscreen=!1;var r=n.parentNode;(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===r?(n.exitFullscreen=Yt.exitFullscreen,Yt.lockPointer&&n.requestPointerLock(),Yt.isFullscreen=!0,Yt.resizeCanvas?Yt.setFullscreenCanvasSize():Yt.updateCanvasDimensions(n)):(r.parentNode.insertBefore(n,r),r.parentNode.removeChild(r),Yt.resizeCanvas?Yt.setWindowedCanvasSize():Yt.updateCanvasDimensions(n)),null===(e=g.onFullScreen)||void 0===e||e.call(g,Yt.isFullscreen),null===(t=g.onFullscreen)||void 0===t||t.call(g,Yt.isFullscreen)}Yt.fullscreenHandlersInstalled||(Yt.fullscreenHandlersInstalled=!0,document.addEventListener("fullscreenchange",r,!1),document.addEventListener("mozfullscreenchange",r,!1),document.addEventListener("webkitfullscreenchange",r,!1),document.addEventListener("MSFullscreenChange",r,!1));var i=document.createElement("div");n.parentNode.insertBefore(i,n),i.appendChild(n),i.requestFullscreen=i.requestFullscreen||i.mozRequestFullScreen||i.msRequestFullscreen||(i.webkitRequestFullscreen?function(){return i.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}:null)||(i.webkitRequestFullScreen?function(){return i.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),i.requestFullscreen()},exitFullscreen:function(){return!!Yt.isFullscreen&&((document.exitFullscreen||document.cancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.webkitCancelFullScreen||function(){}).apply(document,[]),!0)},nextRAF:0,fakeRequestAnimationFrame:function(e){var t=Date.now();if(0===Yt.nextRAF)Yt.nextRAF=t+1e3/60;else for(;t+2>=Yt.nextRAF;)Yt.nextRAF+=1e3/60;var n=Math.max(Yt.nextRAF-t,0);setTimeout(e,n)},requestAnimationFrame:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){"function"!=typeof requestAnimationFrame?(0,Yt.fakeRequestAnimationFrame)(e):requestAnimationFrame(e)})),safeSetTimeout:function(e,t){return Ht(e,t)},safeRequestAnimationFrame:function(e){return Yt.requestAnimationFrame((function(){zt(e)}))},getMimetype:function(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]},getUserMedia:function(e){var t;(t=window).getUserMedia||(t.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(e)},getMovementX:function(e){return e.movementX||e.mozMovementX||e.webkitMovementX||0},getMovementY:function(e){return e.movementY||e.mozMovementY||e.webkitMovementY||0},getMouseWheelDelta:function(e){var t=0;switch(e.type){case"DOMMouseScroll":t=e.detail/3;break;case"mousewheel":t=e.wheelDelta/120;break;case"wheel":switch(t=e.deltaY,e.deltaMode){case 0:t/=100;break;case 1:t/=3;break;case 2:t*=80;break;default:throw"unrecognized mouse wheel delta mode: "+e.deltaMode}break;default:throw"unrecognized mouse wheel event: "+e.type}return t},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseCoords:function(e,t){var n=g.canvas.getBoundingClientRect(),r=g.canvas.width,i=g.canvas.height,o=void 0!==window.scrollX?window.scrollX:window.pageXOffset,a=void 0!==window.scrollY?window.scrollY:window.pageYOffset,s=e-(o+n.left),u=t-(a+n.top);return{x:s*=r/n.width,y:u*=i/n.height}},setMouseCoords:function(e,t){var n=Yt.calculateMouseCoords(e,t),r=n.x,i=n.y;Yt.mouseMovementX=r-Yt.mouseX,Yt.mouseMovementY=i-Yt.mouseY,Yt.mouseX=r,Yt.mouseY=i},calculateMouseEvent:function(e){if(Yt.pointerLock)"mousemove"!=e.type&&"mozMovementX"in e?Yt.mouseMovementX=Yt.mouseMovementY=0:(Yt.mouseMovementX=Yt.getMovementX(e),Yt.mouseMovementY=Yt.getMovementY(e)),"undefined"!=typeof SDL?(Yt.mouseX=SDL.mouseX+Yt.mouseMovementX,Yt.mouseY=SDL.mouseY+Yt.mouseMovementY):(Yt.mouseX+=Yt.mouseMovementX,Yt.mouseY+=Yt.mouseMovementY);else{if("touchstart"===e.type||"touchend"===e.type||"touchmove"===e.type){var t=e.touch;if(void 0===t)return;var n=Yt.calculateMouseCoords(t.pageX,t.pageY);if("touchstart"===e.type)Yt.lastTouches[t.identifier]=n,Yt.touches[t.identifier]=n;else if("touchend"===e.type||"touchmove"===e.type){var r=Yt.touches[t.identifier];r||(r=n),Yt.lastTouches[t.identifier]=r,Yt.touches[t.identifier]=n}return}Yt.setMouseCoords(e.pageX,e.pageY)}},resizeListeners:[],updateResizeListeners:function(){var e=g.canvas;Yt.resizeListeners.forEach((function(t){return t(e.width,e.height)}))},setCanvasSize:function(e,t,n){var r=g.canvas;Yt.updateCanvasDimensions(r,e,t),n||Yt.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullscreenCanvasSize:function(){if("undefined"!=typeof SDL){var e=L[SDL.screen>>2];e|=8388608,P[SDL.screen>>2]=e}Yt.updateCanvasDimensions(g.canvas),Yt.updateResizeListeners()},setWindowedCanvasSize:function(){if("undefined"!=typeof SDL){var e=L[SDL.screen>>2];e&=-8388609,P[SDL.screen>>2]=e}Yt.updateCanvasDimensions(g.canvas),Yt.updateResizeListeners()},updateCanvasDimensions:function(e,t,n){t&&n?(e.widthNative=t,e.heightNative=n):(t=e.widthNative,n=e.heightNative);var r=t,i=n;if(g.forcedAspectRatio&&g.forcedAspectRatio>0&&(r/i<g.forcedAspectRatio?r=Math.round(i*g.forcedAspectRatio):i=Math.round(r/g.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e.parentNode&&"undefined"!=typeof screen){var o=Math.min(screen.width/r,screen.height/i);r=Math.round(r*o),i=Math.round(i*o)}Yt.resizeCanvas?(e.width!=r&&(e.width=r),e.height!=i&&(e.height=i),void 0!==e.style&&(e.style.removeProperty("width"),e.style.removeProperty("height"))):(e.width!=t&&(e.width=t),e.height!=n&&(e.height=n),void 0!==e.style&&(r!=t||i!=n?(e.style.setProperty("width",r+"px","important"),e.style.setProperty("height",i+"px","important")):(e.style.removeProperty("width"),e.style.removeProperty("height"))))}},Vt=clearTimeout,Bt={getDB:(e,t,n)=>{var r=wx.env.USER_DATA_PATH+t.replace("//stat/aio_stat","/"+e),i=r.substr(0,r.lastIndexOf("/")+1),o=wx.getFileSystemManager();o.stat({path:i,success:e=>n(null,r),fail:e=>{o.mkdir({dirPath:i,recursive:!0,success:e=>n(null,r),fail:e=>(console.error("mkdir fail:",e),n(e))})}})},getStore(e,t,n){Bt.getDB(e,t,((e,t)=>{e&&n(e),wx.getFileSystemManager().stat({path:t,success:e=>{n(null,t)},fail:e=>{n(null,t)}})}))},getFile(e,t,n){Bt.getStore(e,t,((e,t)=>{wx.getFileSystemManager().readFile({filePath:t,success:e=>{n(null,e.data)},fail:e=>{n(e)}})}))},setFile(e,t,n,r){Bt.getStore(e,t,((e,t)=>{wx.getFileSystemManager().writeFile({filePath:t,data:n.buffer,success:e=>{r()},fail:e=>{r(e)}})}))},deleteFile(e,t,n){Bt.getStore(e,t,((e,t)=>{wx.getFileSystemManager().unlink({filePath:t,success:e=>{n()},fail:e=>{n(e)}})}))},storeExistsFile(e,t){},existsFile(e,t,n){Bt.getStore(e,t,((e,t)=>{var r=!1;try{wx.getFileSystemManager().stat({path:t,success:e=>{r=e.stats.isFile(),n(null,r)},fail:e=>{n(null,!1)}})}catch(e){}}))},clearStore(e,t){Bt.getStore(e,id,((e,n)=>{wx.getFileSystemManager().rmdir({filePath:n,success:e=>{t(null,e.data)},fail:e=>{t(e)}})}))}},Xt=Uint8Array.prototype.copyWithin?function(e,t,n){return R.copyWithin(e,t,t+n)}:function(e,t,n){return R.set(R.subarray(t,t+n),e)},Kt={init:function(){Kt.xhrs=new he}};function Jt(e,t,n,r,i){var o=L[e+8>>2];if(o){var a=fe(o),s=e+112,u=fe(s+0);u||(u="GET"),L[s+56>>2];var c=L[s+68>>2],l=L[s+72>>2],f=L[s+76>>2];L[s+80>>2];var p=L[s+84>>2],m=L[s+88>>2];L[s+52>>2],c&&fe(c),l&&fe(l);var d={},h="application/x-protobuf";if(f)for(;;){var g=L[f>>2];if(!g)break;var v=L[f+4>>2];if(!v)break;f+=8;var y=fe(g),w=fe(v);"content-type"==y.toLowerCase()?h=w:d[y]=w}var _=Kt.xhrs.allocate({});L[e>>2]=_;var b=p&&m?R.slice(p,p+m):null;wx.request({url:a,method:u,data:m>0?b.buffer:"",header:{"content-type":h,...d},success(r){var i="";r.data&&""!=r.data&&(i=JSON.stringify(r.data)),C(function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return t}(i)),200===r.statusCode?t(e,0,null):n(e,0,r)},fail(t){C(new ArrayBuffer),n(e,0,t)}})}else n(e,0,"no url specified!");function C(t){var n=0,r=0;0===L[e+12>>2]&&(r=t.byteLength),r>0&&(n=vn(r),R.set(new Uint8Array(t),n)),L[e+12>>2]=n,Zt(e+16,r),Zt(e+24,0);var i=t?t.byteLength:0;i&&Zt(e+32,i),A[e+40>>1]=4,A[e+42>>1]=200,0===i&&me("OK",e+44,64)}}var Qt,Zt=function(e,t){L[e>>2]=t;var n=L[e>>2];L[e+4>>2]=(t-n)/4294967296},en={},tn=function e(){if(!e.strings){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==("undefined"==typeof navigator?"undefined":m(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:w||"./this.program"};for(var n in en)void 0===en[n]?delete t[n]:t[n]=en[n];var r=[];for(var n in t)r.push("".concat(n,"=").concat(t[n]));e.strings=r}return e.strings},nn=[null,[],[]],rn=function(e){return(rn=function(){if("object"==("undefined"==typeof crypto?"undefined":m(crypto))&&"function"==typeof crypto.getRandomValues)return function(e){return crypto.getRandomValues(e)};z("initRandomDevice")}())(e)},on=[31,29,31,30,31,30,31,31,30,31,30,31],an=[31,28,31,30,31,30,31,31,30,31,30,31],sn=function(e,t){T.set(e,t)},un=function(e,t,n,r){var i=L[r+40>>2],o={tm_sec:P[r>>2],tm_min:P[r+4>>2],tm_hour:P[r+8>>2],tm_mday:P[r+12>>2],tm_mon:P[r+16>>2],tm_year:P[r+20>>2],tm_wday:P[r+24>>2],tm_yday:P[r+28>>2],tm_isdst:P[r+32>>2],tm_gmtoff:P[r+36>>2],tm_zone:i?fe(i):""},a=fe(n),s={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var u in s)a=a.replace(new RegExp(u,"g"),s[u]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=["January","February","March","April","May","June","July","August","September","October","November","December"];function f(e,t,n){for(var r="number"==typeof e?e.toString():e||"";r.length<t;)r=n[0]+r;return r}function p(e,t){return f(e,t,"0")}function m(e,t){function n(e){return e<0?-1:e>0?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function d(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function h(e){var t=function(e,t){for(var n=new Date(e.getTime());t>0;){var r=Ft(n.getFullYear()),i=n.getMonth(),o=(r?on:an)[i];if(!(t>o-n.getDate()))return n.setDate(n.getDate()+t),n;t-=o-n.getDate()+1,n.setDate(1),i<11?n.setMonth(i+1):(n.setMonth(0),n.setFullYear(n.getFullYear()+1))}return n}(new Date(e.tm_year+1900,0,1),e.tm_yday),n=new Date(t.getFullYear(),0,4),r=new Date(t.getFullYear()+1,0,4),i=d(n),o=d(r);return m(i,t)<=0?m(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var g={"%a":function(e){return c[e.tm_wday].substring(0,3)},"%A":function(e){return c[e.tm_wday]},"%b":function(e){return l[e.tm_mon].substring(0,3)},"%B":function(e){return l[e.tm_mon]},"%C":function(e){return p((e.tm_year+1900)/100|0,2)},"%d":function(e){return p(e.tm_mday,2)},"%e":function(e){return f(e.tm_mday,2," ")},"%g":function(e){return h(e).toString().substring(2)},"%G":h,"%H":function(e){return p(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),p(t,2)},"%j":function(e){return p(e.tm_mday+function(e,t){for(var n=0,r=0;r<=t;n+=e[r++]);return n}(Ft(e.tm_year+1900)?on:an,e.tm_mon-1),3)},"%m":function(e){return p(e.tm_mon+1,2)},"%M":function(e){return p(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return p(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=e.tm_yday+7-e.tm_wday;return p(Math.floor(t/7),2)},"%V":function(e){var t=Math.floor((e.tm_yday+7-(e.tm_wday+6)%7)/7);if((e.tm_wday+371-e.tm_yday-2)%7<=2&&t++,t){if(53==t){var n=(e.tm_wday+371-e.tm_yday)%7;4==n||3==n&&Ft(e.tm_year)||(t=1)}}else{t=52;var r=(e.tm_wday+7-e.tm_yday-1)%7;(4==r||5==r&&Ft(e.tm_year%400-1))&&t++}return p(t,2)},"%w":function(e){return e.tm_wday},"%W":function(e){var t=e.tm_yday+7-(e.tm_wday+6)%7;return p(Math.floor(t/7),2)},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,n=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(n?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var u in a=a.replace(/%%/g,"\0\0"),g)a.includes(u)&&(a=a.replace(new RegExp(u,"g"),g[u](o)));a=a.replace(/\0\0/g,"%");var v,y,w,_=(y=Ot(v=a)+1,w=new Array(y),pe(v,w,0,w.length),w);return _.length>t?0:(sn(_,e),_.length-1)},cn=jt,ln=function(e,t){e<128?t.push(e):t.push(e%128|128,e>>7)},fn=function(e,t){if("function"==typeof WebAssembly.Function)return new WebAssembly.Function(function(e){for(var t={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},n={parameters:[],results:"v"==e[0]?[]:[t[e[0]]]},r=1;r<e.length;++r)n.parameters.push(t[e[r]]);return n}(t),e);var n=[1];!function(e,t){var n=e.slice(0,1),r=e.slice(1),i={i:127,p:127,j:126,f:125,d:124,e:111};t.push(96),ln(r.length,t);for(var o=0;o<r.length;++o)t.push(i[r[o]]);"v"==n?t.push(0):t.push(1,i[n])}(t,n);var r=[0,97,115,109,1,0,0,0,1];ln(n.length,r),r.push.apply(r,n),r.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var i=new WebAssembly.Module(new Uint8Array(r));return new WebAssembly.Instance(i,{e:{f:e}}).exports.f},pn=function(e){return Qt||(Qt=new WeakMap,function(e,t){if(Qt)for(var n=e;n<e+t;n++){var r=ut(n);r&&Qt.set(r,n)}}(0,at.length)),Qt.get(e)||0},mn=[],dn=function(e,t){return at.set(e,t)};Object.getOwnPropertyDescriptor(Function.prototype,"name").configurable||(de=function(e,t){return t}),J=g.BindingError=function(e){function r(e){var n;return l(this,r),(n=t(this,r,[e])).name="BindingError",n}return n(r,e),f(r)}(r(Error)),ge.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),Object.assign(ge,{reserved:ge.allocated.length}),g.count_emval_handles=ye,Q=g.PureVirtualError=_e(Error,"PureVirtualError"),function(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);Z=e}(),g.getInheritedInstanceCount=Ce,g.getLiveInheritedInstances=Oe,g.flushPendingDeletes=Me,g.setDelayFunction=Ie,te=g.InternalError=function(e){function r(e){var n;return l(this,r),(n=t(this,r,[e])).name="InternalError",n}return n(r,e),f(r)}(r(Error)),Object.assign(Ke.prototype,{isAliasOf:function(e){if(!(this instanceof Ke))return!1;if(!(e instanceof Ke))return!1;var t=this.$$.ptrType.registeredClass,n=this.$$.ptr;e.$$=e.$$;for(var r=e.$$.ptrType.registeredClass,i=e.$$.ptr;t.baseClass;)n=t.upcast(n),t=t.baseClass;for(;r.baseClass;)i=r.upcast(i),r=r.baseClass;return t===r&&n===i},clone:function(){if(this.$$.ptr||Xe(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e,t=We(Object.create(Object.getPrototypeOf(this),{$$:{value:(e=this.$$,{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType})}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t},delete:function(){this.$$.ptr||Xe(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ve("Object already scheduled for deletion"),Le(this),xe(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted:function(){return!this.$$.ptr},deleteLater:function(){return this.$$.ptr||Xe(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ve("Object already scheduled for deletion"),Se.push(this),1===Se.length&&ee&&ee(Me),this.$$.deleteScheduled=!0,this}}),Object.assign(ot.prototype,{getPointee:function(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},destructor:function(e){var t;null===(t=this.rawDestructor)||void 0===t||t.call(this,e)},argPackAdvance:Be,readValueFromPointer:it,fromWireType:je}),st=g.UnboundTypeError=_e(Error,"UnboundTypeError"),kt="undefined"!=typeof Reflect?Reflect.construct:function(e,t){return new(e.bind.apply(e,[null].concat(t)))},g.requestFullscreen=Yt.requestFullscreen,g.requestAnimationFrame=Yt.requestAnimationFrame,g.setCanvasSize=Yt.setCanvasSize,g.pauseMainLoop=Yt.mainLoop.pause,g.resumeMainLoop=Yt.mainLoop.resume,g.getUserMedia=Yt.getUserMedia,g.createContext=Yt.createContext,Kt.init();var hn={x:function(e){var t=new se(e);return t.get_caught()||(t.set_caught(!0),oe--),t.set_rethrown(!1),ie.push(t),Tn(t.excPtr),t.get_exception_ptr()},B:function(){bn(0,0);var e=ie.pop();In(e.excPtr),ae=0},c:function(){return ue([])},j:function(e){return ue([e])},W:function(){var e=ie.pop();e||z("no exception to throw");var t=e.excPtr;throw e.get_rethrown()||(ie.push(e),e.set_rethrown(!0),e.set_caught(!1),oe++),ae=t},r:function(e,t,n){throw new se(e).init(t,n),oe++,ae=e},ga:function(){return oe},h:function(e){throw ae||(ae=e),ae},wa:function(e,t,n,r){},Z:function(e,t,n){return 0},sa:function(e,t){},la:function(e,t,n){},ta:function(e,t,n){return 0},pa:function(e,t){},ma:function(e,t,n){},qa:function(e,t,n,r){},_:function(e,t,n,r){},ja:function(e){},ra:function(e,t){},ka:function(e,t,n){},u:function(e,t,n){e=be(e),t=Pe(t,"wrapper"),n=we.toValue(n);var r=[].slice,i=t.registeredClass,o=i.instancePrototype,a=i.baseClass.instancePrototype,s=i.baseClass.constructor,u=de(e,(function(){i.baseClass.pureVirtualFunctions.forEach(function(e){if(this[e]===a[e])throw new Q("Pure virtual function ".concat(e," must be implemented in JavaScript"))}.bind(this)),Object.defineProperty(this,"__parent",{value:o}),this.__construct.apply(this,r.call(arguments))}));return o.__construct=function(){this===o&&ve("Pass correct 'this' to __construct");var e=s.implement.apply(void 0,[this].concat(r.call(arguments)));Le(e);var t,n,a,u=e.$$;e.notifyOnDestruction(),u.preservePointerOnDelete=!0,Object.defineProperties(this,{$$:{value:u}}),We(this),t=i,n=u.ptr,a=this,n=Re(t,n),Te.hasOwnProperty(n)?ve("Tried to register registered instance: ".concat(n)):Te[n]=a},o.__destruct=function(){var e,t;this===o&&ve("Pass correct 'this' to __destruct"),Le(this),e=i,t=this.$$.ptr,t=Re(e,t),Te.hasOwnProperty(t)?delete Te[t]:ve("Tried to unregister unregistered instance: ".concat(t))},u.prototype=Object.create(o),Object.assign(u.prototype,n),we.toHandle(u)},cb:function(e){var t=Ge[e];delete Ge[e];var n=t.rawConstructor,r=t.rawDestructor,i=t.fields,o=i.map((function(e){return e.getterReturnType})).concat(i.map((function(e){return e.setterArgumentType})));Ye([e],o,(function(e){var o={};return i.forEach((function(t,n){var r=t.fieldName,a=e[n],s=t.getter,u=t.getterContext,c=e[n+i.length],l=t.setter,f=t.setterContext;o[r]={read:function(e){return a.fromWireType(s(u,e))},write:function(e,t){var n=[];l(f,e,c.toWireType(n,t)),Ue(n)}}})),[{name:t.name,fromWireType:function(e){var t={};for(var n in o)t[n]=o[n].read(e);return r(e),t},toWireType:function(e,t){for(var i in o)if(!(i in t))throw new TypeError('Missing field: "'.concat(i,'"'));var a=n();for(i in o)o[i].write(a,t[i]);return null!==e&&e.push(r,a),a},argPackAdvance:Be,readValueFromPointer:qe,destructorFunction:r}]}))},ab:function(e,t,n,r,i){},ya:function(e,t,n,r){Ve(e,{name:t=be(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?n:r},argPackAdvance:Be,readValueFromPointer:function(e){return this.fromWireType(R[e])},destructorFunction:null})},d:function(e,t,n,r,i,o,a,s,u,c,l,f,p){l=be(l),o=lt(i,o),s&&(s=lt(a,s)),c&&(c=lt(u,c)),p=lt(f,p);var m=function(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=48&&t<=57?"_".concat(e):e}(l);Qe(m,(function(){ft("Cannot construct ".concat(l," due to unbound types"),[r])})),Ye([e,t,n],r?[r]:[],(function(t){var n,i;t=t[0],i=r?(n=t.registeredClass).instancePrototype:Ke.prototype;var a=de(l,(function(){if(Object.getPrototypeOf(this)!==u)throw new J("Use 'new' to construct "+l);if(void 0===h.constructor_body)throw new J(l+" has no accessible constructor");var e=h.constructor_body[arguments.length];if(void 0===e)throw new J("Tried to invoke ctor of ".concat(l," with invalid number of parameters (").concat(arguments.length,") - expected (").concat(Object.keys(h.constructor_body).toString(),") parameters instead!"));return e.apply(this,arguments)})),u=Object.create(i,{constructor:{value:a}});a.prototype=u;var f,d,h=new Ze(l,a,u,p,n,o,s,c);h.baseClass&&(null!==(d=(f=h.baseClass).__derivedClasses)&&void 0!==d||(f.__derivedClasses=[]),h.baseClass.__derivedClasses.push(h));var v=new ot(l,h,!0,!1,!1),y=new ot(l+"*",h,!1,!1,!1),w=new ot(l+" const*",h,!1,!0,!1);return De[e]={pointerType:y,constPointerType:w},function(e,t,n){g.hasOwnProperty(e)||$e("Replacing nonexistant public symbol"),void 0!==g[e].overloadTable&&void 0!==n?g[e].overloadTable[n]=t:(g[e]=t,g[e].argCount=n)}(m,a),[v,y,w]}))},p:function(e,t,n,r,i,o,a,s){var c=dt(n,r);t=be(t),t=ht(t),o=lt(i,o),Ye([],[e],(function(e){e=e[0];var r="".concat(e.name,".").concat(t);function i(){ft("Cannot call ".concat(r," due to unbound types"),c)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]);var s=e.registeredClass.constructor;return void 0===s[t]?(i.argCount=n-1,s[t]=i):(Je(s,t,r),s[t].overloadTable[n-1]=i),Ye([],c,(function(i){var c=[i[0],null].concat(i.slice(1)),l=pt(r,c,null,o,a);if(void 0===s[t].overloadTable?(l.argCount=n-1,s[t]=l):s[t].overloadTable[n-1]=l,e.registeredClass.__derivedClasses){var f,p=u(e.registeredClass.__derivedClasses);try{for(p.s();!(f=p.n()).done;){var m=f.value;m.constructor.hasOwnProperty(t)||(m.constructor[t]=l)}}catch(e){p.e(e)}finally{p.f()}}return[]})),[]}))},k:function(e,t,n,r,i,o){var a=dt(t,n);i=lt(r,i),Ye([],[e],(function(e){e=e[0];var n="constructor ".concat(e.name);if(void 0===e.registeredClass.constructor_body&&(e.registeredClass.constructor_body=[]),void 0!==e.registeredClass.constructor_body[t-1])throw new J("Cannot register multiple constructors with identical number of parameters (".concat(t-1,") for class '").concat(e.name,"'! Overload resolution is currently only performed using the parameter count, not actual type info!"));return e.registeredClass.constructor_body[t-1]=function(){ft("Cannot construct ".concat(e.name," due to unbound types"),a)},Ye([],a,(function(r){return r.splice(1,0,null),e.registeredClass.constructor_body[t-1]=pt(n,r,null,i,o),[]})),[]}))},b:function(e,t,n,r,i,o,a,s,u){var c=dt(n,r);t=be(t),t=ht(t),o=lt(i,o),Ye([],[e],(function(e){e=e[0];var r="".concat(e.name,".").concat(t);function i(){ft("Cannot call ".concat(r," due to unbound types"),c)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]),s&&e.registeredClass.pureVirtualFunctions.push(t);var u=e.registeredClass.instancePrototype,l=u[t];return void 0===l||void 0===l.overloadTable&&l.className!==e.name&&l.argCount===n-2?(i.argCount=n-2,i.className=e.name,u[t]=i):(Je(u,t,r),u[t].overloadTable[n-2]=i),Ye([],c,(function(i){var s=pt(r,i,e,o,a);return void 0===u[t].overloadTable?(s.argCount=n-2,u[t]=s):u[t].overloadTable[n-2]=s,[]})),[]}))},a:function(e,t,n,r,i,o,a,s,u,c){t=be(t),i=lt(r,i),Ye([],[e],(function(e){e=e[0];var r="".concat(e.name,".").concat(t),l={get:function(){ft("Cannot access ".concat(r," due to unbound types"),[n,a])},enumerable:!0,configurable:!0};return l.set=u?function(){return ft("Cannot access ".concat(r," due to unbound types"),[n,a])}:function(e){return ve(r+" is a read-only property")},Object.defineProperty(e.registeredClass.instancePrototype,t,l),Ye([],u?[n,a]:[n],(function(n){var a=n[0],l={get:function(){var t=gt(this,e,r+" getter");return a.fromWireType(i(o,t))},enumerable:!0};if(u){u=lt(s,u);var f=n[1];l.set=function(t){var n=gt(this,e,r+" setter"),i=[];u(c,n,f.toWireType(i,t)),Ue(i)}}return Object.defineProperty(e.registeredClass.instancePrototype,t,l),[]})),[]}))},z:function(e,t,n){e=be(e),Ye([],[t],(function(t){return t=t[0],g[e]=t.fromWireType(n),[]}))},xa:function(e){return Ve(e,yt)},E:function(e,t,n,r){function i(){}t=be(t),i.values={},Ve(e,{name:t,constructor:i,fromWireType:function(e){return this.constructor.values[e]},toWireType:function(e,t){return t.value},argPackAdvance:Be,readValueFromPointer:wt(t,n,r),destructorFunction:null}),Qe(t,i)},o:function(e,t,n){var r=Pe(e,"enum");t=be(t);var i=r.constructor,o=Object.create(r.constructor.prototype,{value:{value:n},constructor:{value:de("".concat(r.name,"_").concat(t),(function(){}))}});i.values[n]=o,i[t]=o},aa:function(e,t,n){Ve(e,{name:t=be(t),fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:Be,readValueFromPointer:bt(t,n),destructorFunction:null})},F:function(e,t,n,r,i){t=be(t);var o=function(e){return e};if(0===r){var a=32-8*n;o=function(e){return e<<a>>>a}}var s=t.includes("unsigned");Ve(e,{name:t,fromWireType:o,toWireType:s?function(e,t){return this.name,t>>>0}:function(e,t){return this.name,t},argPackAdvance:Be,readValueFromPointer:Ct(t,n,0!==r),destructorFunction:null})},y:function(e,t,n){var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function i(e){var t=L[e>>2],n=L[e+4>>2];return new r(T.buffer,n,t)}Ve(e,{name:n=be(n),fromWireType:i,argPackAdvance:Be,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})},s:function(e,t,n,r,i,o,a,s,u,c,l,f){n=be(n),o=lt(i,o),s=lt(a,s),c=lt(u,c),f=lt(l,f),Ye([e],[t],(function(e){return e=e[0],[new ot(n,e.registeredClass,!1,!1,!0,e,r,o,s,c,f)]}))},$:function(e,t){var n="std::string"===(t=be(t));Ve(e,{name:t,fromWireType:function(e){var t,r=L[e>>2],i=e+4;if(n)for(var o=i,a=0;a<=r;++a){var s=i+a;if(a==r||0==R[s]){var u=fe(o,s-o);void 0===t?t=u:(t+=String.fromCharCode(0),t+=u),o=s+1}}else{var c=new Array(r);for(a=0;a<r;++a)c[a]=String.fromCharCode(R[i+a]);t=c.join("")}return wn(e),t},toWireType:function(e,t){var r;t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i="string"==typeof t;i||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||ve("Cannot pass non-string to std::string"),r=n&&i?Ot(t):t.length;var o=vn(4+r+1),a=o+4;if(L[o>>2]=r,n&&i)me(t,a,r+1);else if(i)for(var s=0;s<r;++s){var u=t.charCodeAt(s);u>255&&(wn(a),ve("String has UTF-16 code units that do not fit in 8 bits")),R[a+s]=u}else for(s=0;s<r;++s)R[a+s]=t[s];return null!==e&&e.push(wn,o),o},argPackAdvance:Be,readValueFromPointer:it,destructorFunction:function(e){wn(e)}})},R:function(e,t,n){var r,i,o,a,s;n=be(n),2===t?(r=Mt,i=It,a=Tt,o=function(){return A},s=1):4===t&&(r=Rt,i=Et,a=At,o=function(){return L},s=2),Ve(e,{name:n,fromWireType:function(e){for(var n,i=L[e>>2],a=o(),u=e+4,c=0;c<=i;++c){var l=e+4+c*t;if(c==i||0==a[l>>s]){var f=r(u,l-u);void 0===n?n=f:(n+=String.fromCharCode(0),n+=f),u=l+t}}return wn(e),n},toWireType:function(e,r){"string"!=typeof r&&ve("Cannot pass non-string to C++ string type ".concat(n));var o=a(r),u=vn(4+o+t);return L[u>>2]=o>>s,i(r,u+4,o+t),null!==e&&e.push(wn,u),u},argPackAdvance:Be,readValueFromPointer:qe,destructorFunction:function(e){wn(e)}})},fa:function(e,t,n,r,i,o){Ge[e]={name:be(t),rawConstructor:lt(n,r),rawDestructor:lt(i,o),fields:[]}},ba:function(e,t,n,r,i,o,a,s,u,c){Ge[e].fields.push({fieldName:be(t),getterReturnType:n,getter:lt(r,i),getterContext:o,setterArgumentType:a,setter:lt(s,u),setterContext:c})},za:function(e,t){Ve(e,{isVoid:!0,name:t=be(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})},Aa:function(e){if(Kt.xhrs.has(e)){var t=Kt.xhrs.get(e);Kt.xhrs.free(e),t.readyState>0&&t.readyState<4&&t.abort()}},ua:function(){return 1},Sa:function(e,t,n,r){return(e=Pt[e])(null,t=we.toValue(t),n,r)},n:function(e,t,n,r,i){var o,a;return(e=Pt[e])(t=we.toValue(t),t[n=void 0===(a=Lt[o=n])?be(o):a],r,i)},e:vt,l:function(e,t,n){var r=function(e,t){for(var n=new Array(e),r=0;r<e;++r)n[r]=Pe(L[t+4*r>>2],"parameter "+r);return n}(e,t),i=r.shift();e--;var o,a,s=new Array(e),u="methodCaller<(".concat(r.map((function(e){return e.name})).join(", "),") => ").concat(i.name,">");return o=de(u,(function(t,o,a,u){for(var c=0,l=0;l<e;++l)s[l]=r[l].readValueFromPointer(u+c),c+=r[l].argPackAdvance;var f=1===n?kt(o,s):o.apply(t,s);return function(e,t,n){var r=[],i=e.toWireType(r,n);return r.length&&(L[t>>2]=we.toHandle(r)),i}(i,a,f)})),a=Pt.length,Pt.push(o),a},P:function(e){e>4&&(ge.get(e).refcount+=1)},m:function(e){var t=we.toValue(e);Ue(t),vt(e)},J:function(e,t){var n=(e=Pe(e,"_emval_take_value")).readValueFromPointer(t);return we.toHandle(n)},Ya:function(e,t,n){var r=xt(e,t),i=new Date(1e3*r);P[n>>2]=i.getUTCSeconds(),P[n+4>>2]=i.getUTCMinutes(),P[n+8>>2]=i.getUTCHours(),P[n+12>>2]=i.getUTCDate(),P[n+16>>2]=i.getUTCMonth(),P[n+20>>2]=i.getUTCFullYear()-1900,P[n+24>>2]=i.getUTCDay();var o=Date.UTC(i.getUTCFullYear(),0,1,0,0,0,0),a=(i.getTime()-o)/864e5|0;P[n+28>>2]=a},Za:function(e,t,n){var r=xt(e,t),i=new Date(1e3*r);P[n>>2]=i.getSeconds(),P[n+4>>2]=i.getMinutes(),P[n+8>>2]=i.getHours(),P[n+12>>2]=i.getDate(),P[n+16>>2]=i.getMonth(),P[n+20>>2]=i.getFullYear()-1900,P[n+24>>2]=i.getDay();var o=0|Nt(i);P[n+28>>2]=o,P[n+36>>2]=-60*i.getTimezoneOffset();var a=new Date(i.getFullYear(),0,1),s=new Date(i.getFullYear(),6,1).getTimezoneOffset(),u=a.getTimezoneOffset(),c=0|(s!=u&&i.getTimezoneOffset()==Math.min(u,s));P[n+32>>2]=c},_a:function(e){var t=function(){var t=new Date(P[e+20>>2]+1900,P[e+16>>2],P[e+12>>2],P[e+8>>2],P[e+4>>2],P[e>>2],0),n=P[e+32>>2],r=t.getTimezoneOffset(),i=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=i.getTimezoneOffset(),s=Math.min(a,o);if(n<0)P[e+32>>2]=Number(o!=a&&s==r);else if(n>0!=(s==r)){var u=Math.max(a,o),c=n>0?s:u;t.setTime(t.getTime()+6e4*(c-r))}P[e+24>>2]=t.getDay();var l=0|Nt(t);P[e+28>>2]=l,P[e>>2]=t.getSeconds(),P[e+4>>2]=t.getMinutes(),P[e+8>>2]=t.getHours(),P[e+12>>2]=t.getDate(),P[e+16>>2]=t.getMonth(),P[e+20>>2]=t.getYear();var f=t.getTime();return isNaN(f)?-1:f/1e3}();return Cn((V=t,+Math.abs(V)>=1?V>0?+Math.floor(V/4294967296)>>>0:~~+Math.ceil((V-+(~~V>>>0))/4294967296)>>>0:0)),t>>>0},Xa:function(e,t,n,r,i,o,a){},ia:function(e,t,n){var r=(new Date).getFullYear(),i=new Date(r,0,1),o=new Date(r,6,1),a=i.getTimezoneOffset(),s=o.getTimezoneOffset(),u=Math.max(a,s);function c(e){var t=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return t?t[1]:"GMT"}L[e>>2]=60*u,P[t>>2]=Number(a!=s);var l=c(i),f=c(o),p=jt(l),m=jt(f);s<a?(L[n>>2]=p,L[n+4>>2]=m):(L[n>>2]=m,L[n+4>>2]=p)},O:function(){z("")},Qa:function(e,t,n){function r(){ut(e)(t)}n>=0?Ht(r,n):Yt.safeRequestAnimationFrame(r)},Ha:function(e){clearInterval(e)},Ja:Vt,Q:function(){return Date.now()},M:mt,Na:function(e,t,n,r,i){Bt.existsFile(fe(e),fe(t),(function(e,t){zt((function(){e?i&&ut(i)(n):r&&ut(r)(n,t)}))}))},Oa:function(e,t,n,r,i){Bt.getFile(fe(e),fe(t),(function(e,t){zt((function(){if(e)i&&ut(i)(n);else{var o=vn(t.length);R.set(t,o),ut(r)(n,o,t.length),wn(o)}}))}))},Pa:function(e,t,n,r,i,o,a){Bt.setFile(fe(e),fe(t),new Uint8Array(R.subarray(n,n+r)),(function(e){zt((function(){e?a&&ut(a)(i):o&&ut(o)(i)}))}))},Ca:function(){return!0},va:Xt,ha:function(e){R.length,z("OOM")},Ia:function(e,t,n){return setInterval((function(){zt((function(){return ut(e)(n)}))}),t)},Ka:function(e,t,n){return Ht((function(){return ut(e)(n)}),t)},Ba:function(e,t,n,r,i){var o=e+112,a=L[o+36>>2],s=L[o+40>>2];L[o+44>>2],L[o+48>>2];var u=!!(64&L[o+52>>2]);function c(e){u?e():zt(e)}return Jt(e,(function(e,n,r){c((function(){a?ut(a)(e):null==t||t(e)}))}),(function(e,t,r){c((function(){s?ut(s)(e):null==n||n(e)}))})),e},na:function(e,t){var n=0;return tn().forEach((function(r,i){var o=t+n;L[e+4*i>>2]=o,function(e,t){for(var n=0;n<e.length;++n)T[0|t++]=e.charCodeAt(n);T[0|t]=0}(r,o),n+=r.length+1})),0},oa:function(e,t){var n=tn();L[e>>2]=n.length;var r=0;return n.forEach((function(e){return r+=e.length+1})),L[t>>2]=r,0},N:function(e){return 52},X:function(e,t,n,r){return 52},$a:function(e,t,n,r,i){return 70},Y:function(e,t,n,r){for(var i,o,a,s=0,u=0;u<n;u++){var c=L[t>>2],l=L[t+4>>2];t+=8;for(var f=0;f<l;f++)i=e,o=R[c+f],a=void 0,a=nn[i],0===o||10===o?((1===i?S:M)(le(a,0)),a.length=0):a.push(o);s+=l}return L[r>>2]=s,0},Ra:function(){var e,t,n,r,i="";return globalThis&&globalThis.navigator&&(i=globalThis.navigator.userAgent.toLowerCase()),e=globalThis&&"wx"===globalThis.__ALIVC_IM_PLATFORM__?function(){var e={os:"wx"};if("undefined"!=typeof wx){if(wx.getSystemInfoSync){var t=wx.getSystemInfoSync();t&&(t.version&&(e.osv=t.version),t.platform&&(e.tt=t.platform),t.model&&(e.dm=t.model),t.brand&&(e.db=t.brand),t.SDKVersion&&(e.wx_sdkversion=t.SDKVersion))}var n={};if("undefined"!=typeof __wxConfig&&__wxConfig.accountInfo)n=__wxConfig.accountInfo;else if(wx.getAccountInfoSync){var r=wx.getAccountInfoSync();r&&r.miniProgram&&(n=r.miniProgram)}n.appId&&(e.wx_appid=n.appId),n.nickname&&(e.wx_appname=n.nickname)}return e}():function(e){var t={os:"web"},n="",r="";try{/Windows NT (\d+\.\d+)/i.test(e)?(r="Windows",n=e.match(/Windows NT (\d+\.\d+)/i)[1]):/Mac OS X (\d+[\.\_]\d+[\.\_]\d+)/i.test(e)?(r="macOS",n=e.match(/Mac OS X (\d+[\.\_]\d+[\.\_]\d+)/i)[1].replace(/_/g,".")):/Mac OS X (\d+[\.\_]\d+)/i.test(e)?(r="macOS",n=e.match(/Mac OS X (\d+[\.\_]\d+)/i)[1].replace(/_/g,".")):/Android (\d+\.\d+)/i.test(e)?(r="Android",n=e.match(/Android (\d+\.\d+)/i)[1]):/iPhone OS (\d+_\d+)/i.test(e)?(r="iOS",n=e.match(/iPhone OS (\d+_\d+)/i)[1].replace(/_/g,".")):/iPad.*OS (\d+_\d+)/i.test(e)&&(r="iOS",n=e.match(/iPad.*OS (\d+_\d+)/i)[1].replace(/_/g,"."))}catch(e){}t.tt=r,t.osv=n;for(var i="",o="",a=[[/(opera|opr)[\/\s](\d+(\.\d+)?)/i,"Opera"],[/(edge|edg)[\/\s](\d+(\.\d+)?)/i,"Edge"],[/(chrome)[\/\s](\d+(\.\d+)?)/i,"Chrome"],[/(safari)[\/\s](\d+(\.\d+)?)/i,"Safari"],[/(firefox)[\/\s](\d+(\.\d+)?)/i,"Firefox"],[/(msie|trident)[\/\s]?(\d+(\.\d+)?)/i,"Internet Explorer"]],s=0;s<a.length;s++){var u=e.match(a[s][0]);if(u){o=a[s][1],i=u[2];break}}t.db=o,t.dm=i,t.appname=globalThis._core||"",t.appver=globalThis._transport||"";var c=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return c&&(t.nt=c.effectiveType||""),t}(i),t=JSON.stringify(e),n=Ot(t)+1,r=vn(n),me(t,r,n),r},da:function(e,t){return rn(R.subarray(e,e+t)),0},S:function(e,t,n,r){var i=On();try{return ut(e)(t,n,r)}catch(e){if(Sn(i),e!==e+0)throw e;bn(1,0)}},T:function(e,t,n,r){var i=On();try{return ut(e)(t,n,r)}catch(e){if(Sn(i),e!==e+0)throw e;bn(1,0)}},v:function(e){var t=On();try{return ut(e)()}catch(e){if(Sn(t),e!==e+0)throw e;bn(1,0)}},f:function(e,t){var n=On();try{return ut(e)(t)}catch(e){if(Sn(n),e!==e+0)throw e;bn(1,0)}},i:function(e,t,n){var r=On();try{return ut(e)(t,n)}catch(e){if(Sn(r),e!==e+0)throw e;bn(1,0)}},w:function(e,t,n,r){var i=On();try{return ut(e)(t,n,r)}catch(e){if(Sn(i),e!==e+0)throw e;bn(1,0)}},t:function(e,t,n,r,i){var o=On();try{return ut(e)(t,n,r,i)}catch(e){if(Sn(o),e!==e+0)throw e;bn(1,0)}},H:function(e,t,n,r,i,o){var a=On();try{return ut(e)(t,n,r,i,o)}catch(e){if(Sn(a),e!==e+0)throw e;bn(1,0)}},G:function(e,t,n,r,i,o,a){var s=On();try{return ut(e)(t,n,r,i,o,a)}catch(e){if(Sn(s),e!==e+0)throw e;bn(1,0)}},U:function(e,t,n,r,i,o,a,s){var u=On();try{return ut(e)(t,n,r,i,o,a,s)}catch(e){if(Sn(u),e!==e+0)throw e;bn(1,0)}},L:function(e,t,n,r,i,o,a,s,u,c,l,f){var p=On();try{return ut(e)(t,n,r,i,o,a,s,u,c,l,f)}catch(e){if(Sn(p),e!==e+0)throw e;bn(1,0)}},Ua:function(e,t,n,r,i,o,a){var s=On();try{return kn(e,t,n,r,i,o,a)}catch(e){if(Sn(s),e!==e+0)throw e;bn(1,0)}},Wa:function(e){var t=On();try{return Pn(e)}catch(e){if(Sn(t),e!==e+0)throw e;bn(1,0)}},Ta:function(e,t,n,r,i){var o=On();try{return xn(e,t,n,r,i)}catch(e){if(Sn(o),e!==e+0)throw e;bn(1,0)}},q:function(e){var t=On();try{ut(e)()}catch(e){if(Sn(t),e!==e+0)throw e;bn(1,0)}},C:function(e,t){var n=On();try{ut(e)(t)}catch(e){if(Sn(n),e!==e+0)throw e;bn(1,0)}},g:function(e,t,n){var r=On();try{ut(e)(t,n)}catch(e){if(Sn(r),e!==e+0)throw e;bn(1,0)}},bb:function(e,t,n,r){var i=On();try{ut(e)(t,n,r)}catch(e){if(Sn(i),e!==e+0)throw e;bn(1,0)}},ca:function(e,t,n,r){var i=On();try{ut(e)(t,n,r)}catch(e){if(Sn(i),e!==e+0)throw e;bn(1,0)}},A:function(e,t,n,r){var i=On();try{ut(e)(t,n,r)}catch(e){if(Sn(i),e!==e+0)throw e;bn(1,0)}},V:function(e,t,n,r,i){var o=On();try{ut(e)(t,n,r,i)}catch(e){if(Sn(o),e!==e+0)throw e;bn(1,0)}},D:function(e,t,n,r,i,o,a,s){var u=On();try{ut(e)(t,n,r,i,o,a,s)}catch(e){if(Sn(u),e!==e+0)throw e;bn(1,0)}},I:function(e,t,n,r,i,o,a,s,u,c,l){var f=On();try{ut(e)(t,n,r,i,o,a,s,u,c,l)}catch(e){if(Sn(f),e!==e+0)throw e;bn(1,0)}},K:function(e,t,n,r,i,o,a,s,u,c,l,f,p,m,d,h){var g=On();try{ut(e)(t,n,r,i,o,a,s,u,c,l,f,p,m,d,h)}catch(e){if(Sn(g),e!==e+0)throw e;bn(1,0)}},Va:function(e,t,n,r,i,o,a){var s=On();try{Ln(e,t,n,r,i,o,a)}catch(e){if(Sn(s),e!==e+0)throw e;bn(1,0)}},Ga:function(e,t,n,r,i,o){var a=fe(t),s=R.subarray(i,i+o);g.sendData&&g.sendData(e,a,n,r,s)},Ea:function(e,t){var n=fe(e),r=fe(t);g.subscribe&&g.subscribe(n,r)},Da:function(e,t){var n=fe(e),r=fe(t);g.unSubscribe&&g.unSubscribe(n,r)},Fa:function(e,t,n){var r=fe(t),i=fe(n);g.sendData&&g.sendData(e,r,0,!1,i)},ea:function(e,t,n,r,i){return un(e,t,n,r)},Ma:function(e){var t=null;if(void 0!==window.crypto&&void 0!==window.crypto.getRandomValues&&(t=new Uint8Array(16),window.crypto.getRandomValues(t)),!t){t=new Array(16);for(var n=(new Date).getTime(),r=0;r<16;r++){var i=(n+256*Math.random())%256|0;n=n/256|0,t[r]=i}}t[6]=15&t[6]|64,t[8]=63&t[8]|128,sn(t,e)},La:function(e,t,n){var r=0,i="xxxx-xx-xx-xx-xxxxxx".replace(/[x]/g,(function(t){var i=n?R[e+r|0].toString(16).toUpperCase():R[e+r|0].toString(16);return i=1===i.length?"0"+i:i,r++,i}));me(i,t,37)}},gn=function(){var e,t,n,r,i,o={a:hn};function a(e,t){var n,r;return gn=e.exports,O=gn.db,n=O.buffer,g.HEAP8=T=new Int8Array(n),g.HEAP16=E=new Int16Array(n),g.HEAPU8=R=new Uint8Array(n),g.HEAPU16=A=new Uint16Array(n),g.HEAP32=P=new Int32Array(n),g.HEAPU32=L=new Uint32Array(n),g.HEAPF32=k=new Float32Array(n),g.HEAPF64=x=new Float64Array(n),at=gn.fb,r=gn.eb,N.unshift(r),function(e){var t;if(U--,null===(t=g.monitorRunDependencies)||void 0===t||t.call(g,U),0==U&&q){var n=q;q=null,n()}}(),gn}if(U++,null===(e=g.monitorRunDependencies)||void 0===e||e.call(g,U),g.instantiateWasm)try{return g.instantiateWasm(o,a)}catch(e){M("Module.instantiateWasm callback failed with error: ".concat(e)),h(e)}return(t=C,n=H,r=o,i=function(e){a(e.instance)},t||"function"!=typeof WebAssembly.instantiateStreaming||B(n)||"function"!=typeof fetch?X(n,r,i):fetch(n,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,r).then(i,(function(e){return M("wasm streaming compile failed: ".concat(e)),M("falling back to ArrayBuffer instantiation"),X(n,r,i)}))}))).catch(h),{}}(),vn=g._malloc=function(e){return(vn=g._malloc=gn.gb)(e)},yn=g._main=function(e,t){return(yn=g._main=gn.hb)(e,t)},wn=g._free=function(e){return(wn=g._free=gn.ib)(e)},_n=function(e){return(_n=gn.jb)(e)},bn=function(e,t){return(bn=gn.kb)(e,t)},Cn=function(e){return(Cn=gn.lb)(e)},On=function(){return(On=gn.mb)()},Sn=function(e){return(Sn=gn.nb)(e)},Mn=function(e){return(Mn=gn.ob)(e)},In=function(e){return(In=gn.pb)(e)},Tn=function(e){return(Tn=gn.qb)(e)},Rn=function(e,t,n){return(Rn=gn.rb)(e,t,n)},En=function(e){return(En=gn.sb)(e)};g.dynCall_iiijii=function(e,t,n,r,i,o,a){return(g.dynCall_iiijii=gn.tb)(e,t,n,r,i,o,a)},g.dynCall_viij=function(e,t,n,r,i){return(g.dynCall_viij=gn.ub)(e,t,n,r,i)},g.dynCall_jii=function(e,t,n){return(g.dynCall_jii=gn.vb)(e,t,n)},g.dynCall_iiiiijiiii=function(e,t,n,r,i,o,a,s,u,c,l){return(g.dynCall_iiiiijiiii=gn.wb)(e,t,n,r,i,o,a,s,u,c,l)},g.dynCall_iiiiji=function(e,t,n,r,i,o,a){return(g.dynCall_iiiiji=gn.xb)(e,t,n,r,i,o,a)},g.dynCall_iiiijiijj=function(e,t,n,r,i,o,a,s,u,c,l,f){return(g.dynCall_iiiijiijj=gn.yb)(e,t,n,r,i,o,a,s,u,c,l,f)},g.dynCall_iiiiiiijjiii=function(e,t,n,r,i,o,a,s,u,c,l,f,p,m){return(g.dynCall_iiiiiiijjiii=gn.zb)(e,t,n,r,i,o,a,s,u,c,l,f,p,m)},g.dynCall_jiiiiiii=function(e,t,n,r,i,o,a,s){return(g.dynCall_jiiiiiii=gn.Ab)(e,t,n,r,i,o,a,s)},g.dynCall_viiiij=function(e,t,n,r,i,o,a){return(g.dynCall_viiiij=gn.Bb)(e,t,n,r,i,o,a)},g.dynCall_viiji=function(e,t,n,r,i,o){return(g.dynCall_viiji=gn.Cb)(e,t,n,r,i,o)},g.dynCall_viiij=function(e,t,n,r,i,o){return(g.dynCall_viiij=gn.Db)(e,t,n,r,i,o)},g.dynCall_jiii=function(e,t,n,r){return(g.dynCall_jiii=gn.Eb)(e,t,n,r)},g.dynCall_vij=function(e,t,n,r){return(g.dynCall_vij=gn.Fb)(e,t,n,r)},g.dynCall_ji=function(e,t){return(g.dynCall_ji=gn.Gb)(e,t)},g.dynCall_jiji=function(e,t,n,r,i){return(g.dynCall_jiji=gn.Hb)(e,t,n,r,i)};var An,Pn=g.dynCall_j=function(e){return(Pn=g.dynCall_j=gn.Ib)(e)},Ln=g.dynCall_viijii=function(e,t,n,r,i,o,a){return(Ln=g.dynCall_viijii=gn.Jb)(e,t,n,r,i,o,a)},kn=g.dynCall_iiiiij=function(e,t,n,r,i,o,a){return(kn=g.dynCall_iiiiij=gn.Kb)(e,t,n,r,i,o,a)},xn=g.dynCall_jiiii=function(e,t,n,r,i){return(xn=g.dynCall_jiiii=gn.Lb)(e,t,n,r,i)};function Fn(){function e(){An||(An=!0,g.calledRun=!0,F||(ne(N),ne(j),d(g),g.onRuntimeInitialized&&g.onRuntimeInitialized(),Dn&&function(){var e=yn;try{var t=e(0,0);return Ut(t,!0),t}catch(e){return Wt(e)}}(),function(){if(g.postRun)for("function"==typeof g.postRun&&(g.postRun=[g.postRun]);g.postRun.length;)e=g.postRun.shift(),W.unshift(e);var e;ne(W)}()))}U>0||(function(){if(g.preRun)for("function"==typeof g.preRun&&(g.preRun=[g.preRun]);g.preRun.length;)e=g.preRun.shift(),$.unshift(e);var e;ne($)}(),U>0||(g.setStatus?(g.setStatus("Running..."),setTimeout((function(){setTimeout((function(){g.setStatus("")}),1),e()}),1)):e()))}if(g.dynCall_iiiiijj=function(e,t,n,r,i,o,a,s,u){return(g.dynCall_iiiiijj=gn.Mb)(e,t,n,r,i,o,a,s,u)},g.dynCall_iiiiiijj=function(e,t,n,r,i,o,a,s,u,c){return(g.dynCall_iiiiiijj=gn.Nb)(e,t,n,r,i,o,a,s,u,c)},g.ccall=function(e,t,n,r,i){var o={string:function(e){var t=0;return null!=e&&0!==e&&(t=function(e){var t=Ot(e)+1,n=Mn(t);return me(e,n,t),n}(e)),t},array:function(e){var t=Mn(e.length);return sn(e,t),t}},a=function(e){return g["_"+e]}(e),s=[],u=0;if(r)for(var c=0;c<r.length;c++){var l=o[n[c]];l?(0===u&&(u=On()),s[c]=l(r[c])):s[c]=r[c]}var f,p=a.apply(null,s);return f=p,0!==u&&Sn(u),p=function(e){return"string"===t?fe(e):"boolean"===t?Boolean(e):e}(f),p},g.addFunction=function(e,t){var n=pn(e);if(n)return n;var r=function(){if(mn.length)return mn.pop();try{at.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return at.length-1}();try{dn(r,e)}catch(n){if(!(n instanceof TypeError))throw n;var i=fn(e,t);dn(r,i)}return Qt.set(e,r),r},g.removeFunction=function(e){Qt.delete(ut(e)),dn(e,null),mn.push(e)},g.UTF8ToString=fe,g.allocate=function(e,t){var n;return n=1==t?Mn(e.length):vn(e.length),e.subarray||e.slice||(e=new Uint8Array(e)),R.set(e,n),n},g.allocateUTF8=cn,q=function e(){An||Fn(),An||(q=e)},g.preInit)for("function"==typeof g.preInit&&(g.preInit=[g.preInit]);g.preInit.length>0;)g.preInit.pop()();var Dn=!0;return g.noInitialRun&&(Dn=!1),Fn(),g.wasmOnReceiveData=function(e,t){if(t instanceof Uint8Array){var n=vn(t.length);R.set(t,n),g.TransportDataHandler.OnReceiveData(e,n,t.length)}else g.TransportDataHandler.OnReceiveMessage(e,t)},g.wasmOnConnectResult=function(e,t){g.TransportDataHandler.OnConnectResult(e,t)},g.wasmOnConnectionLostEvent=function(e){g.TransportDataHandler.OnConnectionLostEvent(e)},g.wasmOnIpSwitchEvent=function(e,t){g.TransportDataHandler.OnIpSwitchEvent(e,t)},g.wasmOnConnectionEvent=function(e){g.TransportDataHandler.OnConnectionEvent(e)},g.wasmOnReceiveData=function(e,t){if(t instanceof Uint8Array){var n=vn(t.length);R.set(t,n),g.TransportDataHandler.OnReceiveData(e,n,t.length)}else g.TransportDataHandler.OnReceiveMessage(e,t)},g.wasmOnConnectResult=function(e,t){g.TransportDataHandler.OnConnectResult(e,t)},g.wasmOnConnectionLostEvent=function(e){g.TransportDataHandler.OnConnectionLostEvent(e)},g.wasmOnIpSwitchEvent=function(e,t){g.TransportDataHandler.OnIpSwitchEvent(e,t)},g.wasmOnConnectionEvent=function(e){g.TransportDataHandler.OnConnectionEvent(e)},e.ready}),c=(e=>(e[e.ASC=0]="ASC",e[e.DESC=1]="DESC",e))(c||{});const l=e=>{const t=[];for(var n=0;n<e.size();n++)t.push(e.get(n));return t},f=e=>{const t={},n=e.keys();for(var r=0;r<n.size();r++){const i=n.get(r);t[i]=e.get(i)}return t},p=(e,t)=>{const n=t.values[e];if(n)return n},m=e=>!!e||0===e,d=(e,t,n)=>{const r=Array.isArray(t)?t:t.replace(/\[(\d+)\]/g,".$1").split(".");let i=e;for(const e of r)if(i=null!=i?i[e]:void 0,void 0===i)return n;return i},h=(e,t,n)=>!n.required||null!=t&&""!==t?n.type&&typeof t!==n.type?`Property "${e}" should be of type "${n.type}".`:void 0!==n.minLength&&"string"==typeof t&&t.length<n.minLength?`Property "${e}" should have at least ${n.minLength} characters.`:void 0!==n.maxLength&&"string"==typeof t&&t.length>n.maxLength?`Property "${e}" should have at most ${n.maxLength} characters.`:void 0!==n.min&&"number"==typeof t&&t<n.min?`Property "${e}" value cannot be less than ${n.min}.`:void 0!==n.max&&"number"==typeof t&&t>n.max?`Property "${e}" value cannot be greater than ${n.max}.`:"":`Property "${e}" is required.`,g={groupId:"",type:0,nextpagetoken:0,sortType:c.ASC,pageSize:10},v={groupId:"",seqnum:0,pageSize:50};var y=(e=>(e[e.NORMAL=0]="NORMAL",e[e.HIGH=1]="HIGH",e))(y||{});const w={userId:"",userExtension:""},_=e=>({userId:e.user_id,userExtension:e.user_extension}),b=e=>{const t=[];for(var n=0;n<e.size();n++)t.push(_(e.get(n)));return t};y.NORMAL;const C=e=>{return{groupId:e.group_id,messageId:e.message_id,type:e.type,sender:e.sender?_(e.sender):void 0,data:e.data,seqnum:+e.getSeqNum(),timestamp:+e.getTimestamp(),level:(t=e.level,n=y.NORMAL,t?.value||n),repeatCount:e.repeat_count,totalMsgs:e.total_msgs};var t,n},O={groupId:"",type:0,data:"",skipMuteCheck:!1,skipAudit:!1,level:y.NORMAL,noStorage:!1,repeatCount:1},S={type:0,data:"",receiverId:"",skipAudit:!1,level:y.NORMAL};var M=Object.defineProperty,I=(e,t,n)=>(((e,t,n)=>{t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class T extends Error{constructor(e,t){super(e),I(this,"code",0),I(this,"msg",""),t&&(this.code=t),this.msg=e}static fromWASMError(e){const t=e.code,n=e.msg;return new T(n,t)}get name(){return"IMError"}get message(){return this.msg}}const R={groupId:"",type:0,nextPageToken:0,sortType:c.ASC,pageSize:10,beginTime:0,endTime:0};var E=Object.defineProperty,A=(e,t,n)=>(((e,t,n)=>{t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class P extends s{constructor(e,t){super(),A(this,"wasmIns"),A(this,"wasmMessageManager"),A(this,"messageListener"),this.wasmIns=e,this.wasmMessageManager=t.GetMessageManager()}addMessageListener(){this.messageListener=this.wasmIns.ImMessageListenerWrapper.implement({OnRecvC2cMessage:e=>{this.emit("recvc2cmessage",C(e))},OnRecvGroupMessage:(e,t)=>{this.emit("recvgroupmessage",C(e),t)},OnDeleteGroupMessage:(e,t)=>{this.emit("deletegroupmessage",e,t)}}),this.wasmMessageManager.AddMessageListener(this.messageListener)}removeMessageListener(){this.messageListener&&(this.wasmMessageManager.RemoveMessageListener(this.messageListener),this.messageListener.delete(),this.messageListener=null)}async sendC2cMessage(e){const t=((e,t)=>{const n=new e.ImSendMessageToUserReq,r={...S,...t};if(n.type=r.type,n.data=r.data,n.receiver_id=r.receiverId,n.skip_audit=r.skipAudit,r.level||0===r.level){const t=e.ImMessageLevel.values[r.level];t&&(n.level=t)}return n})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImSendMessageToUserRspCallbackWrapper.implement({OnSuccess(t){e(t.message_id)},OnFailure(e){n(T.fromWASMError(e))}});this.wasmMessageManager.SendC2cMessage(t,r),r.delete()}))}async sendGroupMessage(e){const t=((e,t)=>{const n=new e.ImSendMessageToGroupReq,r={...O,...t};if(n.type=r.type,n.data=r.data,n.group_id=r.groupId,n.skip_mute_check=r.skipMuteCheck,n.skip_audit=r.skipAudit,r.level||0===r.level){const t=e.ImMessageLevel.values[r.level];t&&(n.level=t)}return r.noStorage&&(n.no_storage=r.noStorage),r.repeatCount&&r.repeatCount>0&&(n.repeat_count=r.repeatCount),n})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImSendMessageToGroupRspCallbackWrapper.implement({OnSuccess(t){e(t.message_id)},OnFailure(e){n(T.fromWASMError(e))}});this.wasmMessageManager.SendGroupMessage(t,r),r.delete()}))}async listMessage(e){const t=((e,t)=>{const n=new e.ImListMessageReq;m(t.nextpagetoken)&&!m(t.nextPageToken)&&(t.nextPageToken=t.nextpagetoken);const r={...g,...t};return n.group_id=r.groupId,n.type=r.type,m(r.nextPageToken)&&n.setNextPageToken(r.nextPageToken.toString()),(r.sortType||0===r.sortType)&&(n.sort_type=p(r.sortType,e.ImSortType)),n.page_size=r.pageSize,r.beginTime&&r.beginTime>0&&n.setBeginTime(r.beginTime.toString()),r.endTime&&r.endTime>0&&n.setEndTime(r.endTime.toString()),n})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImListMessageRspCallbackWrapper.implement({OnSuccess(t){e((e=>{const t=[];for(var n=0;n<e.message_list.size();n++)t.push(C(e.message_list.get(n)));const r=+e.getNextPageToken();return{groupId:e.group_id,nextPageToken:r,nextpagetoken:r,hasMore:e.has_more,messageList:t}})(t))},OnFailure(e){n(T.fromWASMError(e))}});this.wasmMessageManager.ListMessage(t,r),r.delete()}))}listRecentMessage(e){const t=((e,t)=>{let n="string"==typeof t?{groupId:t}:t;const r=new e.ImListRecentMessageReq,i={...v,...n};return r.group_id=i.groupId,r.seqnum=i.seqnum,r.page_size=i.pageSize,r})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImListRecentMessageRspCallbackWrapper.implement({OnSuccess(t){e((e=>{const t=[];for(var n=0;n<e.message_list.size();n++)t.push(C(e.message_list.get(n)));return{groupId:e.group_id,messageList:t}})(t))},OnFailure(e){n(T.fromWASMError(e))}});this.wasmMessageManager.ListRecentMessage(t,r),r.delete()}))}listHistoryMessage(e){const t=((e,t)=>{const n=new e.ImListHistoryMessageReq,r={...R,...t};return n.group_id=r.groupId,n.type=r.type,m(r.nextPageToken)&&n.setNextPageToken(r.nextPageToken.toString()),(r.sortType||0===r.sortType)&&(n.sort_type=p(r.sortType,e.ImSortType)),n.page_size=r.pageSize,(r.beginTime||0===r.beginTime)&&n.setBeginTime(r.beginTime.toString()),(r.endTime||0===r.endTime)&&n.setEndTime(r.endTime.toString()),n})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImListHistoryMessageRspCallbackWrapper.implement({OnSuccess(t){e((e=>{const t=[];for(var n=0;n<e.message_list.size();n++)t.push(C(e.message_list.get(n)));return{groupId:e.group_id,nextPageToken:+e.getNextPageToken(),hasMore:e.has_more,messageList:t}})(t))},OnFailure(e){n(T.fromWASMError(e))}});this.wasmMessageManager.ListHistoryMessage(t,r),r.delete()}))}deleteMessage(e){const t=(n=this.wasmIns,r=e,new n.ImDeleteMessageReq(r.groupId,r.messageId));var n,r;return new Promise(((e,n)=>{const r=this.wasmIns.ImSdkCallback.implement({OnSuccess(){e()},OnFailure(e){n(T.fromWASMError(e))}});this.wasmMessageManager.DeleteMessage(t,r),r.delete()}))}}const L={groupId:"",groupName:"",groupMeta:""},k={groupId:"",forceUpdateGroupMeta:!1,groupMeta:"",forceUpdateAdmins:!1,admins:[]},x={groupId:"",sortType:c.ASC,pageSize:30},F=e=>({groupId:e.group_id,muteAll:e.mute_all,muteUserList:l(e.mute_user_list),whiteUserList:l(e.white_user_list)}),D=e=>({pv:e.pv,onlineCount:e.online_count,msgAmount:f(e.msg_amount)}),$=e=>({groupId:e.group_id,groupName:e.group_name,groupMeta:e.group_meta,createTime:+e.getCreateTime(),creator:e.creator,admins:e.admins?l(e.admins):[],statistics:D(e.statistics),muteStatus:F(e.mute_status)});var N=Object.defineProperty,j=(e,t,n)=>(((e,t,n)=>{t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class W extends s{constructor(e,t){super(),j(this,"wasmIns"),j(this,"wasmGroupManager"),j(this,"groupListener"),this.wasmIns=e,this.wasmGroupManager=t.GetGroupManager()}addGroupListener(){this.groupListener=this.wasmIns.ImGroupListenerWrapper.implement({OnMemberChange:(e,t,n,r)=>{this.emit("memberchange",e,t,b(n),b(r))},OnExit:(e,t)=>{this.emit("exit",e,t)},OnMuteChange:(e,t)=>{this.emit("mutechange",e,F(t))},OnInfoChange:(e,t)=>{var n;this.emit("infochange",e,{groupId:(n=t).group_id,groupMeta:n.group_meta,adminList:n.admin_list?l(n.admin_list):[]})}}),this.wasmGroupManager.AddGroupListener(this.groupListener)}removeGroupListener(){this.groupListener&&(this.wasmGroupManager.RemoveGroupListener(this.groupListener),this.groupListener.delete(),this.groupListener=null)}async createGroup(e){const t=((e,t)=>{const n=new e.ImCreateGroupReq,r={...L,...t};return n.group_id=r.groupId,n.group_name=r.groupName,n.group_meta=r.groupMeta,n})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImCreateGroupRspCallbackWrapper.implement({OnSuccess(t){var n;e({groupId:(n=t).group_id,alreadyExist:n.already_exist})},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.CreateGroup(t,r),r.delete()}))}async queryGroup(e){const t="string"==typeof e?new this.wasmIns.ImQueryGroupReq(e):(n=this.wasmIns,r=e,new n.ImQueryGroupReq(r.groupId));var n,r;return new Promise(((e,n)=>{const r=this.wasmIns.ImQueryGroupRspCallbackWrapper.implement({OnSuccess(t){e($(t.group_info))},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.QueryGroup(t,r),r.delete()}))}async closeGroup(e){const t="string"==typeof e?new this.wasmIns.ImCloseGroupReq(e):(n=this.wasmIns,r=e,new n.ImCloseGroupReq(r.groupId));var n,r;return new Promise(((e,n)=>{const r=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(t){e(t)},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.CloseGroup(t,r),r.delete()}))}async joinGroup(e){const t="string"==typeof e?new this.wasmIns.ImJoinGroupReq(e):(n=this.wasmIns,r=e,new n.ImJoinGroupReq(r.groupId));var n,r;return new Promise(((e,n)=>{const r=this.wasmIns.ImJoinGroupRspCallbackWrapper.implement({OnSuccess(t){e($(t.group_info))},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.JoinGroup(t,r),r.delete()}))}async leaveGroup(e){const t="string"==typeof e?new this.wasmIns.ImLeaveGroupReq(e):(n=this.wasmIns,r=e,new n.ImLeaveGroupReq(r.groupId));var n,r;return new Promise(((e,n)=>{const r=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.LeaveGroup(t,r),r.delete()}))}async modifyGroup(e){const t=((e,t)=>{const n=new e.ImModifyGroupReq,r={...k,...t};n.group_id=r.groupId,n.force_update_group_meta=r.forceUpdateGroupMeta,n.group_meta=r.groupMeta,n.force_update_admins=r.forceUpdateAdmins;const i=new e.VectorString;return r.admins&&r.admins.forEach((e=>{i.push_back(e)})),n.admins=i,n})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.ModifyGroup(t,r),r.delete()}))}async listRecentGroupUser(e){var t,n,r="string"==typeof e?new this.wasmIns.ImListRecentGroupUserReq(e):(t=this.wasmIns,n=e,new t.ImListRecentGroupUserReq(n.groupId));return new Promise(((e,t)=>{const n=this.wasmIns.ImListRecentGroupUserRspCallbackWrapper.implement({OnSuccess(t){e((e=>{const t=[];for(var n=0;n<e.user_list.size();n++)t.push(_(e.user_list.get(n)));return{groupId:e.group_id,total:e.total,userList:t}})(t))},OnFailure(e){t(T.fromWASMError(e))}});this.wasmGroupManager.ListRecentGroupUser(r,n),n.delete()}))}async listGroupUser(e){const t=((e,t)=>{const n="string"==typeof t?{groupId:t}:t,r=new e.ImListGroupUserReq;m(n.nextpagetoken)&&!m(n.nextPageToken)&&(n.nextPageToken=n.nextpagetoken);const i={...x,...n};return r.group_id=i.groupId,m(i.nextPageToken)&&r.setNextPageToken(i.nextPageToken.toString()),(i.sortType||0===i.sortType)&&(r.sorttype=p(i.sortType,e.ImSortType)),r.page_size=i.pageSize,r})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImListGroupUserRspCallbackWrapper.implement({OnSuccess(t){e((e=>{const t=[];for(var n=0;n<e.user_list.size();n++)t.push(_(e.user_list.get(n)));const r=+e.getNextPageToken();return{groupId:e.group_id,nextPageToken:r,nextpagetoken:r,hasMore:e.has_more,userList:t}})(t))},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.ListGroupUser(t,r),r.delete()}))}async muteAll(e){const t="string"==typeof e?new this.wasmIns.ImMuteAllReq(e):(n=this.wasmIns,r=e,new n.ImMuteAllReq(r.groupId));var n,r;return new Promise(((e,n)=>{const r=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.MuteAll(t,r),r.delete()}))}async cancelMuteAll(e){const t="string"==typeof e?new this.wasmIns.ImCancelMuteAllReq(e):(n=this.wasmIns,r=e,new n.ImCancelMuteAllReq(r.groupId));var n,r;return new Promise(((e,n)=>{const r=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.CancelMuteAll(t,r),r.delete()}))}async muteUser(e){const t=((e,t)=>{const n=new e.VectorString;return t.userList.forEach((e=>{n.push_back(e)})),new e.ImMuteUserReq(t.groupId,n)})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.MuteUser(t,r),r.delete()}))}async cancelMuteUser(e){const t=((e,t)=>{const n=new e.VectorString;return t.userList.forEach((e=>{n.push_back(e)})),new e.ImCancelMuteUserReq(t.groupId,n)})(this.wasmIns,e);return new Promise(((e,n)=>{const r=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.CancelMuteUser(t,r),r.delete()}))}async listMuteUsers(e){const t="string"==typeof e?new this.wasmIns.ImListMuteUsersReq(e):(n=this.wasmIns,r=e,new n.ImListMuteUsersReq(r.groupId));var n,r;return new Promise(((e,n)=>{const r=this.wasmIns.ImListMuteUsersRspCallbackWrapper.implement({OnSuccess(t){var n;e({groupId:(n=t).group_id,muteAll:n.mute_all,muteUserList:l(n.mute_user_list),whiteUserList:l(n.white_user_list)})},OnFailure(e){n(T.fromWASMError(e))}});this.wasmGroupManager.ListMuteUsers(t,r),r.delete()}))}}var G=(e=>(e[e.NONE=0]="NONE",e[e.DBUG=1]="DBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e))(G||{});const U={appId:"",appSign:"",logLevel:G.INFO,extra:{}},q={nonce:"",timestamp:0,role:"",token:""},z=(e,t)=>{const n={...q,...t},r=new e.ImAuth;return r.nonce=n.nonce,r.setTimestamp(n.timestamp.toString()),r.role=n.role,r.token=n.token,r},H=(e,t)=>{const n=((e,t)=>{for(const[n,r]of Object.entries(t)){const t=d(e,n),i=h(n,t,r);if(i)return i}return""})(t,{"user.userId":{required:!0,type:"string"},"userAuth.nonce":{required:!0,type:"string"},"userAuth.timestamp":{required:!0,type:"number"},"userAuth.token":{required:!0,type:"string"}});if(n)throw new T(n);const r=new e.ImLoginReq;return t.user&&(r.user=((e,t)=>{const n={...w,...t},r=new e.ImUser;return r.user_id=n.userId,r.user_extension=n.userExtension,r})(e,t.user)),t.userAuth&&(r.user_auth=z(e,t.userAuth)),r},Y=(e,t,n)=>{const r=n.value;return{get(){return(...e)=>{if(this.wasmEngine&&this.wasmInterface)return r.apply(this,e);throw new T("engine not inited")}}}};let V=G.INFO;const B=(e=G.INFO,...t)=>{const n=new Date;e>=V&&console.log(`[${n.getFullYear()}-${n.getMonth()}-${n.getDate()} ${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}.${n.getMilliseconds()}]`,...t)};var X=e=>{V=e},K=(...e)=>{B(G.DBUG,...e)},J=(...e)=>{B(G.ERROR,...e)};class Q extends s{}var Z=Object.defineProperty,ee=(e,t,n)=>(((e,t,n)=>{t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const te=["login","reconnect"];class ne extends Q{constructor(){super(),ee(this,"socketTask"),ee(this,"mainChannelId"),ee(this,"url"),ee(this,"authData"),wx.onNetworkStatusChange((e=>{const{isConnected:t}=e;t||this.emit("disconnected")}))}async subscribe({channelId:e,url:t,label:n,isMain:r}){K("wx websocket subscribe",e,t,n),this.url||(this.url=t.replace("wss:///","wss://rcoims.rtn.aliyuncs.com/")),r&&this.authData&&await this.connect(this.authData)}async unSubscribe(e){if(e===this.mainChannelId)try{this.socketTask?.close()}catch(e){}}onReceiveMessage(e){K("wx websocket received: ",this.mainChannelId,e),this.emit("message",this.mainChannelId||1,e)}async connect(e){const{appid:t,userid:n,auth:r}=e,{nonce:i,role:o,timestamp:a,token:s}=r;if(!this.url||0!==this.url.indexOf("wss://"))throw new T("websocket url error");const u=`${this.url}${this.url.indexOf("?")>=0?"&":"?"}appid=${t}&userid=${n}&role=${o}&timestamp=${a}&nonce=${i}&token=${s}`,c=wx.connectSocket({url:u}),l=Date.now();await new Promise(((e,t)=>{c.onError((async e=>{const n=Date.now()-l;n<500&&await new Promise((e=>{setTimeout((()=>{e(n)}),500-n)})),t(new T(e.errMsg))})),c.onOpen((()=>{e(c)}))})),c.onMessage((e=>{this.onReceiveMessage(e.data)})),this.socketTask=c}async send(e,t){const n=JSON.parse(t),{action:r,data:i}=n;if(te.includes(r)&&(this.mainChannelId=e),"login"===r){this.authData=i;try{await this.connect(i)}catch(e){const{tid:t}=n;this.onReceiveMessage(JSON.stringify({tid:t,action:`${r}-response`,code:1e3,timestamp:Math.floor(Date.now()/1e3),error:{subcode:0,msg:e.errMsg}}))}}K("wx websocket send",t),this.socketTask?.send({data:t})}destroy(){this.authData=void 0;try{this.socketTask?.close()}catch(e){}this.socketTask=void 0,this.mainChannelId=void 0}}var re=(e=>(e[e.BACKGROUND=0]="BACKGROUND",e[e.FOREGROUND=1]="FOREGROUND",e[e.NETWORK_DISCONNECTED=2]="NETWORK_DISCONNECTED",e[e.NETWORK_CONNECTED=3]="NETWORK_CONNECTED",e))(re||{}),ie=Object.defineProperty,oe=(e,t,n)=>(((e,t,n)=>{t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,t+"",n),n);class ae{constructor(){oe(this,"wasmInterface")}}var se=Object.defineProperty,ue=(e,t,n)=>(((e,t,n)=>{t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class ce extends ae{constructor(){super(...arguments),ue(this,"onAppShow",(()=>{this.wasmInterface?.NotifyAppEvent(re.FOREGROUND)})),ue(this,"onAppHide",(()=>{this.wasmInterface?.NotifyAppEvent(re.BACKGROUND)})),ue(this,"onNetworkStatusChange",(e=>{e.isConnected?this.wasmInterface?.NotifyAppEvent(re.NETWORK_CONNECTED):this.wasmInterface?.NotifyAppEvent(re.NETWORK_DISCONNECTED)}))}init(e){this.wasmInterface=e,wx&&(wx.onAppShow(this.onAppShow),wx.onAppHide(this.onAppHide),wx.onNetworkStatusChange(this.onNetworkStatusChange))}destory(){wx&&(wx.offAppShow(this.onAppShow),wx.offAppHide(this.onAppHide),wx.offNetworkStatusChange(this.onNetworkStatusChange))}}var le=Object.defineProperty,fe=Object.getOwnPropertyDescriptor,pe=(e,t,n,r)=>{for(var i,o=fe(t,n),a=e.length-1;a>=0;a--)(i=e[a])&&(o=i(t,n,o)||o);return o&&le(t,n,o),o},me=(e,t,n)=>(((e,t,n)=>{t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const de=class e extends s{constructor(){super(),me(this,"wasmIns"),me(this,"wasmEngine"),me(this,"wasmInterface"),me(this,"transport"),me(this,"appEventManager"),me(this,"eventListener"),me(this,"messageManager"),me(this,"groupManager"),me(this,"supportsWebRtc"),me(this,"supportWASM"),this.supportsWebRtc=!0,this.supportWASM=!0}static createEngine(){return e.engine||(e.engine=new e),e.engine}static isSupport(){return!0}static getSdkVersion(){return"1.3.1"}initTransport(){let e;e=new ne,e.on("disconnected",(()=>{this.wasmIns?.wasmOnConnectionLostEvent(-15)})),e.on("message",((e,t)=>{K("engine received",e,t),this.wasmIns?.wasmOnReceiveData(e,t)})),this.transport=e}initAppEvent(e){this.appEventManager=new ce,this.appEventManager.init(e)}async init(e){(e.logLevel||e.logLevel===G.NONE)&&X(e.logLevel),this.initTransport();try{if(!this.wasmIns){let t,n,r=u;t=e.locateFile;const i=await r({wasmBinary:n,locateFile:t,subscribe:async(e,t)=>{let n;try{n=JSON.parse(e)}catch(e){}if(!n)throw new Error("subscribeInfo should be json string");K("subscribe",n,t);const{url:r,stream_id:i,data_channel_streams:o=[],is_main:a}=n,s=o?.[0]?.track_label||i,u=+i;if(!u)throw new Error("channelId should be number");let c=0;const l=Date.now();try{await(this.transport?.subscribe({channelId:u,url:r,label:s,isMain:a}))}catch(e){J(e),c=-1}const f=Date.now()-l;0!==c&&f<500&&await new Promise((e=>setTimeout(e,500-f))),K("connectResult",c),this.wasmIns.wasmOnConnectResult(u,c)},unSubscribe:(e,t)=>{K("unSubscribe",e,t);const n=+e;this.transport?.unSubscribe(n)},sendData:async(e,t,n,r,i)=>{K("engine sendData",e,i),await(this.transport?.send(e,i))}});this.wasmIns=i,await this.wasmIns.ready,this.wasmEngine=new this.wasmIns.ImEngine.CreateEngine}await this.wasmIns.ready;const t=((e,t)=>{const n={...U,...t},r=new e.ImSdkConfig;if(n.deviceId&&(r.device_id=n.deviceId),r.app_id=n.appId,r.app_sign=n.appSign,(n.logLevel||0===n.logLevel)&&(r.log_level=p(n.logLevel,e.ImLogLevel)),n.source&&(r.source=n.source),n.heartbeatTimeout&&n.heartbeatTimeout>=15&&n.heartbeatTimeout<=120&&(r.heartbeat_timeout=n.heartbeatTimeout),n.extra&&Object.keys(n.extra).length>0){const t=new e.StringStringMap;Object.entries(n.extra).forEach((([e,n])=>{t.set(e,n)})),r.extra=t}return r})(this.wasmIns,e);t.protocol=2;const n=this.wasmEngine.Init(t);if(this.wasmInterface=this.wasmEngine.GetInterface(),this.initAppEvent(this.wasmInterface),0!==n)throw new T("init failed, please uninit first",n);this.messageManager=new P(this.wasmIns,this.wasmInterface),this.groupManager=new W(this.wasmIns,this.wasmInterface),this.addEventListener()}catch(e){throw J(e),new T(e.message,e.code)}}addEventListener(){this.eventListener=this.wasmIns.ImSdkListenerWrapper.implement({OnConnecting:()=>{this.emit("connecting")},OnConnectSuccess:()=>{this.emit("connectsuccess")},OnConnectFailed:e=>{this.emit("connectfailed",e)},OnDisconnect:e=>{this.messageManager?.removeMessageListener(),this.groupManager?.removeGroupListener(),this.emit("disconnect",e)},OnTokenExpired:e=>{const t=this.wasmIns.ImTokenCallback.CopyPtr(e);this.emit("tokenexpired",((e,n)=>{if(e)return t.OnError({code:e.code||0,msg:e.msg}),void t.delete();if(!n)throw new Error("auth not found");const r=this.wasmIns.ImTokenWrapper.implement({GetAccessToken:()=>z(this.wasmIns,n)});t.OnSuccess(r),t.delete()}))},OnReconnectSuccess:e=>{this.emit("reconnectsuccess",(e=>{const t=[];for(var n=0;n<e.size();n++)t.push($(e.get(n)));return t})(e))}}),this.wasmInterface.AddSdkListener(this.eventListener)}removeEventListener(){this.eventListener&&(this.wasmInterface.RemoveSdkListener(this.eventListener),this.eventListener.delete(),this.eventListener=null)}destroy(){this.removeEventListener(),this.groupManager?.removeGroupListener(),this.groupManager=void 0,this.messageManager?.removeMessageListener(),this.messageManager=void 0,this.wasmInterface?.delete(),this.wasmInterface=void 0,this.transport?.destroy(),this.appEventManager?.destory()}unInit(){return this.destroy(),0===this.wasmEngine.UnInit()}async login(e){const t=H(this.wasmIns,e),n=this;return new Promise(((e,r)=>{const i=this.wasmIns.ImSdkCallback.implement({OnSuccess(){n.messageManager?.addMessageListener(),n.groupManager?.addGroupListener(),e()},OnFailure(e){r(T.fromWASMError(e))}});this.wasmInterface.Login(t,i),i.delete()}))}async logout(){return new Promise(((e,t)=>{const n=this.wasmIns.ImSdkCallback.implement({OnSuccess(){this.transport?.destroy(),e()},OnFailure(e){t(T.fromWASMError(e))}});this.wasmInterface.Logout(n),n.delete()}))}reconnect(){this.wasmIns?.wasmOnConnectionLostEvent(-15)}getCurrentUserId(){return this.wasmInterface.GetCurrentUserId()}isLogin(){if(!this.wasmEngine||!this.wasmInterface)return!1;return!!this.wasmInterface.IsLogin()}getMessageManager(){return this.messageManager}getGroupManager(){return this.groupManager}};let he;me(de,"engine"),pe([Y],de.prototype,"unInit"),pe([Y],de.prototype,"login"),pe([Y],de.prototype,"logout"),pe([Y],de.prototype,"reconnect"),pe([Y],de.prototype,"getCurrentUserId"),pe([Y],de.prototype,"getMessageManager"),pe([Y],de.prototype,"getGroupManager"),he=de;var ge=he,ve=(e=>(e[e.ERROR_HAS_LOGIN=304]="ERROR_HAS_LOGIN",e[e.ERROR_INVALID_PARAM=400]="ERROR_INVALID_PARAM",e[e.ERROR_NO_PERMISSION=403]="ERROR_NO_PERMISSION",e[e.ERROR_NO_SESSION=404]="ERROR_NO_SESSION",e[e.ERROR_GROUP_NOT_EXIST=440]="ERROR_GROUP_NOT_EXIST",e[e.ERROR_GROUP_DELETED=441]="ERROR_GROUP_DELETED",e[e.ERROR_SEDN_GROUP_MSG_FAIL=442]="ERROR_SEDN_GROUP_MSG_FAIL",e[e.ERROR_JOIN_GROUP_FAIL=450]="ERROR_JOIN_GROUP_FAIL",e[e.ERROR_GROUP_NOT_JOINED=425]="ERROR_GROUP_NOT_JOINED",e[e.ERROR_INTERNAL_BUSY=412]="ERROR_INTERNAL_BUSY",e[e.ERROR_INTERNALE_RROR=500]="ERROR_INTERNALE_RROR",e[e.ERROR_REACH_MAX=443]="ERROR_REACH_MAX",e[e.ERROR_INVALID_STATE=601]="ERROR_INVALID_STATE",e[e.ERROR_NOT_LOGIN=602]="ERROR_NOT_LOGIN",e[e.ERROR_RECEIVE_LAST_SESSION=603]="ERROR_RECEIVE_LAST_SESSION",e[e.ERROR_PARSE_DATA_ERROR=604]="ERROR_PARSE_DATA_ERROR",e))(ve||{});export{W as AliVCIMGroupManager,P as AliVCIMMessageManager,ge as ImEngine,ve as ImErrors,G as ImLogLevel,y as ImMessageLevel,c as ImSortType};
