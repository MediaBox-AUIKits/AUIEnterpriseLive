function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};t.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},t.prototype.init_by_array=function(e,t){var r,n,o;for(this.init_seed(19650218),r=1,n=0,o=this.N>t?this.N:t;o;o--){var a=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(1664525*((4294901760&a)>>>16)<<16)+1664525*(65535&a))+e[n]+n,this.mt[r]>>>=0,n++,++r>=this.N&&(this.mt[0]=this.mt[this.N-1],r=1),n>=t&&(n=0)}for(o=this.N-1;o;o--){a=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(1566083941*((4294901760&a)>>>16)<<16)+1566083941*(65535&a))-r,this.mt[r]>>>=0,++r>=this.N&&(this.mt[0]=this.mt[this.N-1],r=1)}this.mt[0]=2147483648},t.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var r;for(this.mti==this.N+1&&this.init_seed(5489),r=0;r<this.N-this.M;r++)e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+this.M]^e>>>1^t[1&e];for(;r<this.N-1;r++)e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},t.prototype.random_int31=function(){return this.random_int()>>>1},t.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},t.prototype.random=function(){return this.random_int()*(1/4294967296)},t.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},t.prototype.random_long=function(){return(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))*(1/9007199254740992)};var r=new t(Math.random()*Number.MAX_SAFE_INTEGER);var n=e((function(e){var t=e.length;for(;t--;)e[t]=Math.floor(256*r.random());return e}));const o=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;if("undefined"!=typeof self)return self;throw new Error("unable to locate global object")})();void 0===o.globalThis&&Object.defineProperty(o,"globalThis",{get:()=>o}),"undefined"==typeof window&&(window=globalThis),globalThis.isWxWebAssembly=!0,globalThis.WebAssembly=WXWebAssembly,"object"!=typeof crypto&&(globalThis.crypto={getRandomValues:n});var a={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,n,a,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var i=new o(n,a||e,s),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],i]:e._events[u].push(i):(e._events[u]=i,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function i(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),i.prototype.eventNames=function(){var e,n,o=[];if(0===this._eventsCount)return o;for(n in e=this._events)t.call(e,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},i.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,a=n.length,s=new Array(a);o<a;o++)s[o]=n[o].fn;return s},i.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},i.prototype.emit=function(e,t,n,o,a,s){var i=r?r+e:e;if(!this._events[i])return!1;var u,l,c=this._events[i],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,o),!0;case 5:return c.fn.call(c.context,t,n,o,a),!0;case 6:return c.fn.call(c.context,t,n,o,a,s),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var h,p=c.length;for(l=0;l<p;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;case 4:c[l].fn.call(c[l].context,t,n,o);break;default:if(!u)for(h=1,u=new Array(d-1);h<d;h++)u[h-1]=arguments[h];c[l].fn.apply(c[l].context,u)}}return!0},i.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},i.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},i.prototype.removeListener=function(e,t,n,o){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var i=this._events[a];if(i.fn)i.fn!==t||o&&!i.once||n&&i.context!==n||s(this,a);else{for(var u=0,l=[],c=i.length;u<c;u++)(i[u].fn!==t||o&&!i[u].once||n&&i[u].context!==n)&&l.push(i[u]);l.length?this._events[a]=1===l.length?l[0]:l:s(this,a)}return this},i.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=r,i.EventEmitter=i,e.exports=i}(a);var s,i=e(a.exports),u=(s="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e={}){var t,r,n=e;n.ready=new Promise(((e,n)=>{t=e,r=n}));var o,a,i=Object.assign({},n),u="./this.program",l=(e,t)=>{throw t},c="";"undefined"!=typeof document&&document.currentScript&&(c=document.currentScript.src),s&&(c=s),c=0!==c.indexOf("blob:")?c.substr(0,c.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},a=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)};var d,h,p=n.print||console.log.bind(console),m=n.printErr||console.error.bind(console);Object.assign(n,i),i=null,n.arguments&&n.arguments,n.thisProgram&&(u=n.thisProgram),n.quit&&(l=n.quit),n.wasmBinary&&(d=n.wasmBinary),"object"!=typeof WebAssembly&&F("no native wasm support detected");var f,g,v,y,w,_,E,b,S,k=!1;function O(e,t){e||F(t)}function M(){var e=h.buffer;n.HEAP8=g=new Int8Array(e),n.HEAP16=y=new Int16Array(e),n.HEAPU8=v=new Uint8Array(e),n.HEAPU16=w=new Uint16Array(e),n.HEAP32=_=new Int32Array(e),n.HEAPU32=E=new Uint32Array(e),n.HEAPF32=b=new Float32Array(e),n.HEAPF64=S=new Float64Array(e)}var C=[],R=[],I=[],T=[],A=0,P=null;function D(e){A++,n.monitorRunDependencies&&n.monitorRunDependencies(A)}function $(e){if(A--,n.monitorRunDependencies&&n.monitorRunDependencies(A),0==A&&P){var t=P;P=null,t()}}function F(e){n.onAbort&&n.onAbort(e),m(e="Aborted("+e+")"),k=!0,f=1,e+=". Build with -sASSERTIONS for more info.";var t="run time error";throw r(t),t}var x,L,N,j,W=e=>e.startsWith("data:application/octet-stream;base64,");function U(e,t,r){return function(e){return new Promise(((t,r)=>{globalThis.isWxWebAssembly?t(e):wx.getFileSystemManager().readFile({filePath:e,position:0,success:e=>{t(e.data)},fail(e){r(e)}})}))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{m(`failed to asynchronously prepare wasm: ${e}`),F(e)}))}function G(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}W(x="AliVCIM.wasm")||(L=x,x=n.locateFile?n.locateFile(L,c):c+L);var z=e=>{for(;e.length>0;)e.shift()(n)},B=n.noExitRuntime||!0,H=[],q=0,V=0;function Y(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(e){E[this.ptr+4>>2]=e},this.get_type=function(){return E[this.ptr+4>>2]},this.set_destructor=function(e){E[this.ptr+8>>2]=e},this.get_destructor=function(){return E[this.ptr+8>>2]},this.set_caught=function(e){e=e?1:0,g[this.ptr+12>>0]=e},this.get_caught=function(){return 0!=g[this.ptr+12>>0]},this.set_rethrown=function(e){e=e?1:0,g[this.ptr+13>>0]=e},this.get_rethrown=function(){return 0!=g[this.ptr+13>>0]},this.init=function(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t)},this.set_adjusted_ptr=function(e){E[this.ptr+16>>2]=e},this.get_adjusted_ptr=function(){return E[this.ptr+16>>2]},this.get_exception_ptr=function(){if($r(this.get_type()))return E[this.excPtr>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}var X=e=>{var t=V;if(!t)return Cr(0),0;var r=new Y(t);r.set_adjusted_ptr(t);var n=r.get_type();if(!n)return Cr(0),t;for(var o in e){var a=e[o];if(0===a||a===n)break;var s=r.ptr+16;if(Dr(a,n,s))return Cr(a),t}return Cr(n),t},J={isAbs:e=>"/"===e.charAt(0),splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:e=>{var t=J.isAbs(e),r="/"===e.substr(-1);return(e=J.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=J.splitPath(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},basename:e=>{if("/"===e)return"/";var t=(e=(e=J.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},join:function(){var e=Array.prototype.slice.call(arguments);return J.normalize(e.join("/"))},join2:(e,t)=>J.normalize(e+"/"+t)},K=e=>(K=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);F("initRandomDevice")})())(e),Q={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:de.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t=J.isAbs(n)}return(t?"/":"")+(e=J.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||"."},relative:(e,t)=>{function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=Q.resolve(e).substr(1),t=Q.resolve(t).substr(1);for(var n=r(e.split("/")),o=r(t.split("/")),a=Math.min(n.length,o.length),s=a,i=0;i<a;i++)if(n[i]!==o[i]){s=i;break}var u=[];for(i=s;i<n.length;i++)u.push("..");return(u=u.concat(o.slice(s))).join("/")}},Z="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,ee=(e,t,r)=>{for(var n=t+r,o=t;e[o]&&!(o>=n);)++o;if(o-t>16&&e.buffer&&Z)return Z.decode(e.subarray(t,o));for(var a="";t<o;){var s=e[t++];if(128&s){var i=63&e[t++];if(192!=(224&s)){var u=63&e[t++];if((s=224==(240&s)?(15&s)<<12|i<<6|u:(7&s)<<18|i<<12|u<<6|63&e[t++])<65536)a+=String.fromCharCode(s);else{var l=s-65536;a+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else a+=String.fromCharCode((31&s)<<6|i)}else a+=String.fromCharCode(s)}return a},te=[],re=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++r):t+=3}return t},ne=(e,t,r,n)=>{if(!(n>0))return 0;for(var o=r,a=r+n-1,s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++s)),i<=127){if(r>=a)break;t[r++]=i}else if(i<=2047){if(r+1>=a)break;t[r++]=192|i>>6,t[r++]=128|63&i}else if(i<=65535){if(r+2>=a)break;t[r++]=224|i>>12,t[r++]=128|i>>6&63,t[r++]=128|63&i}else{if(r+3>=a)break;t[r++]=240|i>>18,t[r++]=128|i>>12&63,t[r++]=128|i>>6&63,t[r++]=128|63&i}}return t[r]=0,r-o};function oe(e,t,r){var n=r>0?r:re(e)+1,o=new Array(n),a=ne(e,o,0,o.length);return t&&(o.length=a),o}var ae={ttys:[],init(){},shutdown(){},register(e,t){ae.ttys[e]={input:[],output:[],ops:t},de.registerDevice(e,ae.stream_ops)},stream_ops:{open(e){var t=ae.ttys[e.node.rdev];if(!t)throw new de.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,r,n,o){if(!e.tty||!e.tty.ops.get_char)throw new de.ErrnoError(60);for(var a=0,s=0;s<n;s++){var i;try{i=e.tty.ops.get_char(e.tty)}catch(e){throw new de.ErrnoError(29)}if(void 0===i&&0===a)throw new de.ErrnoError(6);if(null==i)break;a++,t[r+s]=i}return a&&(e.node.timestamp=Date.now()),a},write(e,t,r,n,o){if(!e.tty||!e.tty.ops.put_char)throw new de.ErrnoError(60);try{for(var a=0;a<n;a++)e.tty.ops.put_char(e.tty,t[r+a])}catch(e){throw new de.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),a}},default_tty_ops:{get_char:e=>(()=>{if(!te.length){var e=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(e=window.prompt("Input: "))&&(e+="\n"):"function"==typeof readline&&null!==(e=readline())&&(e+="\n"),!e)return null;te=oe(e,!0)}return te.shift()})(),put_char(e,t){null===t||10===t?(p(ee(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(p(ee(e.output,0)),e.output=[])},ioctl_tcgets:e=>({c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}),ioctl_tcsets:(e,t,r)=>0,ioctl_tiocgwinsz:e=>[24,80]},default_tty1_ops:{put_char(e,t){null===t||10===t?(m(ee(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(m(ee(e.output,0)),e.output=[])}}},se=e=>{e=((e,t)=>Math.ceil(e/t)*t)(e,65536);var t=Or(65536,e);return t?((e,t)=>(v.fill(0,e,e+t),e))(t,e):0},ie={ops_table:null,mount:e=>ie.createNode(null,"/",16895,0),createNode(e,t,r,n){if(de.isBlkdev(r)||de.isFIFO(r))throw new de.ErrnoError(63);ie.ops_table||(ie.ops_table={dir:{node:{getattr:ie.node_ops.getattr,setattr:ie.node_ops.setattr,lookup:ie.node_ops.lookup,mknod:ie.node_ops.mknod,rename:ie.node_ops.rename,unlink:ie.node_ops.unlink,rmdir:ie.node_ops.rmdir,readdir:ie.node_ops.readdir,symlink:ie.node_ops.symlink},stream:{llseek:ie.stream_ops.llseek}},file:{node:{getattr:ie.node_ops.getattr,setattr:ie.node_ops.setattr},stream:{llseek:ie.stream_ops.llseek,read:ie.stream_ops.read,write:ie.stream_ops.write,allocate:ie.stream_ops.allocate,mmap:ie.stream_ops.mmap,msync:ie.stream_ops.msync}},link:{node:{getattr:ie.node_ops.getattr,setattr:ie.node_ops.setattr,readlink:ie.node_ops.readlink},stream:{}},chrdev:{node:{getattr:ie.node_ops.getattr,setattr:ie.node_ops.setattr},stream:de.chrdev_stream_ops}});var o=de.createNode(e,t,r,n);return de.isDir(o.mode)?(o.node_ops=ie.ops_table.dir.node,o.stream_ops=ie.ops_table.dir.stream,o.contents={}):de.isFile(o.mode)?(o.node_ops=ie.ops_table.file.node,o.stream_ops=ie.ops_table.file.stream,o.usedBytes=0,o.contents=null):de.isLink(o.mode)?(o.node_ops=ie.ops_table.link.node,o.stream_ops=ie.ops_table.link.stream):de.isChrdev(o.mode)&&(o.node_ops=ie.ops_table.chrdev.node,o.stream_ops=ie.ops_table.chrdev.stream),o.timestamp=Date.now(),e&&(e.contents[t]=o,e.timestamp=o.timestamp),o},getFileDataAsTypedArray:e=>e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0),expandFileStorage(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){t=Math.max(t,r*(r<1048576?2:1.125)>>>0),0!=r&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var r=e.contents;e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=de.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,de.isDir(e.mode)?t.size=4096:de.isFile(e.mode)?t.size=e.usedBytes:de.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&ie.resizeFileStorage(e,t.size)},lookup(e,t){throw de.genericErrors[44]},mknod:(e,t,r,n)=>ie.createNode(e,t,r,n),rename(e,t,r){if(de.isDir(e.mode)){var n;try{n=de.lookupNode(t,r)}catch(e){}if(n)for(var o in n.contents)throw new de.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=r,t.contents[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir(e,t){var r=de.lookupNode(e,t);for(var n in r.contents)throw new de.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink(e,t,r){var n=ie.createNode(e,t,41471,0);return n.link=r,n},readlink(e){if(!de.isLink(e.mode))throw new de.ErrnoError(28);return e.link}},stream_ops:{read(e,t,r,n,o){var a=e.node.contents;if(o>=e.node.usedBytes)return 0;var s=Math.min(e.node.usedBytes-o,n);if(s>8&&a.subarray)t.set(a.subarray(o,o+s),r);else for(var i=0;i<s;i++)t[r+i]=a[o+i];return s},write(e,t,r,n,o,a){if(t.buffer===g.buffer&&(a=!1),!n)return 0;var s=e.node;if(s.timestamp=Date.now(),t.subarray&&(!s.contents||s.contents.subarray)){if(a)return s.contents=t.subarray(r,r+n),s.usedBytes=n,n;if(0===s.usedBytes&&0===o)return s.contents=t.slice(r,r+n),s.usedBytes=n,n;if(o+n<=s.usedBytes)return s.contents.set(t.subarray(r,r+n),o),n}if(ie.expandFileStorage(s,o+n),s.contents.subarray&&t.subarray)s.contents.set(t.subarray(r,r+n),o);else for(var i=0;i<n;i++)s.contents[o+i]=t[r+i];return s.usedBytes=Math.max(s.usedBytes,o+n),n},llseek(e,t,r){var n=t;if(1===r?n+=e.position:2===r&&de.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new de.ErrnoError(28);return n},allocate(e,t,r){ie.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap(e,t,r,n,o){if(!de.isFile(e.node.mode))throw new de.ErrnoError(43);var a,s,i=e.node.contents;if(2&o||i.buffer!==g.buffer){if((r>0||r+t<i.length)&&(i=i.subarray?i.subarray(r,r+t):Array.prototype.slice.call(i,r,r+t)),s=!0,!(a=se(t)))throw new de.ErrnoError(48);g.set(i,a)}else s=!1,a=i.byteOffset;return{ptr:a,allocated:s}},msync:(e,t,r,n,o)=>(ie.stream_ops.write(e,t,0,n,r,!1),0)}},ue=n.preloadPlugins||[],le=(e,t)=>{var r=0;return e&&(r|=365),t&&(r|=146),r},ce={dbs:{},indexedDB:()=>{if("undefined"!=typeof indexedDB)return indexedDB;var e=null;return"object"==typeof window&&(e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),O(e,"IDBFS used, but indexedDB not supported"),e},DB_VERSION:21,DB_STORE_NAME:"FILE_DATA",mount:function(e){return ie.mount.apply(null,arguments)},syncfs:(e,t,r)=>{ce.getLocalSet(e,((n,o)=>{if(n)return r(n);ce.getRemoteSet(e,((e,n)=>{if(e)return r(e);var a=t?n:o,s=t?o:n;ce.reconcile(a,s,r)}))}))},quit:()=>{Object.values(ce.dbs).forEach((e=>e.close())),ce.dbs={}},getDB:(e,t)=>{var r,n=ce.dbs[e];if(n)return t(null,n);try{r=ce.indexedDB().open(e,ce.DB_VERSION)}catch(e){return t(e)}if(!r)return t("Unable to connect to IndexedDB");r.onupgradeneeded=e=>{var t,r=e.target.result,n=e.target.transaction;(t=r.objectStoreNames.contains(ce.DB_STORE_NAME)?n.objectStore(ce.DB_STORE_NAME):r.createObjectStore(ce.DB_STORE_NAME)).indexNames.contains("timestamp")||t.createIndex("timestamp","timestamp",{unique:!1})},r.onsuccess=()=>{n=r.result,ce.dbs[e]=n,t(null,n)},r.onerror=e=>{t(e.target.error),e.preventDefault()}},getLocalSet:(e,t)=>{var r={};function n(e){return"."!==e&&".."!==e}function o(e){return t=>J.join2(e,t)}for(var a=de.readdir(e.mountpoint).filter(n).map(o(e.mountpoint));a.length;){var s,i=a.pop();try{s=de.stat(i)}catch(e){return t(e)}de.isDir(s.mode)&&a.push.apply(a,de.readdir(i).filter(n).map(o(i))),r[i]={timestamp:s.mtime}}return t(null,{type:"local",entries:r})},getRemoteSet:(e,t)=>{var r={};ce.getDB(e.mountpoint,((e,n)=>{if(e)return t(e);try{var o=n.transaction([ce.DB_STORE_NAME],"readonly");o.onerror=e=>{t(e.target.error),e.preventDefault()},o.objectStore(ce.DB_STORE_NAME).index("timestamp").openKeyCursor().onsuccess=e=>{var o=e.target.result;if(!o)return t(null,{type:"remote",db:n,entries:r});r[o.primaryKey]={timestamp:o.key},o.continue()}}catch(e){return t(e)}}))},loadLocalEntry:(e,t)=>{var r,n;try{n=de.lookupPath(e).node,r=de.stat(e)}catch(e){return t(e)}return de.isDir(r.mode)?t(null,{timestamp:r.mtime,mode:r.mode}):de.isFile(r.mode)?(n.contents=ie.getFileDataAsTypedArray(n),t(null,{timestamp:r.mtime,mode:r.mode,contents:n.contents})):t(new Error("node type not supported"))},storeLocalEntry:(e,t,r)=>{try{if(de.isDir(t.mode))de.mkdirTree(e,t.mode);else{if(!de.isFile(t.mode))return r(new Error("node type not supported"));de.writeFile(e,t.contents,{canOwn:!0})}de.chmod(e,t.mode),de.utime(e,t.timestamp,t.timestamp)}catch(e){return r(e)}r(null)},removeLocalEntry:(e,t)=>{try{var r=de.stat(e);de.isDir(r.mode)?de.rmdir(e):de.isFile(r.mode)&&de.unlink(e)}catch(e){return t(e)}t(null)},loadRemoteEntry:(e,t,r)=>{var n=e.get(t);n.onsuccess=e=>{r(null,e.target.result)},n.onerror=e=>{r(e.target.error),e.preventDefault()}},storeRemoteEntry:(e,t,r,n)=>{try{var o=e.put(r,t)}catch(e){return void n(e)}o.onsuccess=()=>{n(null)},o.onerror=e=>{n(e.target.error),e.preventDefault()}},removeRemoteEntry:(e,t,r)=>{var n=e.delete(t);n.onsuccess=()=>{r(null)},n.onerror=e=>{r(e.target.error),e.preventDefault()}},reconcile:(e,t,r)=>{var n=0,o=[];Object.keys(e.entries).forEach((function(r){var a=e.entries[r],s=t.entries[r];s&&a.timestamp.getTime()==s.timestamp.getTime()||(o.push(r),n++)}));var a=[];if(Object.keys(t.entries).forEach((function(t){e.entries[t]||(a.push(t),n++)})),!n)return r(null);var s=!1,i=("remote"===e.type?e.db:t.db).transaction([ce.DB_STORE_NAME],"readwrite"),u=i.objectStore(ce.DB_STORE_NAME);function l(e){if(e&&!s)return s=!0,r(e)}i.onerror=e=>{l(this.error),e.preventDefault()},i.oncomplete=e=>{s||r(null)},o.sort().forEach((e=>{"local"===t.type?ce.loadRemoteEntry(u,e,((t,r)=>{if(t)return l(t);ce.storeLocalEntry(e,r,l)})):ce.loadLocalEntry(e,((t,r)=>{if(t)return l(t);ce.storeRemoteEntry(u,e,r,l)}))})),a.sort().reverse().forEach((e=>{"local"===t.type?ce.removeLocalEntry(e,l):ce.removeRemoteEntry(u,e,l)}))}},de={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath(e,t={}){if(!(e=Q.resolve(e)))return{path:"",node:null};if((t=Object.assign({follow_mount:!0,recurse_count:0},t)).recurse_count>8)throw new de.ErrnoError(32);for(var r=e.split("/").filter((e=>!!e)),n=de.root,o="/",a=0;a<r.length;a++){var s=a===r.length-1;if(s&&t.parent)break;if(n=de.lookupNode(n,r[a]),o=J.join2(o,r[a]),de.isMountpoint(n)&&(!s||s&&t.follow_mount)&&(n=n.mounted.root),!s||t.follow)for(var i=0;de.isLink(n.mode);){var u=de.readlink(o);if(o=Q.resolve(J.dirname(o),u),n=de.lookupPath(o,{recurse_count:t.recurse_count+1}).node,i++>40)throw new de.ErrnoError(32)}}return{path:o,node:n}},getPath(e){for(var t;;){if(de.isRoot(e)){var r=e.mount.mountpoint;return t?"/"!==r[r.length-1]?`${r}/${t}`:r+t:r}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%de.nameTable.length},hashAddNode(e){var t=de.hashName(e.parent.id,e.name);e.name_next=de.nameTable[t],de.nameTable[t]=e},hashRemoveNode(e){var t=de.hashName(e.parent.id,e.name);if(de.nameTable[t]===e)de.nameTable[t]=e.name_next;else for(var r=de.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode(e,t){var r=de.mayLookup(e);if(r)throw new de.ErrnoError(r,e);for(var n=de.hashName(e.id,t),o=de.nameTable[n];o;o=o.name_next){var a=o.name;if(o.parent.id===e.id&&a===t)return o}return de.lookup(e,t)},createNode(e,t,r,n){var o=new de.FSNode(e,t,r,n);return de.hashAddNode(o),o},destroyNode(e){de.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>32768==(61440&e),isDir:e=>16384==(61440&e),isLink:e=>40960==(61440&e),isChrdev:e=>8192==(61440&e),isBlkdev:e=>24576==(61440&e),isFIFO:e=>4096==(61440&e),isSocket:e=>49152==(49152&e),flagsToPermissionString(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:(e,t)=>de.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2,mayLookup(e){var t=de.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate(e,t){try{return de.lookupNode(e,t),20}catch(e){}return de.nodePermissions(e,"wx")},mayDelete(e,t,r){var n;try{n=de.lookupNode(e,t)}catch(e){return e.errno}var o=de.nodePermissions(e,"wx");if(o)return o;if(r){if(!de.isDir(n.mode))return 54;if(de.isRoot(n)||de.getPath(n)===de.cwd())return 10}else if(de.isDir(n.mode))return 31;return 0},mayOpen:(e,t)=>e?de.isLink(e.mode)?32:de.isDir(e.mode)&&("r"!==de.flagsToPermissionString(t)||512&t)?31:de.nodePermissions(e,de.flagsToPermissionString(t)):44,MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=de.MAX_OPEN_FDS;e++)if(!de.streams[e])return e;throw new de.ErrnoError(33)},getStreamChecked(e){var t=de.getStream(e);if(!t)throw new de.ErrnoError(8);return t},getStream:e=>de.streams[e],createStream:(e,t=-1)=>(de.FSStream||(de.FSStream=function(){this.shared={}},de.FSStream.prototype={},Object.defineProperties(de.FSStream.prototype,{object:{get(){return this.node},set(e){this.node=e}},isRead:{get(){return 1!=(2097155&this.flags)}},isWrite:{get(){return 0!=(2097155&this.flags)}},isAppend:{get(){return 1024&this.flags}},flags:{get(){return this.shared.flags},set(e){this.shared.flags=e}},position:{get(){return this.shared.position},set(e){this.shared.position=e}}})),e=Object.assign(new de.FSStream,e),-1==t&&(t=de.nextfd()),e.fd=t,de.streams[t]=e,e),closeStream(e){de.streams[e]=null},chrdev_stream_ops:{open(e){var t=de.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek(){throw new de.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice(e,t){de.devices[e]={stream_ops:t}},getDevice:e=>de.devices[e],getMounts(e){for(var t=[],r=[e];r.length;){var n=r.pop();t.push(n),r.push.apply(r,n.mounts)}return t},syncfs(e,t){"function"==typeof e&&(t=e,e=!1),de.syncFSRequests++,de.syncFSRequests>1&&m(`warning: ${de.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var r=de.getMounts(de.root.mount),n=0;function o(e){return de.syncFSRequests--,t(e)}function a(e){if(e)return a.errored?void 0:(a.errored=!0,o(e));++n>=r.length&&o(null)}r.forEach((t=>{if(!t.type.syncfs)return a(null);t.type.syncfs(t,e,a)}))},mount(e,t,r){var n,o="/"===r,a=!r;if(o&&de.root)throw new de.ErrnoError(10);if(!o&&!a){var s=de.lookupPath(r,{follow_mount:!1});if(r=s.path,n=s.node,de.isMountpoint(n))throw new de.ErrnoError(10);if(!de.isDir(n.mode))throw new de.ErrnoError(54)}var i={type:e,opts:t,mountpoint:r,mounts:[]},u=e.mount(i);return u.mount=i,i.root=u,o?de.root=u:n&&(n.mounted=i,n.mount&&n.mount.mounts.push(i)),u},unmount(e){var t=de.lookupPath(e,{follow_mount:!1});if(!de.isMountpoint(t.node))throw new de.ErrnoError(28);var r=t.node,n=r.mounted,o=de.getMounts(n);Object.keys(de.nameTable).forEach((e=>{for(var t=de.nameTable[e];t;){var r=t.name_next;o.includes(t.mount)&&de.destroyNode(t),t=r}})),r.mounted=null;var a=r.mount.mounts.indexOf(n);r.mount.mounts.splice(a,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod(e,t,r){var n=de.lookupPath(e,{parent:!0}).node,o=J.basename(e);if(!o||"."===o||".."===o)throw new de.ErrnoError(28);var a=de.mayCreate(n,o);if(a)throw new de.ErrnoError(a);if(!n.node_ops.mknod)throw new de.ErrnoError(63);return n.node_ops.mknod(n,o,t,r)},create:(e,t)=>(t=void 0!==t?t:438,t&=4095,t|=32768,de.mknod(e,t,0)),mkdir:(e,t)=>(t=void 0!==t?t:511,t&=1023,t|=16384,de.mknod(e,t,0)),mkdirTree(e,t){for(var r=e.split("/"),n="",o=0;o<r.length;++o)if(r[o]){n+="/"+r[o];try{de.mkdir(n,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:(e,t,r)=>(void 0===r&&(r=t,t=438),t|=8192,de.mknod(e,t,r)),symlink(e,t){if(!Q.resolve(e))throw new de.ErrnoError(44);var r=de.lookupPath(t,{parent:!0}).node;if(!r)throw new de.ErrnoError(44);var n=J.basename(t),o=de.mayCreate(r,n);if(o)throw new de.ErrnoError(o);if(!r.node_ops.symlink)throw new de.ErrnoError(63);return r.node_ops.symlink(r,n,e)},rename(e,t){var r,n,o=J.dirname(e),a=J.dirname(t),s=J.basename(e),i=J.basename(t);if(r=de.lookupPath(e,{parent:!0}).node,n=de.lookupPath(t,{parent:!0}).node,!r||!n)throw new de.ErrnoError(44);if(r.mount!==n.mount)throw new de.ErrnoError(75);var u,l=de.lookupNode(r,s),c=Q.relative(e,a);if("."!==c.charAt(0))throw new de.ErrnoError(28);if("."!==(c=Q.relative(t,o)).charAt(0))throw new de.ErrnoError(55);try{u=de.lookupNode(n,i)}catch(e){}if(l!==u){var d=de.isDir(l.mode),h=de.mayDelete(r,s,d);if(h)throw new de.ErrnoError(h);if(h=u?de.mayDelete(n,i,d):de.mayCreate(n,i))throw new de.ErrnoError(h);if(!r.node_ops.rename)throw new de.ErrnoError(63);if(de.isMountpoint(l)||u&&de.isMountpoint(u))throw new de.ErrnoError(10);if(n!==r&&(h=de.nodePermissions(r,"w")))throw new de.ErrnoError(h);de.hashRemoveNode(l);try{r.node_ops.rename(l,n,i)}catch(e){throw e}finally{de.hashAddNode(l)}}},rmdir(e){var t=de.lookupPath(e,{parent:!0}).node,r=J.basename(e),n=de.lookupNode(t,r),o=de.mayDelete(t,r,!0);if(o)throw new de.ErrnoError(o);if(!t.node_ops.rmdir)throw new de.ErrnoError(63);if(de.isMountpoint(n))throw new de.ErrnoError(10);t.node_ops.rmdir(t,r),de.destroyNode(n)},readdir(e){var t=de.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new de.ErrnoError(54);return t.node_ops.readdir(t)},unlink(e){var t=de.lookupPath(e,{parent:!0}).node;if(!t)throw new de.ErrnoError(44);var r=J.basename(e),n=de.lookupNode(t,r),o=de.mayDelete(t,r,!1);if(o)throw new de.ErrnoError(o);if(!t.node_ops.unlink)throw new de.ErrnoError(63);if(de.isMountpoint(n))throw new de.ErrnoError(10);t.node_ops.unlink(t,r),de.destroyNode(n)},readlink(e){var t=de.lookupPath(e).node;if(!t)throw new de.ErrnoError(44);if(!t.node_ops.readlink)throw new de.ErrnoError(28);return Q.resolve(de.getPath(t.parent),t.node_ops.readlink(t))},stat(e,t){var r=de.lookupPath(e,{follow:!t}).node;if(!r)throw new de.ErrnoError(44);if(!r.node_ops.getattr)throw new de.ErrnoError(63);return r.node_ops.getattr(r)},lstat:e=>de.stat(e,!0),chmod(e,t,r){var n;if(!(n="string"==typeof e?de.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new de.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod(e,t){de.chmod(e,t,!0)},fchmod(e,t){var r=de.getStreamChecked(e);de.chmod(r.node,t)},chown(e,t,r,n){var o;if(!(o="string"==typeof e?de.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new de.ErrnoError(63);o.node_ops.setattr(o,{timestamp:Date.now()})},lchown(e,t,r){de.chown(e,t,r,!0)},fchown(e,t,r){var n=de.getStreamChecked(e);de.chown(n.node,t,r)},truncate(e,t){if(t<0)throw new de.ErrnoError(28);var r;if(!(r="string"==typeof e?de.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new de.ErrnoError(63);if(de.isDir(r.mode))throw new de.ErrnoError(31);if(!de.isFile(r.mode))throw new de.ErrnoError(28);var n=de.nodePermissions(r,"w");if(n)throw new de.ErrnoError(n);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate(e,t){var r=de.getStreamChecked(e);if(0==(2097155&r.flags))throw new de.ErrnoError(28);de.truncate(r.node,t)},utime(e,t,r){var n=de.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,r)})},open(e,t,r){if(""===e)throw new de.ErrnoError(44);var o;if(r=void 0===r?438:r,r=64&(t="string"==typeof t?(e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(void 0===t)throw new Error(`Unknown file open mode: ${e}`);return t})(t):t)?4095&r|32768:0,"object"==typeof e)o=e;else{e=J.normalize(e);try{o=de.lookupPath(e,{follow:!(131072&t)}).node}catch(e){}}var a=!1;if(64&t)if(o){if(128&t)throw new de.ErrnoError(20)}else o=de.mknod(e,r,0),a=!0;if(!o)throw new de.ErrnoError(44);if(de.isChrdev(o.mode)&&(t&=-513),65536&t&&!de.isDir(o.mode))throw new de.ErrnoError(54);if(!a){var s=de.mayOpen(o,t);if(s)throw new de.ErrnoError(s)}512&t&&!a&&de.truncate(o,0),t&=-131713;var i=de.createStream({node:o,path:de.getPath(o),flags:t,seekable:!0,position:0,stream_ops:o.stream_ops,ungotten:[],error:!1});return i.stream_ops.open&&i.stream_ops.open(i),!n.logReadFiles||1&t||(de.readFiles||(de.readFiles={}),e in de.readFiles||(de.readFiles[e]=1)),i},close(e){if(de.isClosed(e))throw new de.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{de.closeStream(e.fd)}e.fd=null},isClosed:e=>null===e.fd,llseek(e,t,r){if(de.isClosed(e))throw new de.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new de.ErrnoError(70);if(0!=r&&1!=r&&2!=r)throw new de.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read(e,t,r,n,o){if(n<0||o<0)throw new de.ErrnoError(28);if(de.isClosed(e))throw new de.ErrnoError(8);if(1==(2097155&e.flags))throw new de.ErrnoError(8);if(de.isDir(e.node.mode))throw new de.ErrnoError(31);if(!e.stream_ops.read)throw new de.ErrnoError(28);var a=void 0!==o;if(a){if(!e.seekable)throw new de.ErrnoError(70)}else o=e.position;var s=e.stream_ops.read(e,t,r,n,o);return a||(e.position+=s),s},write(e,t,r,n,o,a){if(n<0||o<0)throw new de.ErrnoError(28);if(de.isClosed(e))throw new de.ErrnoError(8);if(0==(2097155&e.flags))throw new de.ErrnoError(8);if(de.isDir(e.node.mode))throw new de.ErrnoError(31);if(!e.stream_ops.write)throw new de.ErrnoError(28);e.seekable&&1024&e.flags&&de.llseek(e,0,2);var s=void 0!==o;if(s){if(!e.seekable)throw new de.ErrnoError(70)}else o=e.position;var i=e.stream_ops.write(e,t,r,n,o,a);return s||(e.position+=i),i},allocate(e,t,r){if(de.isClosed(e))throw new de.ErrnoError(8);if(t<0||r<=0)throw new de.ErrnoError(28);if(0==(2097155&e.flags))throw new de.ErrnoError(8);if(!de.isFile(e.node.mode)&&!de.isDir(e.node.mode))throw new de.ErrnoError(43);if(!e.stream_ops.allocate)throw new de.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap(e,t,r,n,o){if(0!=(2&n)&&0==(2&o)&&2!=(2097155&e.flags))throw new de.ErrnoError(2);if(1==(2097155&e.flags))throw new de.ErrnoError(2);if(!e.stream_ops.mmap)throw new de.ErrnoError(43);return e.stream_ops.mmap(e,t,r,n,o)},msync:(e,t,r,n,o)=>e.stream_ops.msync?e.stream_ops.msync(e,t,r,n,o):0,munmap:e=>0,ioctl(e,t,r){if(!e.stream_ops.ioctl)throw new de.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile(e,t={}){if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error(`Invalid encoding type "${t.encoding}"`);var r,n=de.open(e,t.flags),o=de.stat(e).size,a=new Uint8Array(o);return de.read(n,a,0,o,0),"utf8"===t.encoding?r=ee(a,0):"binary"===t.encoding&&(r=a),de.close(n),r},writeFile(e,t,r={}){r.flags=r.flags||577;var n=de.open(e,r.flags,r.mode);if("string"==typeof t){var o=new Uint8Array(re(t)+1),a=ne(t,o,0,o.length);de.write(n,o,0,a,void 0,r.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");de.write(n,t,0,t.byteLength,void 0,r.canOwn)}de.close(n)},cwd:()=>de.currentPath,chdir(e){var t=de.lookupPath(e,{follow:!0});if(null===t.node)throw new de.ErrnoError(44);if(!de.isDir(t.node.mode))throw new de.ErrnoError(54);var r=de.nodePermissions(t.node,"x");if(r)throw new de.ErrnoError(r);de.currentPath=t.path},createDefaultDirectories(){de.mkdir("/tmp"),de.mkdir("/home"),de.mkdir("/home/web_user")},createDefaultDevices(){de.mkdir("/dev"),de.registerDevice(de.makedev(1,3),{read:()=>0,write:(e,t,r,n,o)=>n}),de.mkdev("/dev/null",de.makedev(1,3)),ae.register(de.makedev(5,0),ae.default_tty_ops),ae.register(de.makedev(6,0),ae.default_tty1_ops),de.mkdev("/dev/tty",de.makedev(5,0)),de.mkdev("/dev/tty1",de.makedev(6,0));var e=new Uint8Array(1024),t=0,r=()=>(0===t&&(t=K(e).byteLength),e[--t]);de.createDevice("/dev","random",r),de.createDevice("/dev","urandom",r),de.mkdir("/dev/shm"),de.mkdir("/dev/shm/tmp")},createSpecialDirectories(){de.mkdir("/proc");var e=de.mkdir("/proc/self");de.mkdir("/proc/self/fd"),de.mount({mount(){var t=de.createNode(e,"fd",16895,73);return t.node_ops={lookup(e,t){var r=+t,n=de.getStreamChecked(r),o={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>n.path}};return o.parent=o,o}},t}},{},"/proc/self/fd")},createStandardStreams(){n.stdin?de.createDevice("/dev","stdin",n.stdin):de.symlink("/dev/tty","/dev/stdin"),n.stdout?de.createDevice("/dev","stdout",null,n.stdout):de.symlink("/dev/tty","/dev/stdout"),n.stderr?de.createDevice("/dev","stderr",null,n.stderr):de.symlink("/dev/tty1","/dev/stderr"),de.open("/dev/stdin",0),de.open("/dev/stdout",1),de.open("/dev/stderr",1)},ensureErrnoError(){de.ErrnoError||(de.ErrnoError=function(e,t){this.name="ErrnoError",this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},de.ErrnoError.prototype=new Error,de.ErrnoError.prototype.constructor=de.ErrnoError,[44].forEach((e=>{de.genericErrors[e]=new de.ErrnoError(e),de.genericErrors[e].stack="<generic error, no stack>"})))},staticInit(){de.ensureErrnoError(),de.nameTable=new Array(4096),de.mount(ie,{},"/"),de.createDefaultDirectories(),de.createDefaultDevices(),de.createSpecialDirectories(),de.filesystems={MEMFS:ie,IDBFS:ce}},init(e,t,r){de.init.initialized=!0,de.ensureErrnoError(),n.stdin=e||n.stdin,n.stdout=t||n.stdout,n.stderr=r||n.stderr,de.createStandardStreams()},quit(){de.init.initialized=!1;for(var e=0;e<de.streams.length;e++){var t=de.streams[e];t&&de.close(t)}},findObject(e,t){var r=de.analyzePath(e,t);return r.exists?r.object:null},analyzePath(e,t){try{e=(n=de.lookupPath(e,{follow:!t})).path}catch(e){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=de.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=n.path,r.parentObject=n.node,r.name=J.basename(e),n=de.lookupPath(e,{follow:!t}),r.exists=!0,r.path=n.path,r.object=n.node,r.name=n.node.name,r.isRoot="/"===n.path}catch(e){r.error=e.errno}return r},createPath(e,t,r,n){e="string"==typeof e?e:de.getPath(e);for(var o=t.split("/").reverse();o.length;){var a=o.pop();if(a){var s=J.join2(e,a);try{de.mkdir(s)}catch(e){}e=s}}return s},createFile(e,t,r,n,o){var a=J.join2("string"==typeof e?e:de.getPath(e),t),s=le(n,o);return de.create(a,s)},createDataFile(e,t,r,n,o,a){var s=t;e&&(e="string"==typeof e?e:de.getPath(e),s=t?J.join2(e,t):e);var i=le(n,o),u=de.create(s,i);if(r){if("string"==typeof r){for(var l=new Array(r.length),c=0,d=r.length;c<d;++c)l[c]=r.charCodeAt(c);r=l}de.chmod(u,146|i);var h=de.open(u,577);de.write(h,r,0,r.length,0,a),de.close(h),de.chmod(u,i)}},createDevice(e,t,r,n){var o=J.join2("string"==typeof e?e:de.getPath(e),t),a=le(!!r,!!n);de.createDevice.major||(de.createDevice.major=64);var s=de.makedev(de.createDevice.major++,0);return de.registerDevice(s,{open(e){e.seekable=!1},close(e){n&&n.buffer&&n.buffer.length&&n(10)},read(e,t,n,o,a){for(var s=0,i=0;i<o;i++){var u;try{u=r()}catch(e){throw new de.ErrnoError(29)}if(void 0===u&&0===s)throw new de.ErrnoError(6);if(null==u)break;s++,t[n+i]=u}return s&&(e.node.timestamp=Date.now()),s},write(e,t,r,o,a){for(var s=0;s<o;s++)try{n(t[r+s])}catch(e){throw new de.ErrnoError(29)}return o&&(e.node.timestamp=Date.now()),s}}),de.mkdev(o,a,s)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!o)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=oe(o(e.url),!0),e.usedBytes=e.contents.length}catch(e){throw new de.ErrnoError(29)}},createLazyFile(e,t,r,n,o){function a(){this.lengthKnown=!1,this.chunks=[]}if(a.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,r=e/this.chunkSize|0;return this.getter(r)[t]}},a.prototype.setDataGetter=function(e){this.getter=e},a.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",r,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+r+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),o=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,a=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,s=1048576;o||(s=n);var i=this;i.setDataGetter((e=>{var t=e*s,o=(e+1)*s-1;if(o=Math.min(o,n-1),void 0===i.chunks[e]&&(i.chunks[e]=((e,t)=>{if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var o=new XMLHttpRequest;if(o.open("GET",r,!1),n!==s&&o.setRequestHeader("Range","bytes="+e+"-"+t),o.responseType="arraybuffer",o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined"),o.send(null),!(o.status>=200&&o.status<300||304===o.status))throw new Error("Couldn't load "+r+". Status: "+o.status);return void 0!==o.response?new Uint8Array(o.response||[]):oe(o.responseText||"",!0)})(t,o)),void 0===i.chunks[e])throw new Error("doXHR failed!");return i.chunks[e]})),!a&&n||(s=n=1,n=this.getter(0).length,s=n,p("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=s,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var s={isDevice:!1,url:r},i=de.createFile(e,t,s,n,o);s.contents?i.contents=s.contents:s.url&&(i.contents=null,i.url=s.url),Object.defineProperties(i,{usedBytes:{get:function(){return this.contents.length}}});var u={};function l(e,t,r,n,o){var a=e.node.contents;if(o>=a.length)return 0;var s=Math.min(a.length-o,n);if(a.slice)for(var i=0;i<s;i++)t[r+i]=a[o+i];else for(i=0;i<s;i++)t[r+i]=a.get(o+i);return s}return Object.keys(i.stream_ops).forEach((e=>{var t=i.stream_ops[e];u[e]=function(){return de.forceLoadFile(i),t.apply(null,arguments)}})),u.read=(e,t,r,n,o)=>(de.forceLoadFile(i),l(e,t,r,n,o)),u.mmap=(e,t,r,n,o)=>{de.forceLoadFile(i);var a=se(t);if(!a)throw new de.ErrnoError(48);return l(e,g,a,t,r),{ptr:a,allocated:!0}},i.stream_ops=u,i}},he=(e,t)=>e?ee(v,e,t):"",pe={DEFAULT_POLLMASK:5,calculateAt(e,t,r){if(J.isAbs(t))return t;var n;if(n=-100===e?de.cwd():pe.getStreamFromFD(e).path,0==t.length){if(!r)throw new de.ErrnoError(44);return n}return J.join2(n,t)},doStat(e,t,r){try{var n=e(t)}catch(e){if(e&&e.node&&J.normalize(t)!==J.normalize(de.getPath(e.node)))return-54;throw e}_[r>>2]=n.dev,_[r+4>>2]=n.mode,E[r+8>>2]=n.nlink,_[r+12>>2]=n.uid,_[r+16>>2]=n.gid,_[r+20>>2]=n.rdev,j=[n.size>>>0,(N=n.size,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],_[r+24>>2]=j[0],_[r+28>>2]=j[1],_[r+32>>2]=4096,_[r+36>>2]=n.blocks;var o=n.atime.getTime(),a=n.mtime.getTime(),s=n.ctime.getTime();return j=[Math.floor(o/1e3)>>>0,(N=Math.floor(o/1e3),+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],_[r+40>>2]=j[0],_[r+44>>2]=j[1],E[r+48>>2]=o%1e3*1e3,j=[Math.floor(a/1e3)>>>0,(N=Math.floor(a/1e3),+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],_[r+56>>2]=j[0],_[r+60>>2]=j[1],E[r+64>>2]=a%1e3*1e3,j=[Math.floor(s/1e3)>>>0,(N=Math.floor(s/1e3),+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],_[r+72>>2]=j[0],_[r+76>>2]=j[1],E[r+80>>2]=s%1e3*1e3,j=[n.ino>>>0,(N=n.ino,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],_[r+88>>2]=j[0],_[r+92>>2]=j[1],0},doMsync(e,t,r,n,o){if(!de.isFile(t.node.mode))throw new de.ErrnoError(43);if(2&n)return 0;var a=v.slice(e,e+r);de.msync(t,a,o,r,n)},varargs:void 0,get(){var e=_[+pe.varargs>>2];return pe.varargs+=4,e},getp:()=>pe.get(),getStr:e=>he(e),getStreamFromFD:e=>de.getStreamChecked(e)},me=(e,t,r)=>ne(e,v,t,r),fe=(e,t)=>Object.defineProperty(t,"name",{value:e});function ge(){this.allocated=[void 0],this.freelist=[]}var ve,ye,we,_e,Ee,be=new ge,Se=e=>{throw new ve(e)},ke=()=>{for(var e=0,t=be.reserved;t<be.allocated.length;++t)void 0!==be.allocated[t]&&++e;return e},Oe={toValue:e=>(e||Se("Cannot use deleted val. handle = "+e),be.get(e).value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return be.allocate({refcount:1,value:e})}}},Me=(e,t)=>{var r=fe(t,(function(e){this.name=t,this.message=e;var r=new Error(e).stack;void 0!==r&&(this.stack=this.toString()+"\n"+r.replace(/^Error(:[^\n]*)?\n/,""))}));return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:`${this.name}: ${this.message}`},r},Ce=e=>{for(var t="",r=e;v[r];)t+=we[v[r++]];return t},Re=()=>Object.keys(De).length,Ie=()=>{var e=[];for(var t in De)De.hasOwnProperty(t)&&e.push(De[t]);return e},Te=[],Ae=()=>{for(;Te.length;){var e=Te.pop();e.$$.deleteScheduled=!1,e.delete()}},Pe=e=>{_e=e,Te.length&&_e&&_e(Ae)},De={},$e=(e,t)=>{for(void 0===t&&Se("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t},Fe={},xe=e=>{var t=kr(e),r=Ce(t);return br(t),r},Le=(e,t)=>{var r=Fe[e];return void 0===r&&Se(t+" has unknown type "+xe(e)),r},Ne=e=>{},je=!1,We=e=>{e.count.value-=1,0===e.count.value&&(e=>{e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)})(e)},Ue=(e,t,r)=>{if(t===r)return e;if(void 0===r.baseClass)return null;var n=Ue(e,t,r.baseClass);return null===n?null:r.downcast(n)},Ge={},ze=e=>{throw new Ee(e)},Be=(e,t)=>(t.ptrType&&t.ptr||ze("makeClassHandle requires ptr and ptrType"),!!t.smartPtrType!=!!t.smartPtr&&ze("Both smartPtrType and smartPtr must be specified"),t.count={value:1},qe(Object.create(e,{$$:{value:t}})));function He(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=((e,t)=>(t=$e(e,t),De[t]))(this.registeredClass,t);if(void 0!==r){if(0===r.$$.count.value)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var n=r.clone();return this.destructor(e),n}function o(){return this.isSmartPointer?Be(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Be(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var a,s=this.registeredClass.getActualType(t),i=Ge[s];if(!i)return o.call(this);a=this.isConst?i.constPointerType:i.pointerType;var u=Ue(t,this.registeredClass,a.registeredClass);return null===u?o.call(this):this.isSmartPointer?Be(a.registeredClass.instancePrototype,{ptrType:a,ptr:u,smartPtrType:this,smartPtr:e}):Be(a.registeredClass.instancePrototype,{ptrType:a,ptr:u})}var qe=e=>"undefined"==typeof FinalizationRegistry?(qe=e=>e,e):(je=new FinalizationRegistry((e=>{We(e.$$)})),Ne=e=>je.unregister(e),(qe=e=>{var t=e.$$;if(t.smartPtr){var r={$$:t};je.register(e,r,e)}return e})(e)),Ve={},Ye=e=>{for(;e.length;){var t=e.pop();e.pop()(t)}};function Xe(e){return this.fromWireType(_[e>>2])}var Je={},Ke={},Qe=(e,t,r)=>{function n(t){var n=r(t);n.length!==e.length&&ze("Mismatched type converter count");for(var o=0;o<e.length;++o)Ze(e[o],n[o])}e.forEach((function(e){Ke[e]=t}));var o=new Array(t.length),a=[],s=0;t.forEach(((e,t)=>{Fe.hasOwnProperty(e)?o[t]=Fe[e]:(a.push(e),Je.hasOwnProperty(e)||(Je[e]=[]),Je[e].push((()=>{o[t]=Fe[e],++s===a.length&&n(o)})))})),0===a.length&&n(o)};function Ze(e,t,r={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return function(e,t,r={}){var n=t.name;if(e||Se(`type "${n}" must have a positive integer typeid pointer`),Fe.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;Se(`Cannot register type '${n}' twice`)}if(Fe[e]=t,delete Ke[e],Je.hasOwnProperty(e)){var o=Je[e];delete Je[e],o.forEach((e=>e()))}}(e,t,r)}var et=8,tt=e=>{Se(e.$$.ptrType.registeredClass.name+" instance already deleted")};function rt(){}var nt=(e,t,r)=>{if(void 0===e[t].overloadTable){var n=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||Se(`Function '${r}' called with an invalid number of arguments (${arguments.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[n.argCount]=n}},ot=(e,t,r)=>{n.hasOwnProperty(e)?((void 0===r||void 0!==n[e].overloadTable&&void 0!==n[e].overloadTable[r])&&Se(`Cannot register public name '${e}' twice`),nt(n,e,e),n.hasOwnProperty(r)&&Se(`Cannot register multiple overloads of a function with the same number of arguments (${r})!`),n[e].overloadTable[r]=t):(n[e]=t,void 0!==r&&(n[e].numArguments=r))};function at(e,t,r,n,o,a,s,i){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=n,this.baseClass=o,this.getActualType=a,this.upcast=s,this.downcast=i,this.pureVirtualFunctions=[]}var st=(e,t,r)=>{for(;t!==r;)t.upcast||Se(`Expected null or instance of ${r.name}, got an instance of ${t.name}`),e=t.upcast(e),t=t.baseClass;return e};function it(e,t){if(null===t)return this.isReference&&Se(`null is not a valid ${this.name}`),0;t.$$||Se(`Cannot pass "${Ot(t)}" as a ${this.name}`),t.$$.ptr||Se(`Cannot pass deleted object as a pointer of type ${this.name}`);var r=t.$$.ptrType.registeredClass;return st(t.$$.ptr,r,this.registeredClass)}function ut(e,t){var r;if(null===t)return this.isReference&&Se(`null is not a valid ${this.name}`),this.isSmartPointer?(r=this.rawConstructor(),null!==e&&e.push(this.rawDestructor,r),r):0;t.$$||Se(`Cannot pass "${Ot(t)}" as a ${this.name}`),t.$$.ptr||Se(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&t.$$.ptrType.isConst&&Se(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);var n=t.$$.ptrType.registeredClass;if(r=st(t.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(void 0===t.$$.smartPtr&&Se("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:Se(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var o=t.clone();r=this.rawShare(r,Oe.toHandle((()=>o.delete()))),null!==e&&e.push(this.rawDestructor,r)}break;default:Se("Unsupporting sharing policy")}return r}function lt(e,t){if(null===t)return this.isReference&&Se(`null is not a valid ${this.name}`),0;t.$$||Se(`Cannot pass "${Ot(t)}" as a ${this.name}`),t.$$.ptr||Se(`Cannot pass deleted object as a pointer of type ${this.name}`),t.$$.ptrType.isConst&&Se(`Cannot convert argument of type ${t.$$.ptrType.name} to parameter type ${this.name}`);var r=t.$$.ptrType.registeredClass;return st(t.$$.ptr,r,this.registeredClass)}function ct(e){return this.fromWireType(E[e>>2])}function dt(e,t,r,n,o,a,s,i,u,l,c){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=n,this.isSmartPointer=o,this.pointeeType=a,this.sharingPolicy=s,this.rawGetPointee=i,this.rawConstructor=u,this.rawShare=l,this.rawDestructor=c,o||void 0!==t.baseClass?this.toWireType=ut:n?(this.toWireType=it,this.destructorFunction=null):(this.toWireType=lt,this.destructorFunction=null)}var ht,pt,mt=e=>ht.get(e),ft=(e,t,r)=>e.includes("j")?((e,t,r)=>{var o=n["dynCall_"+e];return r&&r.length?o.apply(null,[t].concat(r)):o.call(null,t)})(e,t,r):mt(t).apply(null,r),gt=(e,t)=>{var r,n,o,a=(e=Ce(e)).includes("j")?(r=e,n=t,o=[],function(){return o.length=0,Object.assign(o,arguments),ft(r,n,o)}):mt(t);return"function"!=typeof a&&Se(`unknown function pointer with signature ${e}: ${t}`),a},vt=(e,t)=>{var r=[],n={};throw t.forEach((function e(t){n[t]||Fe[t]||(Ke[t]?Ke[t].forEach(e):(r.push(t),n[t]=!0))})),new pt(`${e}: `+r.map(xe).join([", "]))};function yt(e,t,r,n,o,a){var s=t.length;s<2&&Se("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var i=null!==t[1]&&null!==r,u=!1,l=1;l<t.length;++l)if(null!==t[l]&&void 0===t[l].destructorFunction){u=!0;break}var c="void"!==t[0].name,d=s-2,h=new Array(d),p=[],m=[];return fe(e,(function(){var r;arguments.length!==d&&Se(`function ${e} called with ${arguments.length} arguments, expected ${d}`),m.length=0,p.length=i?2:1,p[0]=o,i&&(r=t[1].toWireType(m,this),p[1]=r);for(var a=0;a<d;++a)h[a]=t[a+2].toWireType(m,arguments[a]),p.push(h[a]);return function(e){if(u)Ye(m);else for(var n=i?1:2;n<t.length;n++){var o=1===n?r:h[n-2];null!==t[n].destructorFunction&&t[n].destructorFunction(o)}if(c)return t[0].fromWireType(e)}(n.apply(null,p))}))}var wt,_t=(e,t)=>{for(var r=[],n=0;n<e;n++)r.push(E[t+4*n>>2]);return r},Et=e=>{const t=(e=e.trim()).indexOf("(");return-1!==t?e.substr(0,t):e},bt=(e,t,r)=>(e instanceof Object||Se(`${r} with invalid "this": ${e}`),e instanceof t.registeredClass.constructor||Se(`${r} incompatible with "this" of type ${e.constructor.name}`),e.$$.ptr||Se(`cannot call emscripten binding method ${r} on deleted object`),st(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)),St=e=>{e>=be.reserved&&0==--be.get(e).refcount&&be.free(e)},kt=(e,t,r)=>{switch(t){case 1:return r?function(e){return this.fromWireType(g[e>>0])}:function(e){return this.fromWireType(v[e>>0])};case 2:return r?function(e){return this.fromWireType(y[e>>1])}:function(e){return this.fromWireType(w[e>>1])};case 4:return r?function(e){return this.fromWireType(_[e>>2])}:function(e){return this.fromWireType(E[e>>2])};default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},Ot=e=>{if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e},Mt=(e,t)=>{switch(t){case 4:return function(e){return this.fromWireType(b[e>>2])};case 8:return function(e){return this.fromWireType(S[e>>3])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},Ct=(e,t,r)=>{switch(t){case 1:return r?e=>g[e>>0]:e=>v[e>>0];case 2:return r?e=>y[e>>1]:e=>w[e>>1];case 4:return r?e=>_[e>>2]:e=>E[e>>2];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},Rt="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,It=(e,t)=>{for(var r=e,n=r>>1,o=n+t/2;!(n>=o)&&w[n];)++n;if((r=n<<1)-e>32&&Rt)return Rt.decode(v.subarray(e,r));for(var a="",s=0;!(s>=t/2);++s){var i=y[e+2*s>>1];if(0==i)break;a+=String.fromCharCode(i)}return a},Tt=(e,t,r)=>{if(void 0===r&&(r=2147483647),r<2)return 0;for(var n=t,o=(r-=2)<2*e.length?r/2:e.length,a=0;a<o;++a){var s=e.charCodeAt(a);y[t>>1]=s,t+=2}return y[t>>1]=0,t-n},At=e=>2*e.length,Pt=(e,t)=>{for(var r=0,n="";!(r>=t/4);){var o=_[e+4*r>>2];if(0==o)break;if(++r,o>=65536){var a=o-65536;n+=String.fromCharCode(55296|a>>10,56320|1023&a)}else n+=String.fromCharCode(o)}return n},Dt=(e,t,r)=>{if(void 0===r&&(r=2147483647),r<4)return 0;for(var n=t,o=n+r-4,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),_[t>>2]=s,(t+=4)+4>o)break}return _[t>>2]=0,t-n},$t=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&++r,t+=4}return t},Ft=[],xt={},Lt=Reflect.construct,Nt=(e,t)=>t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,jt=e=>e%4==0&&(e%100!=0||e%400==0),Wt=[0,31,60,91,121,152,182,213,244,274,305,335],Ut=[0,31,59,90,120,151,181,212,243,273,304,334],Gt=e=>(jt(e.getFullYear())?Wt:Ut)[e.getMonth()]+e.getDate()-1,zt=e=>{var t=re(e)+1,r=_r(t);return r&&me(e,r,t),r};wt=()=>Date.now();var Bt=e=>{if(e instanceof G||"unwind"==e)return f;l(1,e)},Ht=()=>B||!1,qt=(e,t)=>{var r;f=e,f=r=e,Ht()||(n.onExit&&n.onExit(r),k=!0),l(r,new G(r))},Vt=qt,Yt=e=>{if(!k)try{e(),(()=>{if(!Ht())try{Vt(f)}catch(e){Bt(e)}})()}catch(e){Bt(e)}},Xt={getDB:(e,t,r)=>{var n=wx.env.USER_DATA_PATH+t.replace("//stat/aio_stat","/"+e),o=n.substr(0,n.lastIndexOf("/")+1),a=wx.getFileSystemManager();a.stat({path:o,success:e=>r(null,n),fail:e=>{a.mkdir({dirPath:o,recursive:!0,success:e=>r(null,n),fail:e=>(console.error("mkdir fail",e),r(e))})}})},getStore(e,t,r){Xt.getDB(e,t,((e,t)=>{e&&r(e),wx.getFileSystemManager().stat({path:t,success:e=>{r(null,t)},fail:e=>{console.log("getStore stat fail:",e),r(null,t)}})}))},getFile(e,t,r){Xt.getStore(e,t,((e,t)=>{wx.getFileSystemManager().readFile({filePath:t,success:e=>{r(null,e.data)},fail:e=>{r(e)}})}))},setFile(e,t,r,n){Xt.getStore(e,t,((e,t)=>{wx.getFileSystemManager().writeFile({filePath:t,data:r.buffer,success:e=>{n()},fail:e=>{console.log("setFile error",t,e),n(e)}})}))},deleteFile(e,t,r){Xt.getStore(e,t,((e,t)=>{wx.getFileSystemManager().unlink({filePath:t,success:e=>{r()},fail:e=>{r(e)}})}))},storeExistsFile(e,t){},existsFile(e,t,r){Xt.getStore(e,t,((e,t)=>{var n=!1;try{wx.getFileSystemManager().stat({path:t,success:e=>{n=e.stats.isFile(),r(null,n)},fail:e=>{r(null,!1)}})}catch(e){}}))},clearStore(e,t){Xt.getStore(e,id,((e,r)=>{wx.getFileSystemManager().rmdir({filePath:r,success:e=>{t(null,e.data)},fail:e=>{t(e)}})}))}},Jt=e=>{var t=(e-h.buffer.byteLength+65535)/65536;try{return h.grow(t),M(),1}catch(e){}},Kt={openDatabase(e,t,r,n){try{var o=indexedDB.open(e,t)}catch(e){return n(e)}o.onupgradeneeded=e=>{var t=e.target.result;t.objectStoreNames.contains("FILES")&&t.deleteObjectStore("FILES"),t.createObjectStore("FILES")},o.onsuccess=e=>r(e.target.result),o.onerror=e=>n(e)},init(){Kt.xhrs=new ge,D(),Kt.openDatabase("emscripten_filesystem",1,(e=>{Kt.dbInstance=e,$()}),(()=>{Kt.dbInstance=!1,$()}))}};function Qt(e,t,r,n,o){var a=E[e+8>>2];if(a){var s=he(a),i=e+112,u=he(i+0);u||(u="GET"),E[i+56>>2];var l=E[i+68>>2],c=E[i+72>>2],d=E[i+76>>2];E[i+80>>2];var h=E[i+84>>2],p=E[i+88>>2];E[i+52>>2],l&&he(l),c&&he(c);var m={},f="application/x-protobuf";if(d)for(;;){var g=E[d>>2];if(!g)break;var y=E[d+4>>2];if(!y)break;d+=8;var _=he(g),b=he(y);"content-type"==_.toLowerCase()?f=b:m[_]=b}var S=Kt.xhrs.allocate({});E[e>>2]=S;var k=h&&p?v.slice(h,h+p):null;wx.request({url:s,method:u,data:p>0?k.buffer:"",header:{"content-type":f,...m},success(n){var o="";n.data&&""!=n.data&&(o=JSON.stringify(n.data)),O(function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t}(o)),200===n.statusCode?t(e,0,null):r(e,0,n)},fail(t){console.log("fetchXHR fail",s,t),O(new ArrayBuffer),r(e,0,t)}})}else r(e,0,"no url specified!");function O(t){var r=0,n=0;0===E[e+12>>2]&&(n=t.byteLength),n>0&&(r=_r(n),v.set(new Uint8Array(t),r)),E[e+12>>2]=r,Zt(e+16,n),Zt(e+24,0);var o=t?t.byteLength:0;o&&Zt(e+32,o),w[e+40>>1]=4,w[e+42>>1]=200,0===o&&me("OK",e+44,64)}}var Zt=(e,t)=>{E[e>>2]=t;var r=E[e>>2];E[e+4>>2]=(t-r)/4294967296};function er(e,t,r,n,o){if(e){var a=E[t+112+64>>2];a||(a=E[t+8>>2]);var s=he(a);try{var i=e.transaction(["FILES"],"readwrite").objectStore("FILES").put(r,s);i.onsuccess=e=>{w[t+40>>1]=4,w[t+42>>1]=200,me("OK",t+44,64),n(t,0,s)},i.onerror=e=>{w[t+40>>1]=4,w[t+42>>1]=413,me("Payload Too Large",t+44,64),o(t,0,e)}}catch(e){o(t,0,e)}}else o(t,0,"IndexedDB not available!")}var tr={},rr=()=>{if(!rr.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:u||"./this.program"};for(var t in tr)void 0===tr[t]?delete e[t]:e[t]=tr[t];var r=[];for(var t in e)r.push(`${t}=${e[t]}`);rr.strings=r}return rr.strings};function nr(e){const t=re(e)+1,r=_r(t);return me(e,r,t),r}var or,ar=[31,29,31,30,31,30,31,31,30,31,30,31],sr=[31,28,31,30,31,30,31,31,30,31,30,31],ir=(e,t)=>{g.set(e,t)},ur=(e,t,r,n)=>{var o=E[n+40>>2],a={tm_sec:_[n>>2],tm_min:_[n+4>>2],tm_hour:_[n+8>>2],tm_mday:_[n+12>>2],tm_mon:_[n+16>>2],tm_year:_[n+20>>2],tm_wday:_[n+24>>2],tm_yday:_[n+28>>2],tm_isdst:_[n+32>>2],tm_gmtoff:_[n+36>>2],tm_zone:o?he(o):""},s=he(r),i={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var u in i)s=s.replace(new RegExp(u,"g"),i[u]);var l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],c=["January","February","March","April","May","June","July","August","September","October","November","December"];function d(e,t,r){for(var n="number"==typeof e?e.toString():e||"";n.length<t;)n=r[0]+n;return n}function h(e,t){return d(e,t,"0")}function p(e,t){function r(e){return e<0?-1:e>0?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function m(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function f(e){var t=((e,t)=>{for(var r=new Date(e.getTime());t>0;){var n=jt(r.getFullYear()),o=r.getMonth(),a=(n?ar:sr)[o];if(!(t>a-r.getDate()))return r.setDate(r.getDate()+t),r;t-=a-r.getDate()+1,r.setDate(1),o<11?r.setMonth(o+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1))}return r})(new Date(e.tm_year+1900,0,1),e.tm_yday),r=new Date(t.getFullYear(),0,4),n=new Date(t.getFullYear()+1,0,4),o=m(r),a=m(n);return p(o,t)<=0?p(a,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var g={"%a":e=>l[e.tm_wday].substring(0,3),"%A":e=>l[e.tm_wday],"%b":e=>c[e.tm_mon].substring(0,3),"%B":e=>c[e.tm_mon],"%C":e=>h((e.tm_year+1900)/100|0,2),"%d":e=>h(e.tm_mday,2),"%e":e=>d(e.tm_mday,2," "),"%g":e=>f(e).toString().substring(2),"%G":e=>f(e),"%H":e=>h(e.tm_hour,2),"%I":e=>{var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),h(t,2)},"%j":e=>h(e.tm_mday+((e,t)=>{for(var r=0,n=0;n<=t;r+=e[n++]);return r})(jt(e.tm_year+1900)?ar:sr,e.tm_mon-1),3),"%m":e=>h(e.tm_mon+1,2),"%M":e=>h(e.tm_min,2),"%n":()=>"\n","%p":e=>e.tm_hour>=0&&e.tm_hour<12?"AM":"PM","%S":e=>h(e.tm_sec,2),"%t":()=>"\t","%u":e=>e.tm_wday||7,"%U":e=>{var t=e.tm_yday+7-e.tm_wday;return h(Math.floor(t/7),2)},"%V":e=>{var t=Math.floor((e.tm_yday+7-(e.tm_wday+6)%7)/7);if((e.tm_wday+371-e.tm_yday-2)%7<=2&&t++,t){if(53==t){var r=(e.tm_wday+371-e.tm_yday)%7;4==r||3==r&&jt(e.tm_year)||(t=1)}}else{t=52;var n=(e.tm_wday+7-e.tm_yday-1)%7;(4==n||5==n&&jt(e.tm_year%400-1))&&t++}return h(t,2)},"%w":e=>e.tm_wday,"%W":e=>{var t=e.tm_yday+7-(e.tm_wday+6)%7;return h(Math.floor(t/7),2)},"%y":e=>(e.tm_year+1900).toString().substring(2),"%Y":e=>e.tm_year+1900,"%z":e=>{var t=e.tm_gmtoff,r=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(r?"+":"-")+String("0000"+t).slice(-4)},"%Z":e=>e.tm_zone,"%%":()=>"%"};for(var u in s=s.replace(/%%/g,"\0\0"),g)s.includes(u)&&(s=s.replace(new RegExp(u,"g"),g[u](a)));var v=oe(s=s.replace(/\0\0/g,"%"),!1);return v.length>t?0:(ir(v,e),v.length-1)},lr=zt,cr=(e,t)=>{e<128?t.push(e):t.push(e%128|128,e>>7)},dr=(e,t)=>{if("function"==typeof WebAssembly.Function)return new WebAssembly.Function((e=>{for(var t={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},r={parameters:[],results:"v"==e[0]?[]:[t[e[0]]]},n=1;n<e.length;++n)r.parameters.push(t[e[n]]);return r})(t),e);var r=[1];((e,t)=>{var r=e.slice(0,1),n=e.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111};t.push(96),cr(n.length,t);for(var a=0;a<n.length;++a)t.push(o[n[a]]);"v"==r?t.push(0):t.push(1,o[r])})(t,r);var n=[0,97,115,109,1,0,0,0,1];cr(r.length,n),n.push.apply(n,r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var o=new WebAssembly.Module(new Uint8Array(n));return new WebAssembly.Instance(o,{e:{f:e}}).exports.f},hr=e=>(or||(or=new WeakMap,((e,t)=>{if(or)for(var r=e;r<e+t;r++){var n=mt(r);n&&or.set(n,r)}})(0,ht.length)),or.get(e)||0),pr=[],mr=(e,t)=>ht.set(e,t),fr=function(e,t,r,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=de.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=n},gr=365,vr=146;Object.defineProperties(fr.prototype,{read:{get:function(){return(this.mode&gr)===gr},set:function(e){e?this.mode|=gr:this.mode&=-366}},write:{get:function(){return(this.mode&vr)===vr},set:function(e){e?this.mode|=vr:this.mode&=-147}},isFolder:{get:function(){return de.isDir(this.mode)}},isDevice:{get:function(){return de.isChrdev(this.mode)}}}),de.FSNode=fr,de.createPreloadedFile=(e,t,r,n,o,s,i,u,l,c)=>{var d=t?Q.resolve(J.join2(e,t)):e;function h(r){function a(r){c&&c(),u||((e,t,r,n,o,a)=>{de.createDataFile(e,t,r,n,o,a)})(e,t,r,n,o,l),s&&s(),$()}((e,t,r,n)=>{"undefined"!=typeof Browser&&Browser.init();var o=!1;return ue.forEach((a=>{o||a.canHandle(t)&&(a.handle(e,t,r,n),o=!0)})),o})(r,d,a,(()=>{i&&i(),$()}))||a(r)}D(),"string"==typeof r?((e,t,r,n)=>{var o=n?"":`al ${e}`;a(e,(r=>{O(r,`Loading data file "${e}" failed (no arrayBuffer).`),t(new Uint8Array(r)),o&&$()}),(t=>{if(!r)throw`Loading data file "${e}" failed.`;r()})),o&&D()})(r,(e=>h(e)),i):h(r)},de.staticInit(),Object.assign(ge.prototype,{get(e){return this.allocated[e]},has(e){return void 0!==this.allocated[e]},allocate(e){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=e,t},free(e){this.allocated[e]=void 0,this.freelist.push(e)}}),ve=n.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},be.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),be.reserved=be.allocated.length,n.count_emval_handles=ke,ye=n.PureVirtualError=Me(Error,"PureVirtualError"),(()=>{for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);we=e})(),n.getInheritedInstanceCount=Re,n.getLiveInheritedInstances=Ie,n.flushPendingDeletes=Ae,n.setDelayFunction=Pe,Ee=n.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},Object.assign(rt.prototype,{isAliasOf(e){if(!(this instanceof rt))return!1;if(!(e instanceof rt))return!1;var t=this.$$.ptrType.registeredClass,r=this.$$.ptr;e.$$=e.$$;for(var n=e.$$.ptrType.registeredClass,o=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;n.baseClass;)o=n.upcast(o),n=n.baseClass;return t===n&&r===o},clone(){if(this.$$.ptr||tt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e,t=qe(Object.create(Object.getPrototypeOf(this),{$$:{value:(e=this.$$,{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType})}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t},delete(){this.$$.ptr||tt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Se("Object already scheduled for deletion"),Ne(this),We(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||tt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Se("Object already scheduled for deletion"),Te.push(this),1===Te.length&&_e&&_e(Ae),this.$$.deleteScheduled=!0,this}}),Object.assign(dt.prototype,{getPointee(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},destructor(e){this.rawDestructor&&this.rawDestructor(e)},argPackAdvance:et,readValueFromPointer:ct,deleteObject(e){null!==e&&e.delete()},fromWireType:He}),pt=n.UnboundTypeError=Me(Error,"UnboundTypeError"),Kt.init();var yr={y:e=>{var t=new Y(e);return t.get_caught()||(t.set_caught(!0),q--),t.set_rethrown(!1),H.push(t),Pr(t.excPtr),t.get_exception_ptr()},C:()=>{Mr(0,0);var e=H.pop();Ar(e.excPtr),V=0},c:()=>X([]),j:e=>X([e]),W:()=>{var e=H.pop();e||F("no exception to throw");var t=e.excPtr;throw e.get_rethrown()||(H.push(e),e.set_rethrown(!0),e.set_caught(!1),q++),V=t},q:(e,t,r)=>{throw new Y(e).init(t,r),q++,V=e},ja:()=>q,h:e=>{throw V||(V=e),V},za:function(e,t,r,n){try{if(t=pe.getStr(t),t=pe.calculateAt(e,t),-8&r)return-28;var o=de.lookupPath(t,{follow:!0}).node;if(!o)return-44;var a="";return 4&r&&(a+="r"),2&r&&(a+="w"),1&r&&(a+="x"),a&&de.nodePermissions(o,a)?-2:0}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},Z:function(e,t,r){pe.varargs=r;try{var n=pe.getStreamFromFD(e);switch(t){case 0:if((o=pe.get())<0)return-28;for(;de.streams[o];)o++;return de.createStream(n,o).fd;case 1:case 2:case 6:case 7:return 0;case 3:return n.flags;case 4:var o=pe.get();return n.flags|=o,0;case 5:return o=pe.getp(),y[o+0>>1]=2,0;case 16:case 8:default:return-28;case 9:return a=28,_[Sr()>>2]=a,-1}}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}var a},va:function(e,t){try{var r=pe.getStreamFromFD(e);return pe.doStat(de.stat,r.path,t)}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},oa:function(e,t,r){try{var n=pe.getStreamFromFD(e);n.getdents||(n.getdents=de.readdir(n.path));for(var o=280,a=0,s=de.llseek(n,0,1),i=Math.floor(s/o);i<n.getdents.length&&a+o<=r;){var u,l,c=n.getdents[i];if("."===c)u=n.node.id,l=4;else if(".."===c)u=de.lookupPath(n.path,{parent:!0}).node.id,l=4;else{var d=de.lookupNode(n.node,c);u=d.id,l=de.isChrdev(d.mode)?2:de.isDir(d.mode)?4:de.isLink(d.mode)?10:8}j=[u>>>0,(N=u,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],_[t+a>>2]=j[0],_[t+a+4>>2]=j[1],j=[(i+1)*o>>>0,(N=(i+1)*o,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],_[t+a+8>>2]=j[0],_[t+a+12>>2]=j[1],y[t+a+16>>1]=280,g[t+a+18>>0]=l,me(c,t+a+19,256),a+=o,i+=1}return de.llseek(n,i*o,0),a}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},wa:function(e,t,r){pe.varargs=r;try{var n=pe.getStreamFromFD(e);switch(t){case 21509:case 21510:case 21511:case 21512:case 21524:case 21515:return n.tty?0:-59;case 21505:if(!n.tty)return-59;if(n.tty.ops.ioctl_tcgets){var o=n.tty.ops.ioctl_tcgets(n),a=pe.getp();_[a>>2]=o.c_iflag||0,_[a+4>>2]=o.c_oflag||0,_[a+8>>2]=o.c_cflag||0,_[a+12>>2]=o.c_lflag||0;for(var s=0;s<32;s++)g[a+s+17>>0]=o.c_cc[s]||0;return 0}return 0;case 21506:case 21507:case 21508:if(!n.tty)return-59;if(n.tty.ops.ioctl_tcsets){a=pe.getp();var i=_[a>>2],u=_[a+4>>2],l=_[a+8>>2],c=_[a+12>>2],d=[];for(s=0;s<32;s++)d.push(g[a+s+17>>0]);return n.tty.ops.ioctl_tcsets(n.tty,t,{c_iflag:i,c_oflag:u,c_cflag:l,c_lflag:c,c_cc:d})}return 0;case 21519:return n.tty?(a=pe.getp(),_[a>>2]=0,0):-59;case 21520:return n.tty?-28:-59;case 21531:return a=pe.getp(),de.ioctl(n,t,a);case 21523:if(!n.tty)return-59;if(n.tty.ops.ioctl_tiocgwinsz){var h=n.tty.ops.ioctl_tiocgwinsz(n.tty);a=pe.getp(),y[a>>1]=h[0],y[a+2>>1]=h[1]}return 0;default:return-28}}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},sa:function(e,t){try{return e=pe.getStr(e),pe.doStat(de.lstat,e,t)}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},pa:function(e,t,r){try{return t=pe.getStr(t),t=pe.calculateAt(e,t),"/"===(t=J.normalize(t))[t.length-1]&&(t=t.substr(0,t.length-1)),de.mkdir(t,r,0),0}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},ta:function(e,t,r,n){try{t=pe.getStr(t);var o=256&n,a=4096&n;return n&=-6401,t=pe.calculateAt(e,t,a),pe.doStat(o?de.lstat:de.stat,t,r)}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},_:function(e,t,r,n){pe.varargs=n;try{t=pe.getStr(t),t=pe.calculateAt(e,t);var o=n?pe.get():0;return de.open(t,r,o).fd}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},ma:function(e){try{return e=pe.getStr(e),de.rmdir(e),0}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},ua:function(e,t){try{return e=pe.getStr(e),pe.doStat(de.stat,e,t)}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},na:function(e,t,r){try{return t=pe.getStr(t),t=pe.calculateAt(e,t),0===r?de.unlink(t):512===r?de.rmdir(t):F("Invalid flags passed to unlinkat"),0}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},w:(e,t,r)=>{e=Ce(e),t=Le(t,"wrapper"),r=Oe.toValue(r);var n=[].slice,o=t.registeredClass,a=o.instancePrototype,s=o.baseClass.instancePrototype,i=o.baseClass.constructor,u=fe(e,(function(){o.baseClass.pureVirtualFunctions.forEach(function(e){if(this[e]===s[e])throw new ye(`Pure virtual function ${e} must be implemented in JavaScript`)}.bind(this)),Object.defineProperty(this,"__parent",{value:a}),this.__construct.apply(this,n.call(arguments))}));return a.__construct=function(){this===a&&Se("Pass correct 'this' to __construct");var e=i.implement.apply(void 0,[this].concat(n.call(arguments)));Ne(e);var t,r,s,u=e.$$;e.notifyOnDestruction(),u.preservePointerOnDelete=!0,Object.defineProperties(this,{$$:{value:u}}),qe(this),t=o,r=u.ptr,s=this,r=$e(t,r),De.hasOwnProperty(r)?Se(`Tried to register registered instance: ${r}`):De[r]=s},a.__destruct=function(){var e,t;this===a&&Se("Pass correct 'this' to __destruct"),Ne(this),e=o,t=this.$$.ptr,t=$e(e,t),De.hasOwnProperty(t)?delete De[t]:Se(`Tried to unregister unregistered instance: ${t}`)},u.prototype=Object.create(a),Object.assign(u.prototype,r),Oe.toHandle(u)},bb:e=>{var t=Ve[e];delete Ve[e];var r=t.rawConstructor,n=t.rawDestructor,o=t.fields,a=o.map((e=>e.getterReturnType)).concat(o.map((e=>e.setterArgumentType)));Qe([e],a,(e=>{var a={};return o.forEach(((t,r)=>{var n=t.fieldName,s=e[r],i=t.getter,u=t.getterContext,l=e[r+o.length],c=t.setter,d=t.setterContext;a[n]={read:e=>s.fromWireType(i(u,e)),write:(e,t)=>{var r=[];c(d,e,l.toWireType(r,t)),Ye(r)}}})),[{name:t.name,fromWireType:e=>{var t={};for(var r in a)t[r]=a[r].read(e);return n(e),t},toWireType:(e,t)=>{for(var o in a)if(!(o in t))throw new TypeError(`Missing field: "${o}"`);var s=r();for(o in a)a[o].write(s,t[o]);return null!==e&&e.push(n,s),s},argPackAdvance:et,readValueFromPointer:Xe,destructorFunction:n}]}))},ab:(e,t,r,n,o)=>{},Ba:(e,t,r,n)=>{Ze(e,{name:t=Ce(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?r:n},argPackAdvance:et,readValueFromPointer:function(e){return this.fromWireType(v[e])},destructorFunction:null})},e:(e,t,r,o,a,s,i,u,l,c,d,h,p)=>{d=Ce(d),s=gt(a,s),u&&(u=gt(i,u)),c&&(c=gt(l,c)),p=gt(h,p);var m=(e=>{if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=48&&t<=57?`_${e}`:e})(d);ot(m,(function(){vt(`Cannot construct ${d} due to unbound types`,[o])})),Qe([e,t,r],o?[o]:[],(function(t){var r,a;t=t[0],a=o?(r=t.registeredClass).instancePrototype:rt.prototype;var i=fe(d,(function(){if(Object.getPrototypeOf(this)!==l)throw new ve("Use 'new' to construct "+d);if(void 0===h.constructor_body)throw new ve(d+" has no accessible constructor");var e=h.constructor_body[arguments.length];if(void 0===e)throw new ve(`Tried to invoke ctor of ${d} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(h.constructor_body).toString()}) parameters instead!`);return e.apply(this,arguments)})),l=Object.create(a,{constructor:{value:i}});i.prototype=l;var h=new at(d,i,l,p,r,s,u,c);h.baseClass&&(void 0===h.baseClass.__derivedClasses&&(h.baseClass.__derivedClasses=[]),h.baseClass.__derivedClasses.push(h));var f=new dt(d,h,!0,!1,!1),g=new dt(d+"*",h,!1,!1,!1),v=new dt(d+" const*",h,!1,!0,!1);return Ge[e]={pointerType:g,constPointerType:v},((e,t,r)=>{n.hasOwnProperty(e)||ze("Replacing nonexistant public symbol"),void 0!==n[e].overloadTable&&void 0!==r?n[e].overloadTable[r]=t:(n[e]=t,n[e].argCount=r)})(m,i),[f,g,v]}))},o:(e,t,r,n,o,a,s,i)=>{var u=_t(r,n);t=Ce(t),t=Et(t),a=gt(o,a),Qe([],[e],(function(e){var n=`${(e=e[0]).name}.${t}`;function o(){vt(`Cannot call ${n} due to unbound types`,u)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]);var i=e.registeredClass.constructor;return void 0===i[t]?(o.argCount=r-1,i[t]=o):(nt(i,t,n),i[t].overloadTable[r-1]=o),Qe([],u,(function(o){var u=[o[0],null].concat(o.slice(1)),l=yt(n,u,null,a,s);if(void 0===i[t].overloadTable?(l.argCount=r-1,i[t]=l):i[t].overloadTable[r-1]=l,e.registeredClass.__derivedClasses)for(const r of e.registeredClass.__derivedClasses)r.constructor.hasOwnProperty(t)||(r.constructor[t]=l);return[]})),[]}))},k:(e,t,r,n,o,a)=>{var s=_t(t,r);o=gt(n,o),Qe([],[e],(function(e){var r=`constructor ${(e=e[0]).name}`;if(void 0===e.registeredClass.constructor_body&&(e.registeredClass.constructor_body=[]),void 0!==e.registeredClass.constructor_body[t-1])throw new ve(`Cannot register multiple constructors with identical number of parameters (${t-1}) for class '${e.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return e.registeredClass.constructor_body[t-1]=()=>{vt(`Cannot construct ${e.name} due to unbound types`,s)},Qe([],s,(n=>(n.splice(1,0,null),e.registeredClass.constructor_body[t-1]=yt(r,n,null,o,a),[]))),[]}))},b:(e,t,r,n,o,a,s,i,u)=>{var l=_t(r,n);t=Ce(t),t=Et(t),a=gt(o,a),Qe([],[e],(function(e){var n=`${(e=e[0]).name}.${t}`;function o(){vt(`Cannot call ${n} due to unbound types`,l)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]),i&&e.registeredClass.pureVirtualFunctions.push(t);var u=e.registeredClass.instancePrototype,c=u[t];return void 0===c||void 0===c.overloadTable&&c.className!==e.name&&c.argCount===r-2?(o.argCount=r-2,o.className=e.name,u[t]=o):(nt(u,t,n),u[t].overloadTable[r-2]=o),Qe([],l,(function(o){var i=yt(n,o,e,a,s);return void 0===u[t].overloadTable?(i.argCount=r-2,u[t]=i):u[t].overloadTable[r-2]=i,[]})),[]}))},a:(e,t,r,n,o,a,s,i,u,l)=>{t=Ce(t),o=gt(n,o),Qe([],[e],(function(e){var n=`${(e=e[0]).name}.${t}`,c={get(){vt(`Cannot access ${n} due to unbound types`,[r,s])},enumerable:!0,configurable:!0};return c.set=u?()=>vt(`Cannot access ${n} due to unbound types`,[r,s]):e=>Se(n+" is a read-only property"),Object.defineProperty(e.registeredClass.instancePrototype,t,c),Qe([],u?[r,s]:[r],(function(r){var s=r[0],c={get(){var t=bt(this,e,n+" getter");return s.fromWireType(o(a,t))},enumerable:!0};if(u){u=gt(i,u);var d=r[1];c.set=function(t){var r=bt(this,e,n+" setter"),o=[];u(l,r,d.toWireType(o,t)),Ye(o)}}return Object.defineProperty(e.registeredClass.instancePrototype,t,c),[]})),[]}))},A:(e,t,r)=>{e=Ce(e),Qe([],[t],(function(t){return t=t[0],n[e]=t.fromWireType(r),[]}))},Aa:(e,t)=>{Ze(e,{name:t=Ce(t),fromWireType:e=>{var t=Oe.toValue(e);return St(e),t},toWireType:(e,t)=>Oe.toHandle(t),argPackAdvance:et,readValueFromPointer:Xe,destructorFunction:null})},E:(e,t,r,n)=>{function o(){}t=Ce(t),o.values={},Ze(e,{name:t,constructor:o,fromWireType:function(e){return this.constructor.values[e]},toWireType:(e,t)=>t.value,argPackAdvance:et,readValueFromPointer:kt(t,r,n),destructorFunction:null}),ot(t,o)},p:(e,t,r)=>{var n=Le(e,"enum");t=Ce(t);var o=n.constructor,a=Object.create(n.constructor.prototype,{value:{value:r},constructor:{value:fe(`${n.name}_${t}`,(function(){}))}});o.values[r]=a,o[t]=a},aa:(e,t,r)=>{Ze(e,{name:t=Ce(t),fromWireType:e=>e,toWireType:(e,t)=>t,argPackAdvance:et,readValueFromPointer:Mt(t,r),destructorFunction:null})},F:(e,t,r,n,o)=>{t=Ce(t);var a=e=>e;if(0===n){var s=32-8*r;a=e=>e<<s>>>s}var i=t.includes("unsigned");Ze(e,{name:t,fromWireType:a,toWireType:i?function(e,t){return this.name,t>>>0}:function(e,t){return this.name,t},argPackAdvance:et,readValueFromPointer:Ct(t,r,0!==n),destructorFunction:null})},x:(e,t,r)=>{var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function o(e){var t=E[e>>2],r=E[e+4>>2];return new n(g.buffer,r,t)}Ze(e,{name:r=Ce(r),fromWireType:o,argPackAdvance:et,readValueFromPointer:o},{ignoreDuplicateRegistrations:!0})},s:(e,t,r,n,o,a,s,i,u,l,c,d)=>{r=Ce(r),a=gt(o,a),i=gt(s,i),l=gt(u,l),d=gt(c,d),Qe([e],[t],(function(e){return e=e[0],[new dt(r,e.registeredClass,!1,!1,!0,e,n,a,i,l,d)]}))},$:(e,t)=>{var r="std::string"===(t=Ce(t));Ze(e,{name:t,fromWireType(e){var t,n=E[e>>2],o=e+4;if(r)for(var a=o,s=0;s<=n;++s){var i=o+s;if(s==n||0==v[i]){var u=he(a,i-a);void 0===t?t=u:(t+=String.fromCharCode(0),t+=u),a=i+1}}else{var l=new Array(n);for(s=0;s<n;++s)l[s]=String.fromCharCode(v[o+s]);t=l.join("")}return br(e),t},toWireType(e,t){var n;t instanceof ArrayBuffer&&(t=new Uint8Array(t));var o="string"==typeof t;o||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||Se("Cannot pass non-string to std::string"),n=r&&o?re(t):t.length;var a=_r(4+n+1),s=a+4;if(E[a>>2]=n,r&&o)me(t,s,n+1);else if(o)for(var i=0;i<n;++i){var u=t.charCodeAt(i);u>255&&(br(s),Se("String has UTF-16 code units that do not fit in 8 bits")),v[s+i]=u}else for(i=0;i<n;++i)v[s+i]=t[i];return null!==e&&e.push(br,a),a},argPackAdvance:et,readValueFromPointer:ct,destructorFunction(e){br(e)}})},R:(e,t,r)=>{var n,o,a,s,i;r=Ce(r),2===t?(n=It,o=Tt,s=At,a=()=>w,i=1):4===t&&(n=Pt,o=Dt,s=$t,a=()=>E,i=2),Ze(e,{name:r,fromWireType:e=>{for(var r,o=E[e>>2],s=a(),u=e+4,l=0;l<=o;++l){var c=e+4+l*t;if(l==o||0==s[c>>i]){var d=n(u,c-u);void 0===r?r=d:(r+=String.fromCharCode(0),r+=d),u=c+t}}return br(e),r},toWireType:(e,n)=>{"string"!=typeof n&&Se(`Cannot pass non-string to C++ string type ${r}`);var a=s(n),u=_r(4+a+t);return E[u>>2]=a>>i,o(n,u+4,a+t),null!==e&&e.push(br,u),u},argPackAdvance:et,readValueFromPointer:Xe,destructorFunction(e){br(e)}})},ia:(e,t,r,n,o,a)=>{Ve[e]={name:Ce(t),rawConstructor:gt(r,n),rawDestructor:gt(o,a),fields:[]}},da:(e,t,r,n,o,a,s,i,u,l)=>{Ve[e].fields.push({fieldName:Ce(t),getterReturnType:r,getter:gt(n,o),getterContext:a,setterArgumentType:s,setter:gt(i,u),setterContext:l})},Ca:(e,t)=>{Ze(e,{isVoid:!0,name:t=Ce(t),argPackAdvance:0,fromWireType:()=>{},toWireType:(e,t)=>{}})},Da:function(e){if(Kt.xhrs.has(e)){var t=Kt.xhrs.get(e);Kt.xhrs.free(e),t.readyState>0&&t.readyState<4&&t.abort()}},xa:()=>!0,Sa:(e,t,r,n)=>(e=Ft[e])(null,t=Oe.toValue(t),r,n),n:(e,t,r,n,o)=>{var a,s;return(e=Ft[e])(t=Oe.toValue(t),t[r=void 0===(s=xt[a=r])?Ce(a):s],n,o)},f:St,l:(e,t,r)=>{var n=((e,t)=>{for(var r=new Array(e),n=0;n<e;++n)r[n]=Le(E[t+4*n>>2],"parameter "+n);return r})(e,t),o=n.shift();e--;var a=new Array(e),s=`methodCaller<(${n.map((e=>e.name)).join(", ")}) => ${o.name}>`;return(e=>{var t=Ft.length;return Ft.push(e),t})(fe(s,((t,s,i,u)=>{for(var l=0,c=0;c<e;++c)a[c]=n[c].readValueFromPointer(u+l),l+=n[c].argPackAdvance;var d=1===r?Lt(s,a):s.apply(t,a);for(c=0;c<e;++c)n[c].deleteObject&&n[c].deleteObject(a[c]);return((e,t,r)=>{var n=[],o=e.toWireType(n,r);return n.length&&(E[t>>2]=Oe.toHandle(n)),o})(o,i,d)})))},P:e=>{e>4&&(be.get(e).refcount+=1)},m:e=>{var t=Oe.toValue(e);Ye(t),St(e)},J:(e,t)=>{var r=(e=Le(e,"_emval_take_value")).readValueFromPointer(t);return Oe.toHandle(r)},Ya:function(e,t,r){var n=Nt(e,t),o=new Date(1e3*n);_[r>>2]=o.getUTCSeconds(),_[r+4>>2]=o.getUTCMinutes(),_[r+8>>2]=o.getUTCHours(),_[r+12>>2]=o.getUTCDate(),_[r+16>>2]=o.getUTCMonth(),_[r+20>>2]=o.getUTCFullYear()-1900,_[r+24>>2]=o.getUTCDay();var a=Date.UTC(o.getUTCFullYear(),0,1,0,0,0,0),s=(o.getTime()-a)/864e5|0;_[r+28>>2]=s},Za:function(e,t,r){var n=Nt(e,t),o=new Date(1e3*n);_[r>>2]=o.getSeconds(),_[r+4>>2]=o.getMinutes(),_[r+8>>2]=o.getHours(),_[r+12>>2]=o.getDate(),_[r+16>>2]=o.getMonth(),_[r+20>>2]=o.getFullYear()-1900,_[r+24>>2]=o.getDay();var a=0|Gt(o);_[r+28>>2]=a,_[r+36>>2]=-60*o.getTimezoneOffset();var s=new Date(o.getFullYear(),0,1),i=new Date(o.getFullYear(),6,1).getTimezoneOffset(),u=s.getTimezoneOffset(),l=0|(i!=u&&o.getTimezoneOffset()==Math.min(u,i));_[r+32>>2]=l},_a:function(e){var t=(()=>{var t=new Date(_[e+20>>2]+1900,_[e+16>>2],_[e+12>>2],_[e+8>>2],_[e+4>>2],_[e>>2],0),r=_[e+32>>2],n=t.getTimezoneOffset(),o=new Date(t.getFullYear(),0,1),a=new Date(t.getFullYear(),6,1).getTimezoneOffset(),s=o.getTimezoneOffset(),i=Math.min(s,a);if(r<0)_[e+32>>2]=Number(a!=s&&i==n);else if(r>0!=(i==n)){var u=Math.max(s,a),l=r>0?i:u;t.setTime(t.getTime()+6e4*(l-n))}_[e+24>>2]=t.getDay();var c=0|Gt(t);return _[e+28>>2]=c,_[e>>2]=t.getSeconds(),_[e+4>>2]=t.getMinutes(),_[e+8>>2]=t.getHours(),_[e+12>>2]=t.getDate(),_[e+16>>2]=t.getMonth(),_[e+20>>2]=t.getYear(),t.getTime()/1e3})();return Cr((N=t,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)),t>>>0},Xa:function(e,t,r,n,o,a,s){var i=Nt(a,s);try{if(isNaN(i))return 61;var u=pe.getStreamFromFD(o);2&r&&pe.doMsync(e,u,t,n,i),de.munmap(u)}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return-e.errno}},la:(e,t,r)=>{var n=(new Date).getFullYear(),o=new Date(n,0,1),a=new Date(n,6,1),s=o.getTimezoneOffset(),i=a.getTimezoneOffset(),u=Math.max(s,i);function l(e){var t=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return t?t[1]:"GMT"}E[e>>2]=60*u,_[t>>2]=Number(s!=i);var c=l(o),d=l(a),h=zt(c),p=zt(d);i<s?(E[r>>2]=h,E[r+4>>2]=p):(E[r>>2]=p,E[r+4>>2]=h)},O:()=>{F("")},Ka:e=>{clearInterval(e)},Ma:e=>clearTimeout(e),Q:()=>Date.now(),M:wt,Oa:(e,t,r,n,o)=>{Xt.existsFile(he(e),he(t),((e,t)=>{Yt((()=>{e?o&&mt(o)(r):n&&mt(n)(r,t)}))}))},Pa:(e,t,r,n,o)=>{Xt.getFile(he(e),he(t),((e,t)=>{Yt((()=>{if(e)o&&mt(o)(r);else{var a=_r(t.length);v.set(t,a),mt(n)(r,a,t.length),br(a)}}))}))},Qa:(e,t,r,n,o,a,s)=>{Xt.setFile(he(e),he(t),new Uint8Array(v.subarray(r,r+n)),(e=>{Yt((()=>{e?s&&mt(s)(o):a&&mt(a)(o)}))}))},Fa:()=>!0,ya:(e,t,r)=>v.copyWithin(e,t,t+r),ka:e=>{var t=v.length,r=268435456;if((e>>>=0)>r)return!1;for(var n,o,a=1;a<=4;a*=2){var s=t*(1+.2/a);s=Math.min(s,e+100663296);var i=Math.min(r,(n=Math.max(e,s))+((o=65536)-n%o)%o);if(Jt(i))return!0}return!1},La:(e,t,r)=>setInterval((()=>{Yt((()=>mt(e)(r)))}),t),Na:(e,t,r)=>{return n=()=>mt(e)(r),setTimeout((()=>{Yt(n)}),t);var n},Ea:function(e,t,r,n,o){var a=e+112,s=E[a+36>>2],i=E[a+40>>2];E[a+44>>2],E[a+48>>2];var u=E[a+52>>2],l=!!(64&u);function c(e){l?e():Yt(e)}var d=(e,r,n)=>{c((()=>{s?mt(s)(e):t&&t(e)}))},h=(e,t,n)=>{c((()=>{i?mt(i)(e):r&&r(e)}))},p=(e,r,n)=>{er(Kt.dbInstance,e,r.response,((e,r,n)=>{c((()=>{s?mt(s)(e):t&&t(e)}))}),((e,r,n)=>{c((()=>{s?mt(s)(e):t&&t(e)}))}))},m=he(a+0),f=!!(16&u),g=!!(4&u),y=!!(32&u);if("EM_IDB_STORE"===m){var _=E[a+84>>2],b=E[a+88>>2];er(Kt.dbInstance,e,v.slice(_,_+b),d,h)}else if("EM_IDB_DELETE"===m)!function(e,t,r,n){if(e){var o=E[t+112+64>>2];o||(o=E[t+8>>2]);var a=he(o);try{var s=e.transaction(["FILES"],"readwrite").objectStore("FILES").delete(a);s.onsuccess=e=>{var n=e.target.result;E[t+12>>2]=0,Zt(t+16,0),Zt(t+24,0),Zt(t+32,0),w[t+40>>1]=4,w[t+42>>1]=200,me("OK",t+44,64),r(t,0,n)},s.onerror=e=>{w[t+40>>1]=4,w[t+42>>1]=404,me("Not Found",t+44,64),n(t,0,e)}}catch(e){n(t,0,e)}}else n(t,0,"IndexedDB not available!")}(Kt.dbInstance,e,d,h);else if(f){if(y)return 0;Qt(e,g?p:d,h)}else!function(e,t,r,n){if(e){var o=E[t+112+64>>2];o||(o=E[t+8>>2]);var a=he(o);try{var s=e.transaction(["FILES"],"readonly").objectStore("FILES").get(a);s.onsuccess=e=>{if(e.target.result){var o=e.target.result,a=o.byteLength||o.length,s=_r(a);v.set(new Uint8Array(o),s),E[t+12>>2]=s,Zt(t+16,a),Zt(t+24,0),Zt(t+32,a),w[t+40>>1]=4,w[t+42>>1]=200,me("OK",t+44,64),r(t,0,o)}else w[t+40>>1]=4,w[t+42>>1]=404,me("Not Found",t+44,64),n(t,0,"no data")},s.onerror=e=>{w[t+40>>1]=4,w[t+42>>1]=404,me("Not Found",t+44,64),n(t,0,e)}}catch(e){n(t,0,e)}}else n(t,0,"IndexedDB not available!")}(Kt.dbInstance,e,d,y?h:g?(e,t,r)=>{Qt(e,p,h)}:(e,t,r)=>{Qt(e,d,h)});return e},qa:(e,t)=>{var r=0;return rr().forEach(((n,o)=>{var a=t+r;E[e+4*o>>2]=a,((e,t)=>{for(var r=0;r<e.length;++r)g[t++>>0]=e.charCodeAt(r);g[t>>0]=0})(n,a),r+=n.length+1})),0},ra:(e,t)=>{var r=rr();E[e>>2]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),E[t>>2]=n,0},N:function(e){try{var t=pe.getStreamFromFD(e);return de.close(t),0}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return e.errno}},X:function(e,t,r,n){try{var o=((e,t,r,n)=>{for(var o=0,a=0;a<r;a++){var s=E[t>>2],i=E[t+4>>2];t+=8;var u=de.read(e,g,s,i,n);if(u<0)return-1;if(o+=u,u<i)break;void 0!==n&&(n+=u)}return o})(pe.getStreamFromFD(e),t,r);return E[n>>2]=o,0}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return e.errno}},$a:function(e,t,r,n,o){var a=Nt(t,r);try{if(isNaN(a))return 61;var s=pe.getStreamFromFD(e);return de.llseek(s,a,n),j=[s.position>>>0,(N=s.position,+Math.abs(N)>=1?N>0?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],_[o>>2]=j[0],_[o+4>>2]=j[1],s.getdents&&0===a&&0===n&&(s.getdents=null),0}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return e.errno}},Y:function(e,t,r,n){try{var o=((e,t,r,n)=>{for(var o=0,a=0;a<r;a++){var s=E[t>>2],i=E[t+4>>2];t+=8;var u=de.write(e,g,s,i,n);if(u<0)return-1;o+=u,void 0!==n&&(n+=u)}return o})(pe.getStreamFromFD(e),t,r);return E[n>>2]=o,0}catch(e){if(void 0===de||"ErrnoError"!==e.name)throw e;return e.errno}},Ra:function(){if("undefined"!=typeof wx){const e={os:"wx"};if(wx.getSystemInfoSync){const t=wx.getSystemInfoSync();if(t&&(t.version&&(e.osv=t.version),t.platform&&(e.tt=t.platform),t.model&&(e.dm=t.model),t.brand&&(e.db=t.brand)),wx.getAccountInfoSync){const r=wx.getAccountInfoSync();r&&(r.appId&&(e.appid=r.appId),r.envVersion&&(e.appname=t.envVersion),r.version&&(e.appver=t.version))}wx.getNetworkType&&wx.getNetworkType({success:t=>{e.nt=t.networkType}})}return nr(JSON.stringify(e))}const e={os:"web"};let t="";globalThis&&globalThis.navigator&&(t=globalThis.navigator.userAgent);let r="",n="";try{/Windows NT (\d+\.\d+)/i.test(t)?(n="Windows",r=t.match(/Windows NT (\d+\.\d+)/i)[1]):/Mac OS X (\d+[\.\_]\d+[\.\_]\d+)/i.test(t)?(n="macOS",r=t.match(/Mac OS X (\d+[\.\_]\d+[\.\_]\d+)/i)[1].replace(/_/g,".")):/Mac OS X (\d+[\.\_]\d+)/i.test(t)?(n="macOS",r=t.match(/Mac OS X (\d+[\.\_]\d+)/i)[1].replace(/_/g,".")):/Android (\d+\.\d+)/i.test(t)?(n="Android",r=t.match(/Android (\d+\.\d+)/i)[1]):/iPhone OS (\d+_\d+)/i.test(t)?(n="iOS",r=t.match(/iPhone OS (\d+_\d+)/i)[1].replace(/_/g,".")):/iPad.*OS (\d+_\d+)/i.test(t)&&(n="iOS",r=t.match(/iPad.*OS (\d+_\d+)/i)[1].replace(/_/g,"."))}catch(e){}e.tt=n,e.osv=r;let o="",a="";const s=[[/(opera|opr)[\/\s](\d+(\.\d+)?)/i,"Opera"],[/(edge|edg)[\/\s](\d+(\.\d+)?)/i,"Edge"],[/(chrome)[\/\s](\d+(\.\d+)?)/i,"Chrome"],[/(safari)[\/\s](\d+(\.\d+)?)/i,"Safari"],[/(firefox)[\/\s](\d+(\.\d+)?)/i,"Firefox"],[/(msie|trident)[\/\s]?(\d+(\.\d+)?)/i,"Internet Explorer"]];for(let e=0;e<s.length;e++){const r=t.match(s[e][0]);if(r){a=s[e][1],o=r[2];break}}e.db=a,e.dm=o;const i=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return i&&(e.nt=i.effectiveType||""),nr(JSON.stringify(e))},ga:(e,t)=>(K(v.subarray(e,e+t)),0),S:function(e,t,r,n){var o=Rr();try{return mt(e)(t,r,n)}catch(e){if(Ir(o),e!==e+0)throw e;Mr(1,0)}},T:function(e,t,r,n){var o=Rr();try{return mt(e)(t,r,n)}catch(e){if(Ir(o),e!==e+0)throw e;Mr(1,0)}},u:function(e){var t=Rr();try{return mt(e)()}catch(e){if(Ir(t),e!==e+0)throw e;Mr(1,0)}},d:function(e,t){var r=Rr();try{return mt(e)(t)}catch(e){if(Ir(r),e!==e+0)throw e;Mr(1,0)}},i:function(e,t,r){var n=Rr();try{return mt(e)(t,r)}catch(e){if(Ir(n),e!==e+0)throw e;Mr(1,0)}},v:function(e,t,r,n){var o=Rr();try{return mt(e)(t,r,n)}catch(e){if(Ir(o),e!==e+0)throw e;Mr(1,0)}},t:function(e,t,r,n,o){var a=Rr();try{return mt(e)(t,r,n,o)}catch(e){if(Ir(a),e!==e+0)throw e;Mr(1,0)}},I:function(e,t,r,n,o,a){var s=Rr();try{return mt(e)(t,r,n,o,a)}catch(e){if(Ir(s),e!==e+0)throw e;Mr(1,0)}},G:function(e,t,r,n,o,a,s){var i=Rr();try{return mt(e)(t,r,n,o,a,s)}catch(e){if(Ir(i),e!==e+0)throw e;Mr(1,0)}},U:function(e,t,r,n,o,a,s,i){var u=Rr();try{return mt(e)(t,r,n,o,a,s,i)}catch(e){if(Ir(u),e!==e+0)throw e;Mr(1,0)}},L:function(e,t,r,n,o,a,s,i,u,l,c,d){var h=Rr();try{return mt(e)(t,r,n,o,a,s,i,u,l,c,d)}catch(e){if(Ir(h),e!==e+0)throw e;Mr(1,0)}},Ua:function(e,t,r,n,o,a,s){var i=Rr();try{return Nr(e,t,r,n,o,a,s)}catch(e){if(Ir(i),e!==e+0)throw e;Mr(1,0)}},Wa:function(e){var t=Rr();try{return xr(e)}catch(e){if(Ir(t),e!==e+0)throw e;Mr(1,0)}},Ta:function(e,t,r,n,o){var a=Rr();try{return jr(e,t,r,n,o)}catch(e){if(Ir(a),e!==e+0)throw e;Mr(1,0)}},r:function(e){var t=Rr();try{mt(e)()}catch(e){if(Ir(t),e!==e+0)throw e;Mr(1,0)}},z:function(e,t){var r=Rr();try{mt(e)(t)}catch(e){if(Ir(r),e!==e+0)throw e;Mr(1,0)}},g:function(e,t,r){var n=Rr();try{mt(e)(t,r)}catch(e){if(Ir(n),e!==e+0)throw e;Mr(1,0)}},ea:function(e,t,r,n){var o=Rr();try{mt(e)(t,r,n)}catch(e){if(Ir(o),e!==e+0)throw e;Mr(1,0)}},fa:function(e,t,r,n){var o=Rr();try{mt(e)(t,r,n)}catch(e){if(Ir(o),e!==e+0)throw e;Mr(1,0)}},B:function(e,t,r,n){var o=Rr();try{mt(e)(t,r,n)}catch(e){if(Ir(o),e!==e+0)throw e;Mr(1,0)}},V:function(e,t,r,n,o){var a=Rr();try{mt(e)(t,r,n,o)}catch(e){if(Ir(a),e!==e+0)throw e;Mr(1,0)}},D:function(e,t,r,n,o,a,s,i){var u=Rr();try{mt(e)(t,r,n,o,a,s,i)}catch(e){if(Ir(u),e!==e+0)throw e;Mr(1,0)}},H:function(e,t,r,n,o,a,s,i,u,l,c){var d=Rr();try{mt(e)(t,r,n,o,a,s,i,u,l,c)}catch(e){if(Ir(d),e!==e+0)throw e;Mr(1,0)}},K:function(e,t,r,n,o,a,s,i,u,l,c,d,h,p,m,f){var g=Rr();try{mt(e)(t,r,n,o,a,s,i,u,l,c,d,h,p,m,f)}catch(e){if(Ir(g),e!==e+0)throw e;Mr(1,0)}},Va:function(e,t,r,n,o,a,s){var i=Rr();try{Lr(e,t,r,n,o,a,s)}catch(e){if(Ir(i),e!==e+0)throw e;Mr(1,0)}},Ja:function(e,t,r,o,a,s){var i=he(t),u=v.subarray(a,a+s);n.sendData&&n.sendData(e,i,r,o,u)},Ha:function(e,t){var r=he(e),o=he(t);n.subscribe&&n.subscribe(r,o)},Ga:function(e,t){var r=he(e),o=he(t);n.unSubscribe&&n.unSubscribe(r,o)},Ia:function(e,t,r){var o=he(t),a=he(r);n.sendData&&n.sendData(e,o,0,!1,a)},ha:(e,t,r,n,o)=>ur(e,t,r,n),ca:e=>{var t=null;if(void 0!==window.crypto&&void 0!==window.crypto.getRandomValues&&(t=new Uint8Array(16),window.crypto.getRandomValues(t)),!t){t=new Array(16);for(var r=(new Date).getTime(),n=0;n<16;n++){var o=(r+256*Math.random())%256|0;r=r/256|0,t[n]=o}}t[6]=15&t[6]|64,t[8]=63&t[8]|128,ir(t,e)},ba:(e,t,r)=>{var n=0,o="xxxx-xx-xx-xx-xxxxxx".replace(/[x]/g,(function(t){var o=r?v[e+n>>0].toString(16).toUpperCase():v[e+n>>0].toString(16);return o=1===o.length?"0"+o:o,n++,o}));me(o,t,37)}},wr=function(){var e,t,o,a,s={a:yr};function i(e,t){var r;return wr=e.exports,h=wr.cb,M(),ht=wr.eb,r=wr.db,R.unshift(r),$(),wr}if(D(),n.instantiateWasm)try{return n.instantiateWasm(s,i)}catch(e){m(`Module.instantiateWasm callback failed with error: ${e}`),r(e)}return(e=d,t=x,o=s,a=function(e){i(e.instance)},e||"function"!=typeof WebAssembly.instantiateStreaming||W(t)||"function"!=typeof fetch?U(t,o,a):fetch(t,{credentials:"same-origin"}).then((e=>WebAssembly.instantiateStreaming(e,o).then(a,(function(e){return m(`wasm streaming compile failed: ${e}`),m("falling back to ArrayBuffer instantiation"),U(t,o,a)}))))).catch(r),{}}(),_r=n._malloc=e=>(_r=n._malloc=wr.fb)(e),Er=n._main=(e,t)=>(Er=n._main=wr.gb)(e,t),br=n._free=e=>(br=n._free=wr.hb)(e),Sr=()=>(Sr=wr.ib)(),kr=e=>(kr=wr.jb)(e),Or=(e,t)=>(Or=wr.kb)(e,t),Mr=(e,t)=>(Mr=wr.lb)(e,t),Cr=e=>(Cr=wr.mb)(e),Rr=()=>(Rr=wr.nb)(),Ir=e=>(Ir=wr.ob)(e),Tr=e=>(Tr=wr.pb)(e),Ar=e=>(Ar=wr.qb)(e),Pr=e=>(Pr=wr.rb)(e),Dr=(e,t,r)=>(Dr=wr.sb)(e,t,r),$r=e=>($r=wr.tb)(e);n.dynCall_iiijii=(e,t,r,o,a,s,i)=>(n.dynCall_iiijii=wr.ub)(e,t,r,o,a,s,i),n.dynCall_viij=(e,t,r,o,a)=>(n.dynCall_viij=wr.vb)(e,t,r,o,a),n.dynCall_jii=(e,t,r)=>(n.dynCall_jii=wr.wb)(e,t,r),n.dynCall_iiiiijiiii=(e,t,r,o,a,s,i,u,l,c,d)=>(n.dynCall_iiiiijiiii=wr.xb)(e,t,r,o,a,s,i,u,l,c,d),n.dynCall_iiiiji=(e,t,r,o,a,s,i)=>(n.dynCall_iiiiji=wr.yb)(e,t,r,o,a,s,i),n.dynCall_iiiijii=(e,t,r,o,a,s,i,u)=>(n.dynCall_iiiijii=wr.zb)(e,t,r,o,a,s,i,u),n.dynCall_iiiiiiijji=(e,t,r,o,a,s,i,u,l,c,d,h)=>(n.dynCall_iiiiiiijji=wr.Ab)(e,t,r,o,a,s,i,u,l,c,d,h),n.dynCall_jiiiiiii=(e,t,r,o,a,s,i,u)=>(n.dynCall_jiiiiiii=wr.Bb)(e,t,r,o,a,s,i,u),n.dynCall_viiiij=(e,t,r,o,a,s,i)=>(n.dynCall_viiiij=wr.Cb)(e,t,r,o,a,s,i),n.dynCall_viiji=(e,t,r,o,a,s)=>(n.dynCall_viiji=wr.Db)(e,t,r,o,a,s),n.dynCall_jiii=(e,t,r,o)=>(n.dynCall_jiii=wr.Eb)(e,t,r,o),n.dynCall_vij=(e,t,r,o)=>(n.dynCall_vij=wr.Fb)(e,t,r,o),n.dynCall_ji=(e,t)=>(n.dynCall_ji=wr.Gb)(e,t),n.dynCall_jiji=(e,t,r,o,a)=>(n.dynCall_jiji=wr.Hb)(e,t,r,o,a);var Fr,xr=n.dynCall_j=e=>(xr=n.dynCall_j=wr.Ib)(e),Lr=n.dynCall_viijii=(e,t,r,o,a,s,i)=>(Lr=n.dynCall_viijii=wr.Jb)(e,t,r,o,a,s,i),Nr=n.dynCall_iiiiij=(e,t,r,o,a,s,i)=>(Nr=n.dynCall_iiiiij=wr.Kb)(e,t,r,o,a,s,i),jr=n.dynCall_jiiii=(e,t,r,o,a)=>(jr=n.dynCall_jiiii=wr.Lb)(e,t,r,o,a);function Wr(){function e(){Fr||(Fr=!0,n.calledRun=!0,k||(n.noFSInit||de.init.initialized||de.init(),de.ignorePermissions=!1,z(R),z(I),t(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),Ur&&function(){var e=Er;try{var t=e(0,0);return qt(t,!0),t}catch(e){return Bt(e)}}(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),T.unshift(e);var e;z(T)}()))}A>0||(function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),C.unshift(e);var e;z(C)}(),A>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),e()}),1)):e()))}if(n.dynCall_iiiiijj=(e,t,r,o,a,s,i,u,l)=>(n.dynCall_iiiiijj=wr.Mb)(e,t,r,o,a,s,i,u,l),n.dynCall_iiiiiijj=(e,t,r,o,a,s,i,u,l,c)=>(n.dynCall_iiiiiijj=wr.Nb)(e,t,r,o,a,s,i,u,l,c),n.ccall=(e,t,r,o,a)=>{var s={string:e=>{var t=0;return null!=e&&0!==e&&(t=(e=>{var t=re(e)+1,r=Tr(t);return me(e,r,t),r})(e)),t},array:e=>{var t=Tr(e.length);return ir(e,t),t}},i=(e=>n["_"+e])(e),u=[],l=0;if(o)for(var c=0;c<o.length;c++){var d=s[r[c]];d?(0===l&&(l=Rr()),u[c]=d(o[c])):u[c]=o[c]}var h,p=i.apply(null,u);return h=p,0!==l&&Ir(l),p=function(e){return"string"===t?he(e):"boolean"===t?Boolean(e):e}(h),p},n.addFunction=(e,t)=>{var r=hr(e);if(r)return r;var n=(()=>{if(pr.length)return pr.pop();try{ht.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return ht.length-1})();try{mr(n,e)}catch(r){if(!(r instanceof TypeError))throw r;var o=dr(e,t);mr(n,o)}return or.set(e,n),n},n.removeFunction=e=>{or.delete(mt(e)),mr(e,null),pr.push(e)},n.UTF8ToString=he,n.allocate=(e,t)=>{var r;return r=1==t?Tr(e.length):_r(e.length),e.subarray||e.slice||(e=new Uint8Array(e)),v.set(e,r),r},n.allocateUTF8=lr,P=function e(){Fr||Wr(),Fr||(P=e)},n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();var Ur=!0;return n.noInitialRun&&(Ur=!1),Wr(),n.wasmOnReceiveData=function(e,t){if(t instanceof Uint8Array){var r=_r(t.length);v.set(t,r),n.TransportDataHandler.OnReceiveData(e,r,t.length)}else n.TransportDataHandler.OnReceiveMessage(e,t)},n.wasmOnConnectResult=function(e,t){n.TransportDataHandler.OnConnectResult(e,t)},n.wasmOnConnectionLostEvent=function(e){n.TransportDataHandler.OnConnectionLostEvent(e)},n.wasmOnIpSwitchEvent=function(e,t){n.TransportDataHandler.OnIpSwitchEvent(e,t)},n.wasmOnConnectionEvent=function(e){n.TransportDataHandler.OnConnectionEvent(e)},n.wasmOnReceiveData=function(e,t){if(t instanceof Uint8Array){var r=_r(t.length);v.set(t,r),n.TransportDataHandler.OnReceiveData(e,r,t.length)}else n.TransportDataHandler.OnReceiveMessage(e,t)},n.wasmOnConnectResult=function(e,t){n.TransportDataHandler.OnConnectResult(e,t)},n.wasmOnConnectionLostEvent=function(e){n.TransportDataHandler.OnConnectionLostEvent(e)},n.wasmOnIpSwitchEvent=function(e,t){n.TransportDataHandler.OnIpSwitchEvent(e,t)},n.wasmOnConnectionEvent=function(e){n.TransportDataHandler.OnConnectionEvent(e)},e.ready}),l=(e=>(e[e.ASC=0]="ASC",e[e.DESC=1]="DESC",e))(l||{});const c=e=>{const t=[];for(var r=0;r<e.size();r++)t.push(e.get(r));return t},d=e=>{const t={},r=e.keys();for(var n=0;n<r.size();n++){const o=r.get(n);t[o]=e.get(o)}return t},h=(e,t)=>{const r=t.values[e];if(r)return r},p={groupId:"",type:0,nextpagetoken:0,sortType:l.ASC,pageSize:10},m={groupId:"",seqnum:0,pageSize:50};var f=(e=>(e[e.NORMAL=0]="NORMAL",e[e.HIGH=1]="HIGH",e))(f||{});const g={userId:"",userNick:"",userAvatar:"",userExtension:""},v=e=>({userId:e.user_id,userNick:e.user_nick,userAvatar:e.user_avatar,userExtension:e.user_extension}),y=e=>{const t=[];for(var r=0;r<e.size();r++)t.push(v(e.get(r)));return t};f.NORMAL;const w=e=>{return{groupId:e.group_id,messageId:e.message_id,type:e.type,sender:e.sender?v(e.sender):void 0,data:e.data,seqnum:+e.getSeqNum(),timestamp:+e.getTimestamp(),level:(t=e.level,r=f.NORMAL,t?.value||r)};var t,r},_={groupId:"",type:0,data:"",skipMuteCheck:!1,skipAudit:!1,level:f.NORMAL},E={type:0,data:"",receiverId:"",skipAudit:!1,level:f.NORMAL};var b=Object.defineProperty,S=(e,t,r)=>(((e,t,r)=>{t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class k extends Error{constructor(e,t){super(e),S(this,"code",0),S(this,"msg",""),t&&(this.code=t),this.msg=e}static fromWASMError(e){const t=e.code,r=e.msg;return new k(r,t)}get name(){return"IMError"}get message(){return this.msg}}var O=Object.defineProperty,M=(e,t,r)=>(((e,t,r)=>{t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class C extends i{constructor(e,t){super(),M(this,"wasmIns"),M(this,"wasmMessageManager"),M(this,"messageListener"),this.wasmIns=e,this.wasmMessageManager=t.GetMessageManager()}addMessageListener(){this.messageListener=this.wasmIns.ImMessageListenerWrapper.implement({OnRecvC2cMessage:e=>{this.emit("recvc2cmessage",w(e))},OnRecvGroupMessage:(e,t)=>{this.emit("recvgroupmessage",w(e),t)}}),this.wasmMessageManager.AddMessageListener(this.messageListener)}removeMessageListener(){this.messageListener&&(this.wasmMessageManager.RemoveMessageListener(this.messageListener),this.messageListener.delete(),this.messageListener=null)}async sendC2cMessage(e){const t=((e,t)=>{const r=new e.ImSendMessageToUserReq,n={...E,...t};if(r.type=n.type,r.data=n.data,r.receiver_id=n.receiverId,r.skip_audit=n.skipAudit,n.level||0===n.level){const t=e.ImMessageLevel.values[n.level];t&&(r.level=t)}return r})(this.wasmIns,e);return new Promise(((e,r)=>{const n=this.wasmIns.ImSendMessageToUserRspCallbackWrapper.implement({OnSuccess(t){e(t.message_id)},OnFailure(e){r(k.fromWASMError(e))}});this.wasmMessageManager.SendC2cMessage(t,n),n.delete()}))}async sendGroupMessage(e){const t=((e,t)=>{const r=new e.ImSendMessageToGroupReq,n={..._,...t};if(r.type=n.type,r.data=n.data,r.group_id=n.groupId,r.skip_mute_check=n.skipMuteCheck,r.skip_audit=n.skipAudit,n.level||0===n.level){const t=e.ImMessageLevel.values[n.level];t&&(r.level=t)}return r})(this.wasmIns,e);return new Promise(((e,r)=>{const n=this.wasmIns.ImSendMessageToGroupRspCallbackWrapper.implement({OnSuccess(t){e(t.message_id)},OnFailure(e){r(k.fromWASMError(e))}});this.wasmMessageManager.SendGroupMessage(t,n),n.delete()}))}async listMessage(e){const t=((e,t)=>{const r=new e.ImListMessageReq,n={...p,...t};return r.group_id=n.groupId,r.type=n.type,(n.nextpagetoken||0===n.nextpagetoken)&&r.setNextPageToken(n.nextpagetoken.toString()),(n.sortType||0===n.sortType)&&(r.sorttype=h(n.sortType,e.ImSortType)),r.page_size=n.pageSize,r})(this.wasmIns,e);return new Promise(((e,r)=>{const n=this.wasmIns.ImListMessageRspCallbackWrapper.implement({OnSuccess(t){e((e=>{const t=[];for(var r=0;r<e.message_list.size();r++)t.push(w(e.message_list.get(r)));return{groupId:e.group_id,nextpagetoken:+e.getNextPageToken(),hasMore:e.hasmore,messageList:t}})(t))},OnFailure(e){r(k.fromWASMError(e))}});this.wasmMessageManager.ListMessage(t,n),n.delete()}))}listRecentMessage(e){const t=((e,t)=>{const r=new e.ImListRecentMessageReq,n={...m,...t};return r.group_id=n.groupId,r.seqnum=n.seqnum,r.page_size=n.pageSize,r})(this.wasmIns,e);return new Promise(((e,r)=>{const n=this.wasmIns.ImListRecentMessageRspCallbackWrapper.implement({OnSuccess(t){e((e=>{const t=[];for(var r=0;r<e.message_list.size();r++)t.push(w(e.message_list.get(r)));return{groupId:e.group_id,messageList:t}})(t))},OnFailure(e){r(k.fromWASMError(e))}});this.wasmMessageManager.ListRecentMessage(t,n),n.delete()}))}}const R={groupId:"",groupName:"",groupMeta:""},I={groupId:"",groupMeta:"",admins:[]},T={groupId:"",sortType:l.ASC,nextpagetoken:0,pageSize:30},A=e=>({groupId:e.group_id,muteAll:e.mute_all,muteUserList:c(e.mute_user_list),whiteUserList:c(e.white_user_list)}),P=e=>({pv:e.pv,onlineCount:e.online_count,msgAmount:d(e.msg_amount)}),D=e=>({groupId:e.group_id,groupName:e.group_name,groupMeta:e.group_meta,createTime:+e.getCreateTime(),creator:e.creator,admins:e.admins?c(e.admins):[],statistics:P(e.statistics),muteStatus:A(e.mute_status)});var $=Object.defineProperty,F=(e,t,r)=>(((e,t,r)=>{t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class x extends i{constructor(e,t){super(),F(this,"wasmIns"),F(this,"wasmGroupManager"),F(this,"groupListener"),this.wasmIns=e,this.wasmGroupManager=t.GetGroupManager()}addGroupListener(){this.groupListener=this.wasmIns.ImGroupListenerWrapper.implement({OnMemberChange:(e,t,r,n)=>{this.emit("memberchange",e,t,y(r),y(n))},OnExit:(e,t)=>{this.emit("exit",e,t)},OnMuteChange:(e,t)=>{this.emit("mutechange",e,A(t))},OnInfoChange:(e,t)=>{var r;this.emit("infochange",e,{groupId:(r=t).group_id,groupMeta:r.group_meta,adminList:r.admin_list?c(r.admin_list):[]})}}),this.wasmGroupManager.AddGroupListener(this.groupListener)}removeGroupListener(){this.groupListener&&(this.wasmGroupManager.RemoveGroupListener(this.groupListener),this.groupListener.delete(),this.groupListener=null)}async createGroup(e){const t=((e,t)=>{const r=new e.ImCreateGroupReq,n={...R,...t};return r.group_id=n.groupId,r.group_name=n.groupName,r.group_meta=n.groupMeta,r})(this.wasmIns,e);return new Promise(((e,r)=>{const n=this.wasmIns.ImCreateGroupRspCallbackWrapper.implement({OnSuccess(t){var r;e({groupId:(r=t).group_id,alreadyExist:r.already_exist})},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.CreateGroup(t,n),n.delete()}))}async queryGroup(e){const t=new this.wasmIns.ImQueryGroupReq(e);return new Promise(((e,r)=>{const n=this.wasmIns.ImQueryGroupRspCallbackWrapper.implement({OnSuccess(t){e(D(t.group_info))},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.QueryGroup(t,n),n.delete()}))}async closeGroup(e){const t=new this.wasmIns.ImCloseGroupReq(e);return new Promise(((e,r)=>{const n=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(t){e(t)},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.CloseGroup(t,n),n.delete()}))}async joinGroup(e){const t=new this.wasmIns.ImJoinGroupReq(e);return new Promise(((e,r)=>{const n=this.wasmIns.ImJoinGroupRspCallbackWrapper.implement({OnSuccess(t){e(D(t.group_info))},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.JoinGroup(t,n),n.delete()}))}async leaveGroup(e){const t=new this.wasmIns.ImLeaveGroupReq(e);return new Promise(((e,r)=>{const n=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.LeaveGroup(t,n),n.delete()}))}async modifyGroup(e){const t=((e,t)=>{const r=new e.ImModifyGroupReq,n={...I,...t};r.group_id=n.groupId,r.group_meta=n.groupMeta;const o=new e.VectorString;return n.admins&&n.admins.forEach((e=>{o.push_back(e)})),r.admins=o,r})(this.wasmIns,e);return new Promise(((e,r)=>{const n=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.ModifyGroup(t,n),n.delete()}))}async listRecentGroupUser(e){var t=new this.wasmIns.ImListRecentGroupUserReq(e);return new Promise(((e,r)=>{const n=this.wasmIns.ImListRecentGroupUserRspCallbackWrapper.implement({OnSuccess(t){e((e=>{const t=[];for(var r=0;r<e.user_list.size();r++)t.push(v(e.user_list.get(r)));return{groupId:e.group_id,total:e.total,userList:t}})(t))},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.ListRecentGroupUser(t,n),n.delete()}))}async listGroupUser(e){const t=((e,t)=>{const r=new e.ImListGroupUserReq,n={...T,...t};return r.group_id=n.groupId,(n.nextpagetoken||0===n.nextpagetoken)&&r.setNextPageToken(n.nextpagetoken.toString()),(n.sortType||0===n.sortType)&&(r.sorttype=h(n.sortType,e.ImSortType)),r.page_size=n.pageSize,r})(this.wasmIns,e);return new Promise(((e,r)=>{const n=this.wasmIns.ImListGroupUserRspCallbackWrapper.implement({OnSuccess(t){e((e=>{const t=[];for(var r=0;r<e.user_list.size();r++)t.push(v(e.user_list.get(r)));return{groupId:e.group_id,nextpagetoken:+e.getNextPageToken(),hasMore:e.has_more,userList:t}})(t))},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.ListGroupUser(t,n),n.delete()}))}async muteAll(e){const t=new this.wasmIns.ImMuteAllReq(e);return new Promise(((e,r)=>{const n=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.MuteAll(t,n),n.delete()}))}async cancelMuteAll(e){const t=new this.wasmIns.ImCancelMuteAllReq(e);return new Promise(((e,r)=>{const n=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.CancelMuteAll(t,n),n.delete()}))}async muteUser(e){const t=((e,t)=>{const r=new e.VectorString;return t.userList.forEach((e=>{r.push_back(e)})),new e.ImMuteUserReq(t.groupId,r)})(this.wasmIns,e);return new Promise(((e,r)=>{const n=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.MuteUser(t,n),n.delete()}))}async cancelMuteUser(e){const t=((e,t)=>{const r=new e.VectorString;return t.userList.forEach((e=>{r.push_back(e)})),new e.ImCancelMuteUserReq(t.groupId,r)})(this.wasmIns,e);return new Promise(((e,r)=>{const n=this.wasmIns.ImSdkCallbackWrapper.implement({OnSuccess(){e()},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.CancelMuteUser(t,n),n.delete()}))}async listMuteUsers(e){const t=new this.wasmIns.ImListMuteUsersReq(e);return new Promise(((e,r)=>{const n=this.wasmIns.ImListMuteUsersRspCallbackWrapper.implement({OnSuccess(t){var r;e({groupId:(r=t).group_id,muteAll:r.mute_all,muteUserList:c(r.mute_user_list),whiteUserList:c(r.white_user_list)})},OnFailure(e){r(k.fromWASMError(e))}});this.wasmGroupManager.ListMuteUsers(t,n),n.delete()}))}}var L=(e=>(e[e.NONE=0]="NONE",e[e.DBUG=1]="DBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e))(L||{});const N={deviceId:"",appId:"",appSign:"",logLevel:L.INFO,source:""},j={nonce:"",timestamp:0,role:"",token:""},W=(e,t)=>{const r={...j,...t},n=new e.ImAuth;return n.nonce=r.nonce,n.setTimestamp(r.timestamp.toString()),n.role=r.role,n.token=r.token,n},U=(e,t)=>{const r=new e.ImLoginReq;return t.user&&(r.user=((e,t)=>{const r={...g,...t},n=new e.ImUser;return n.user_id=r.userId,n.user_nick=r.userNick,n.user_avatar=r.userAvatar,n.user_extension=r.userExtension,n})(e,t.user)),t.userAuth&&(r.user_auth=W(e,t.userAuth)),r},G=(e,t,r)=>{const n=r.value;return{get(){return(...e)=>{if(this.wasmEngine&&this.wasmInterface)return n.apply(this,e);throw new k("engine not inited")}}}};let z=L.INFO;const B=(e=L.INFO,...t)=>{const r=new Date;e>=z&&console.log(`[${r.getFullYear()}-${r.getMonth()}-${r.getDate()} ${r.getHours()}:${r.getMinutes()}:${r.getSeconds()}.${r.getMilliseconds()}]`,...t)};var H=e=>{z=e},q=(...e)=>{B(L.DBUG,...e)};class V extends i{}var Y=Object.defineProperty,X=(e,t,r)=>(((e,t,r)=>{t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const J=["login","reconnect"];class K extends V{constructor(){super(),X(this,"socketTask"),X(this,"mainChannelId"),X(this,"url"),X(this,"authData"),wx.onNetworkStatusChange((e=>{const{isConnected:t}=e;t||this.emit("disconnected")}))}async subscribe(e,t,r){q("wx websocket subscribe",e,t,r),this.url||(this.url=t.replace("wss:///","wss://rcoims.rtn.aliyuncs.com/")),0===t.indexOf("wss://")&&this.authData&&await this.connect(this.authData)}async unSubscribe(e){if(e===this.mainChannelId)try{this.socketTask?.close()}catch(e){}}onReceiveMessage(e){q("wx websocket received: ",this.mainChannelId,e),this.emit("message",this.mainChannelId||1,e)}async connect(e){const{appid:t,userid:r,auth:n}=e,{nonce:o,role:a,timestamp:s,token:i}=n;if(!this.url||0!==this.url.indexOf("wss://"))throw new k("websocket url error");const u=`${this.url}${this.url.indexOf("?")>=0?"&":"?"}appid=${t}&userid=${r}&role=${a}&timestamp=${s}&nonce=${o}&token=${i}`,l=wx.connectSocket({url:u}),c=Date.now();await new Promise(((e,t)=>{l.onError((async e=>{const r=Date.now()-c;r<500&&await new Promise((e=>{setTimeout((()=>{e(r)}),500-r)})),t(new k(e.errMsg))})),l.onOpen((()=>{e(l)}))})),l.onMessage((e=>{this.onReceiveMessage(e.data)})),this.socketTask=l}async send(e,t){const r=JSON.parse(t),{action:n,data:o}=r;if(J.includes(n)&&(this.mainChannelId=e),"login"===n){this.authData=o;try{await this.connect(o)}catch(e){const{tid:t}=r;this.onReceiveMessage(JSON.stringify({tid:t,action:`${n}-response`,code:1e3,timestamp:Math.floor(Date.now()/1e3),error:{subcode:0,msg:e.errMsg}}))}}q("wx websocket send",t),this.socketTask?.send({data:t})}destroy(){this.authData=void 0;try{this.socketTask?.close()}catch(e){}this.socketTask=void 0,this.mainChannelId=void 0}}var Q=Object.defineProperty,Z=Object.getOwnPropertyDescriptor,ee=(e,t,r,n)=>{for(var o,a=n>1?void 0:n?Z(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n?o(t,r,a):o(a))||a);return n&&a&&Q(t,r,a),a},te=(e,t,r)=>(((e,t,r)=>{t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const re=class e extends i{constructor(){super(),te(this,"wasmIns"),te(this,"wasmEngine"),te(this,"wasmInterface"),te(this,"transport"),te(this,"eventListener"),te(this,"messageManager"),te(this,"groupManager")}static createEngine(){return e.engine||(e.engine=new e),e.engine}initTransport(){let e;e=new K,e.on("disconnected",(()=>{this.wasmIns?.wasmOnConnectionLostEvent(-15)})),e.on("message",((e,t)=>{q("engine received",e,t),this.wasmIns?.wasmOnReceiveData(e,t)})),this.transport=e}async init(e){(e.logLevel||e.logLevel===L.NONE)&&H(e.logLevel),this.initTransport();try{if(!this.wasmIns){let t,r;t=e.locateFile;const n=await u({wasmBinary:r,locateFile:t,subscribe:async(e,t)=>{let r;try{r=JSON.parse(e)}catch(e){}if(!r)throw new Error("subscribeInfo should be json string");q("subscribe",r,t);const{url:n,stream_id:o,data_channel_streams:a=[]}=r,s=a?.[0]?.track_label||o,i=+o;if(!i)throw new Error("channelId should be number");let u=0;const l=Date.now();try{await(this.transport?.subscribe(i,n,s))}catch(e){console.error(e),u=-1}const c=Date.now()-l;0!==u&&c<500&&await new Promise((e=>setTimeout(e,500-c))),q("connectResult",u),this.wasmIns.wasmOnConnectResult(i,u)},unSubscribe:(e,t)=>{q("unSubscribe",e,t);const r=+e;this.transport?.unSubscribe(r)},sendData:async(e,t,r,n,o)=>{q("engine sendData",e,o),await(this.transport?.send(e,o))}});this.wasmIns=n,await this.wasmIns.ready,this.wasmEngine=new this.wasmIns.ImEngine.CreateEngine}await this.wasmIns.ready;const t=((e,t)=>{const r={...N,...t},n=new e.ImSdkConfig;return r.deviceId&&(n.device_id=r.deviceId),n.app_id=r.appId,n.app_sign=r.appSign,(r.logLevel||0===r.logLevel)&&(n.log_level=h(r.logLevel,e.ImLogLevel)),n.source=r.source,n})(this.wasmIns,e);t.protocol=2;const r=this.wasmEngine.Init(t);if(this.wasmInterface=this.wasmEngine.GetInterface(),0!==r)throw new k("init failed, please uninit first");this.messageManager=new C(this.wasmIns,this.wasmInterface),this.groupManager=new x(this.wasmIns,this.wasmInterface),this.addEventListener()}catch(e){throw console.error(e),new k(e.message,e.code)}}addEventListener(){this.eventListener=this.wasmIns.ImSdkListenerWrapper.implement({OnConnecting:()=>{this.emit("connecting")},OnConnectSuccess:()=>{this.emit("connectsuccess")},OnConnectFailed:e=>{this.emit("connectfailed",e)},OnDisconnect:e=>{this.messageManager?.removeMessageListener(),this.groupManager?.removeGroupListener(),this.emit("disconnect",e)},OnTokenExpired:e=>{const t=this.wasmIns.ImTokenCallback.CopyPtr(e);this.emit("tokenexpired",((e,r)=>{if(e)return t.OnError({code:e.code||0,msg:e.msg}),void t.delete();if(!r)throw new Error("auth not found");const n=this.wasmIns.ImTokenWrapper.implement({GetAccessToken:()=>W(this.wasmIns,r)});t.OnSuccess(n),t.delete()}))},OnReconnectSuccess:e=>{this.emit("reconnectsuccess",(e=>{const t=[];for(var r=0;r<e.size();r++)t.push(D(e.get(r)));return t})(e))}}),this.wasmInterface.AddSdkListener(this.eventListener)}removeEventListener(){this.eventListener&&(this.wasmInterface.RemoveSdkListener(this.eventListener),this.eventListener.delete(),this.eventListener=null)}destroy(){this.removeEventListener(),this.groupManager?.removeGroupListener(),this.groupManager=void 0,this.messageManager?.removeMessageListener(),this.messageManager=void 0,this.wasmInterface?.delete(),this.wasmInterface=void 0,this.transport?.destroy()}unInit(){return this.destroy(),0===this.wasmEngine.UnInit()}async login(e){const t=U(this.wasmIns,e),r=this;return new Promise(((e,n)=>{const o=this.wasmIns.ImSdkCallback.implement({OnSuccess(){r.messageManager?.addMessageListener(),r.groupManager?.addGroupListener(),e()},OnFailure(e){n(k.fromWASMError(e))}});this.wasmInterface.Login(t,o),o.delete()}))}async logout(){return new Promise(((e,t)=>{const r=this.wasmIns.ImSdkCallback.implement({OnSuccess(){this.transport?.destroy(),e()},OnFailure(e){t(k.fromWASMError(e))}});this.wasmInterface.Logout(r),r.delete()}))}reconnect(){this.wasmIns?.wasmOnConnectionLostEvent(-15)}getCurrentUserId(){return this.wasmInterface.GetCurrentUserId()}isLogin(){if(!this.wasmEngine||!this.wasmInterface)return!1;return!!this.wasmInterface.IsLogin()}getMessageManager(){return this.messageManager}getGroupManager(){return this.groupManager}};te(re,"engine"),ee([G],re.prototype,"unInit",1),ee([G],re.prototype,"login",1),ee([G],re.prototype,"logout",1),ee([G],re.prototype,"reconnect",1),ee([G],re.prototype,"getCurrentUserId",1),ee([G],re.prototype,"getMessageManager",1),ee([G],re.prototype,"getGroupManager",1);let ne=re;var oe=(e=>(e[e.ERROR_HAS_LOGIN=304]="ERROR_HAS_LOGIN",e[e.ERROR_INVALID_PARAM=400]="ERROR_INVALID_PARAM",e[e.ERROR_NO_PERMISSION=403]="ERROR_NO_PERMISSION",e[e.ERROR_NO_SESSION=404]="ERROR_NO_SESSION",e[e.ERROR_GROUP_NOT_EXIST=440]="ERROR_GROUP_NOT_EXIST",e[e.ERROR_GROUP_DELETED=441]="ERROR_GROUP_DELETED",e[e.ERROR_SEDN_GROUP_MSG_FAIL=442]="ERROR_SEDN_GROUP_MSG_FAIL",e[e.ERROR_JOIN_GROUP_FAIL=450]="ERROR_JOIN_GROUP_FAIL",e[e.ERROR_GROUP_NOT_JOINED=425]="ERROR_GROUP_NOT_JOINED",e[e.ERROR_INTERNAL_BUSY=412]="ERROR_INTERNAL_BUSY",e[e.ERROR_INTERNALE_RROR=500]="ERROR_INTERNALE_RROR",e[e.ERROR_REACH_MAX=443]="ERROR_REACH_MAX",e[e.ERROR_INVALID_STATE=601]="ERROR_INVALID_STATE",e[e.ERROR_NOT_LOGIN=602]="ERROR_NOT_LOGIN",e[e.ERROR_RECEIVE_LAST_SESSION=603]="ERROR_RECEIVE_LAST_SESSION",e[e.ERROR_PARSE_DATA_ERROR=604]="ERROR_PARSE_DATA_ERROR",e))(oe||{});export{x as AliVCIMGroupManager,C as AliVCIMMessageManager,ne as ImEngine,oe as ImErrors,L as ImLogLevel,f as ImMessageLevel,l as ImSortType};
